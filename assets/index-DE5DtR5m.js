import{f as Me,j as e,N as we,u as ls,r as i,h as as,E as rs,a as ns,R as is,b as ve,c as os,d as ds,H as cs}from"./vendor-Cosd68Z-.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))n(x);new MutationObserver(x=>{for(const d of x)if(d.type==="childList")for(const o of d.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(x){const d={};return x.integrity&&(d.integrity=x.integrity),x.referrerPolicy&&(d.referrerPolicy=x.referrerPolicy),x.crossOrigin==="use-credentials"?d.credentials="include":x.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function n(x){if(x.ep)return;x.ep=!0;const d=t(x);fetch(x.href,d)}})();const xs={apiKey:"AIzaSyAc2g-t9A7du3K_nI2fJnw_OGxhmLfpP6s",authDomain:"dilistname.firebaseapp.com",databaseURL:"https://dilistname-default-rtdb.firebaseio.com",projectId:"dilistname",storageBucket:"dilistname.firebasestorage.app",messagingSenderId:"897983357871",appId:"1:897983357871:web:42a046bc9fb3e0543dc55a",measurementId:"G-NQ798D9J6K"};Me.apps.length||Me.initializeApp(xs);const le=Me.database(),Ce=Me.auth(),D=({children:s,className:r,...t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,...t,children:s}),hs=s=>e.jsxs(D,{...s,children:[e.jsx("line",{x1:"4",x2:"20",y1:"12",y2:"12"}),e.jsx("line",{x1:"4",x2:"20",y1:"6",y2:"6"}),e.jsx("line",{x1:"4",x2:"20",y1:"18",y2:"18"})]}),je=s=>e.jsxs(D,{...s,children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),ms=s=>e.jsx(D,{...s,children:e.jsx("polyline",{points:"15 18 9 12 15 6"})}),He=s=>e.jsx(D,{...s,children:e.jsx("polyline",{points:"9 18 15 12 9 6"})}),us=s=>e.jsx(D,{...s,children:e.jsx("polyline",{points:"6 9 12 15 18 9"})}),Ne=s=>e.jsxs(D,{...s,children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"m21 21-4.3-4.3"})]}),ps=s=>e.jsx(D,{...s,children:e.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),pe=s=>e.jsxs(D,{...s,children:[e.jsx("polyline",{points:"1 4 1 10 7 10"}),e.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),Le=s=>e.jsx(D,{...s,children:e.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),Ee=s=>e.jsxs(D,{...s,children:[e.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),e.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),Ve=s=>e.jsx(D,{...s,children:e.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"})}),ae=s=>e.jsxs(D,{...s,children:[e.jsx("polyline",{points:"3 6 5 6 21 6"}),e.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),e.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),e.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),gs=s=>e.jsxs(D,{...s,children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"17 8 12 3 7 8"}),e.jsx("line",{x1:"12",x2:"12",y1:"3",y2:"15"})]}),Ie=s=>e.jsxs(D,{...s,children:[e.jsx("polyline",{points:"6 9 6 2 18 2 18 9"}),e.jsx("path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"}),e.jsx("rect",{x:"6",y:"14",width:"12",height:"8"})]}),bs=s=>e.jsxs(D,{...s,children:[e.jsx("line",{x1:"22",x2:"11",y1:"2",y2:"13"}),e.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]}),Pe=s=>e.jsxs(D,{...s,children:[e.jsx("path",{d:"M12 19V5"}),e.jsx("path",{d:"M5 12l7-7 7 7"})]}),ze=s=>e.jsxs(D,{...s,children:[e.jsx("path",{d:"M12 5v14"}),e.jsx("path",{d:"M19 12l-7 7-7-7"})]}),qe=s=>e.jsxs(D,{...s,children:[e.jsx("ellipse",{cx:"12",cy:"5",rx:"9",ry:"3"}),e.jsx("path",{d:"M3 5V19A9 3 0 0 0 21 19V5"}),e.jsx("path",{d:"M3 12A9 3 0 0 0 21 12"})]}),Xe=s=>e.jsxs(D,{...s,children:[e.jsx("rect",{width:"7",height:"7",x:"3",y:"3",rx:"1"}),e.jsx("rect",{width:"7",height:"7",x:"14",y:"3",rx:"1"}),e.jsx("rect",{width:"7",height:"7",x:"14",y:"14",rx:"1"}),e.jsx("rect",{width:"7",height:"7",x:"3",y:"14",rx:"1"})]}),fs=s=>e.jsxs(D,{...s,children:[e.jsx("line",{x1:"8",x2:"21",y1:"6",y2:"6"}),e.jsx("line",{x1:"8",x2:"21",y1:"12",y2:"12"}),e.jsx("line",{x1:"8",x2:"21",y1:"18",y2:"18"}),e.jsx("line",{x1:"3",x2:"3.01",y1:"6",y2:"6"}),e.jsx("line",{x1:"3",x2:"3.01",y1:"12",y2:"12"}),e.jsx("line",{x1:"3",x2:"3.01",y1:"18",y2:"18"})]}),ge=s=>e.jsxs(D,{...s,children:[e.jsx("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),Te=s=>e.jsxs(D,{...s,children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),js=s=>e.jsxs(D,{...s,children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("polyline",{points:"16 11 18 13 22 9"})]}),ws=s=>e.jsxs(D,{...s,children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("line",{x1:"19",x2:"19",y1:"8",y2:"14"}),e.jsx("line",{x1:"22",x2:"16",y1:"11",y2:"11"})]}),vs=s=>e.jsxs(D,{...s,children:[e.jsx("rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2"}),e.jsx("path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"})]}),Ns=s=>e.jsxs(D,{...s,children:[e.jsx("rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",x2:"16",y1:"2",y2:"6"}),e.jsx("line",{x1:"8",x2:"8",y1:"2",y2:"6"}),e.jsx("line",{x1:"3",x2:"21",y1:"10",y2:"10"})]}),Ze=s=>e.jsxs(D,{...s,children:[e.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.35a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),ys=s=>e.jsxs(D,{...s,children:[e.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),e.jsx("polyline",{points:"16 17 21 12 16 7"}),e.jsx("line",{x1:"21",x2:"9",y1:"12",y2:"12"})]}),ks=s=>e.jsxs(D,{...s,children:[e.jsx("path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"}),e.jsx("path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0"})]}),Be=s=>e.jsxs(D,{...s,children:[e.jsx("polyline",{points:"9 11 12 14 22 4"}),e.jsx("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"})]}),Je=s=>e.jsxs(D,{...s,children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),Ue=s=>e.jsxs(D,{...s,children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",x2:"12",y1:"8",y2:"12"}),e.jsx("line",{x1:"12",x2:"12.01",y1:"16",y2:"16"})]}),Cs=s=>e.jsxs(D,{...s,children:[e.jsx("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}),e.jsx("line",{x1:"12",x2:"12",y1:"9",y2:"13"}),e.jsx("line",{x1:"12",x2:"12.01",y1:"17",y2:"17"})]}),Ss=s=>e.jsxs(D,{...s,children:[e.jsx("path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),Ls=s=>e.jsxs(D,{...s,children:[e.jsx("path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"}),e.jsx("circle",{cx:"12",cy:"13",r:"3"})]}),Ae=({className:s})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:s,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),Ms=({className:s})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"7 10 12 15 17 10"}),e.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),Es=({className:s})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("path",{d:"M8 13h8"}),e.jsx("path",{d:"M8 17h8"}),e.jsx("path",{d:"M10 9h4"})]}),Is=({sidebarOpen:s,setSidebarOpen:r,adminProfile:t,user:n,handleLogout:x})=>e.jsxs("aside",{className:`fixed inset-y-4 left-4 z-50 w-72 glass-sidebar rounded-3xl transform transition-transform duration-500 ease-in-out md:relative md:translate-x-0 md:inset-y-0 md:left-0 md:rounded-none md:border-r md:bg-slate-900 ${s?"translate-x-0":"-translate-x-[120%] md:translate-x-0"} flex flex-col shadow-2xl`,children:[e.jsx("div",{className:"h-24 flex items-center justify-center border-b border-white/5",children:e.jsxs("div",{className:"flex items-center gap-3 font-extrabold text-2xl tracking-widest text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-indigo-400",children:[e.jsx(qe,{className:"h-8 w-8 text-blue-500"})," HR PRO"]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto py-8 px-4 space-y-2",children:[e.jsx("p",{className:"px-4 text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"Menu"}),e.jsxs(we,{to:"/",onClick:()=>r(!1),className:({isActive:d})=>`w-full flex items-center gap-4 px-6 py-4 rounded-2xl transition-all duration-300 font-bold ${d?"active-nav-item shadow-lg shadow-blue-900/20":"text-slate-400 hover:bg-white/5 hover:text-white"}`,children:[e.jsx(Xe,{className:"h-5 w-5"})," ផ្ទាំងគ្រប់គ្រង"]}),e.jsxs(we,{to:"/employees",onClick:()=>r(!1),className:({isActive:d})=>`w-full flex items-center gap-4 px-6 py-4 rounded-2xl transition-all duration-300 font-bold ${d?"active-nav-item shadow-lg shadow-blue-900/20":"text-slate-400 hover:bg-white/5 hover:text-white"}`,children:[e.jsx(Te,{className:"h-5 w-5"})," បុគ្គលិក"]}),e.jsxs(we,{to:"/bulk-edit",onClick:()=>r(!1),className:({isActive:d})=>`w-full flex items-center gap-4 px-6 py-4 rounded-2xl transition-all duration-300 font-bold ${d?"active-nav-item shadow-lg shadow-blue-900/20":"text-slate-400 hover:bg-white/5 hover:text-white"}`,children:[e.jsx(Be,{className:"h-5 w-5"})," កែប្រែទិន្នន័យ"]}),e.jsxs(we,{to:"/recycle-bin",onClick:()=>r(!1),className:({isActive:d})=>`w-full flex items-center gap-4 px-6 py-4 rounded-2xl transition-all duration-300 font-bold ${d?"bg-red-500/10 text-red-400 border-l-4 border-red-500":"text-slate-400 hover:bg-white/5 hover:text-white"}`,children:[e.jsx(ae,{className:"h-5 w-5"})," ធុងសំរាម"]}),e.jsx("div",{className:"my-6 border-t border-white/5"}),e.jsx("p",{className:"px-4 text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"System"}),e.jsxs(we,{to:"/settings",onClick:()=>r(!1),className:({isActive:d})=>`w-full flex items-center gap-4 px-6 py-4 rounded-2xl transition-all duration-300 font-bold ${d?"active-nav-item shadow-lg shadow-blue-900/20":"text-slate-400 hover:bg-white/5 hover:text-white"}`,children:[e.jsx(Ze,{className:"h-5 w-5"})," ការកំណត់"]})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-gradient-to-br from-indigo-600 to-blue-700 rounded-2xl p-4 text-center",children:[e.jsx("p",{className:"text-white text-sm font-bold mb-0.5",children:t?.username||n?.email||"Admin"}),e.jsx("p",{className:"text-white/60 text-xs font-medium opacity-80 mb-3",children:t?.role||"User"}),e.jsxs("button",{onClick:x,className:"w-full flex items-center justify-center gap-2 px-4 py-2 rounded-xl bg-white/20 hover:bg-white/30 text-white transition-all text-sm font-bold backdrop-blur-sm",children:[e.jsx(ys,{className:"h-4 w-4"})," Sign Out"]})]})})]}),As=({setSidebarOpen:s,adminProfile:r,user:t})=>{const n=ls(),x=()=>{switch(n.pathname){case"/":return"Dashboard Overview";case"/employees":return"Employee Management";case"/recycle-bin":return"Recycle Bin";case"/settings":return"System Settings";case"/bulk-edit":return"Bulk Edit Mode";default:return"HR Pro"}};return e.jsxs("header",{className:"h-20 glass-panel border-b-0 m-4 rounded-3xl flex items-center justify-between px-8 z-30 shrink-0 sticky top-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>s(!0),className:"md:hidden p-2 rounded-xl hover:bg-slate-100 text-slate-600",children:e.jsx(hs,{className:"h-6 w-6"})}),e.jsx("h1",{className:"text-2xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-slate-700 to-slate-500 hidden sm:block",children:x()})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ks,{className:"h-6 w-6 text-slate-400 hover:text-indigo-500 transition-colors cursor-pointer"}),e.jsx("span",{className:"absolute -top-1 -right-1 h-3 w-3 bg-red-500 rounded-full border-2 border-white"})]}),e.jsx("div",{className:"h-8 w-[1px] bg-slate-200"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-right hidden md:block",children:[e.jsx("div",{className:"text-sm font-bold text-slate-700",children:r?.username||t?.email||"Admin User"}),e.jsx("div",{className:"text-xs text-slate-400 font-medium",children:r?.role||"Loading..."})]}),e.jsx("div",{className:"h-10 w-10 rounded-full bg-gradient-to-r from-blue-500 to-indigo-600 flex items-center justify-center text-white font-bold shadow-lg ring-2 ring-white",children:r?.username?r.username.charAt(0).toUpperCase():t?.email?t.email.charAt(0).toUpperCase():"A"})]})]})]})},$s=({onLogin:s,loading:r,error:t})=>{const[n,x]=i.useState("admin@dilistname.com"),[d,o]=i.useState(""),u=v=>{v.preventDefault(),s(n,d)};return e.jsxs("div",{className:"min-h-screen w-full flex items-center justify-center bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 relative overflow-hidden font-sans",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[500px] h-[500px] bg-indigo-500/20 rounded-full blur-[120px] animate-pulse"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[500px] h-[500px] bg-blue-500/20 rounded-full blur-[120px] animate-pulse delay-1000"}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-2xl border border-white/10 p-10 rounded-[40px] shadow-2xl w-full max-w-md m-4 animate-fade-in z-10 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-blue-500 to-indigo-500"}),e.jsxs("div",{className:"flex flex-col items-center mb-10",children:[e.jsx("div",{className:"h-20 w-20 bg-gradient-to-tr from-blue-500 to-indigo-600 rounded-3xl flex items-center justify-center shadow-lg shadow-indigo-500/30 mb-6 transform rotate-6 border border-white/20",children:e.jsx(qe,{className:"h-10 w-10 text-white"})}),e.jsx("h1",{className:"text-4xl font-extrabold text-white tracking-tight mb-2",children:"HR PRO"}),e.jsx("p",{className:"text-slate-400 text-sm font-medium",children:"Please sign in to continue"})]}),e.jsxs("form",{onSubmit:u,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider ml-2",children:"Email Address"}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(ge,{className:"h-5 w-5 text-slate-500 group-focus-within:text-blue-400 transition-colors"})}),e.jsx("input",{type:"email",value:n,onChange:v=>x(v.target.value),className:"block w-full pl-12 pr-4 py-4 bg-slate-900/60 border border-slate-700/50 rounded-2xl text-white placeholder-slate-600 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50 transition-all font-medium",placeholder:"admin@dilistname.com",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider ml-2",children:"Password"}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsxs("svg",{className:"h-5 w-5 text-slate-500 group-focus-within:text-blue-400 transition-colors",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),e.jsx("input",{type:"password",value:d,onChange:v=>o(v.target.value),className:"block w-full pl-12 pr-4 py-4 bg-slate-900/60 border border-slate-700/50 rounded-2xl text-white placeholder-slate-600 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50 transition-all font-medium",placeholder:"••••••••••••",required:!0})]})]}),t&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-2xl p-4 flex items-center gap-3 text-red-200 text-sm animate-pulse",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-red-500 shrink-0"}),t]}),e.jsx("button",{type:"submit",disabled:r,className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white font-bold py-4 rounded-2xl shadow-xl shadow-indigo-600/20 active:scale-[0.98] transition-all disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-3 mt-4",children:r?e.jsx("div",{className:"h-5 w-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:["Sign In ",e.jsx(He,{className:"h-5 w-5"})]})})]}),e.jsx("div",{className:"mt-10 text-center",children:e.jsx("p",{className:"text-slate-500 text-xs font-medium",children:"Secured by Google Firebase"})})]})]})},Os=({isOpen:s,onClose:r,sortData:t,onConfirmSort:n})=>!s||!t?null:e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm transition-opacity",onClick:r}),e.jsx("div",{className:"relative bg-white rounded-3xl shadow-2xl w-full max-w-sm overflow-hidden transform transition-all scale-100 animate-fade-in border border-white/20",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Sort By"}),e.jsx("p",{className:"text-sm text-indigo-500 font-medium",children:t.label})]}),e.jsx("button",{onClick:r,className:"p-2 bg-slate-100 hover:bg-slate-200 rounded-full text-slate-500 transition-colors",children:e.jsx(je,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>n(t.key,"asc"),className:`w-full flex items-center justify-between p-4 rounded-2xl border transition-all ${t.currentDirection==="asc"&&t.currentKey===t.key?"bg-indigo-50 border-indigo-500 ring-1 ring-indigo-500 text-indigo-700":"bg-white border-slate-200 hover:border-indigo-300 hover:bg-slate-50 text-slate-700"}`,children:[e.jsxs("span",{className:"font-bold flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg text-indigo-600",children:e.jsx(Pe,{className:"h-4 w-4"})}),"Ascending (A-Z / 0-9)"]}),t.currentDirection==="asc"&&t.currentKey===t.key&&e.jsx(Ae,{className:"h-5 w-5 text-indigo-600"})]}),e.jsxs("button",{onClick:()=>n(t.key,"desc"),className:`w-full flex items-center justify-between p-4 rounded-2xl border transition-all ${t.currentDirection==="desc"&&t.currentKey===t.key?"bg-indigo-50 border-indigo-500 ring-1 ring-indigo-500 text-indigo-700":"bg-white border-slate-200 hover:border-indigo-300 hover:bg-slate-50 text-slate-700"}`,children:[e.jsxs("span",{className:"font-bold flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg text-indigo-600",children:e.jsx(ze,{className:"h-4 w-4"})}),"Descending (Z-A / 9-0)"]}),t.currentDirection==="desc"&&t.currentKey===t.key&&e.jsx(Ae,{className:"h-5 w-5 text-indigo-600"})]}),e.jsx("div",{className:"border-t border-slate-100 my-4"}),e.jsxs("button",{onClick:()=>n(t.key,null,!0),className:"w-full flex items-center justify-center gap-2 p-4 rounded-2xl bg-slate-50 text-slate-500 font-bold hover:bg-red-50 hover:text-red-500 transition-colors",children:[e.jsx(pe,{className:"h-4 w-4"}),"Reset / Clear Sort"]})]})]})})]}),ie=({label:s,sortKey:r,currentSort:t,onOpenSort:n,className:x=""})=>{const d=t||{key:null,direction:"asc"};return e.jsx("th",{className:`px-4 py-4 text-left text-xs font-extrabold text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-100 transition-colors group select-none ${x}`,onClick:()=>n(r,s),children:e.jsx("div",{className:"flex items-center gap-1.5 justify-between",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[s,e.jsx("span",{className:"text-slate-400 flex flex-col",children:d.key===r?d.direction==="asc"?e.jsx(Pe,{className:"h-3 w-3 text-indigo-600"}):e.jsx(ze,{className:"h-3 w-3 text-indigo-600"}):e.jsxs("div",{className:"opacity-0 group-hover:opacity-50 transition-opacity",children:[e.jsx(Pe,{className:"h-2 w-2 mb-[-2px]"}),e.jsx(ze,{className:"h-2 w-2"})]})})]})})})},Ge=({className:s,currentPage:r,totalPages:t,totalItems:n,itemsPerPage:x,onPageChange:d})=>e.jsxs("div",{className:s,children:[e.jsxs("div",{className:"text-xs font-medium text-slate-500 mb-2 md:mb-0",children:["Showing ",n>0?(r-1)*x+1:0," to ",Math.min(r*x,n)," of ",n]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>d(Math.max(r-1,1)),disabled:r===1,className:"p-2 rounded-lg bg-white border border-slate-200 hover:bg-slate-50 disabled:opacity-50 text-slate-600 shadow-sm transition-all active:scale-95",children:e.jsx(ms,{className:"h-4 w-4"})}),e.jsxs("div",{className:"px-4 py-1.5 bg-white border border-slate-200 rounded-lg text-sm font-bold text-slate-700 shadow-sm min-w-[80px] text-center flex items-center justify-center",children:[r," / ",Math.max(t,1)]}),e.jsx("button",{onClick:()=>d(Math.min(r+1,t)),disabled:r===t||t===0,className:"p-2 rounded-lg bg-white border border-slate-200 hover:bg-slate-50 disabled:opacity-50 text-slate-600 shadow-sm transition-all active:scale-95",children:e.jsx(He,{className:"h-4 w-4"})})]})]}),Ds="/DI_Management/assets/di3-copy-CQzuYy1E.png",Fs=[{key:"index",label:"NO."},{key:"studentId",label:"ID"},{key:"name",label:"ឈ្មោះ (KH)"},{key:"latinName",label:"Name (EN)"},{key:"gender",label:"ភេទ"},{key:"dob",label:"ថ្ងៃកំណើត"},{key:"position",label:"តួនាទី"},{key:"group",label:"ក្រុម"},{key:"section",label:"ផ្នែក"},{key:"class",label:"ថ្នាក់"},{key:"academicYear",label:"ឆ្នាំសិក្សា"},{key:"telegram",label:"Telegram"}],We=["position","section"];function Rs({isOpen:s,onClose:r,employees:t=[]}){const[n,x]=i.useState("all"),[d,o]=i.useState(""),[u,v]=i.useState(!1),[b,h]=i.useState(""),[w,F]=i.useState(0),[N,E]=i.useState(0),[W,K]=i.useState(null),[V,_]=i.useState(Fs.map(c=>({...c,selected:["index","studentId","name","gender","position","group"].includes(c.key)}))),[S,T]=i.useState([]),k=i.useMemo(()=>{const c="Digital Industry";if(n==="all"||!d)return c;const m=n.charAt(0).toUpperCase()+n.slice(1);return`${c} - ${m} (${d})`},[n,d]);i.useEffect(()=>{if(W){const c=setTimeout(()=>K(null),4e3);return()=>clearTimeout(c)}},[W]);const O=c=>{_(m=>m.map(g=>g.key===c?{...g,selected:!g.selected}:g))},P=()=>{T([...S,{id:Date.now(),label:"Check",type:"checkbox"}])},re=c=>{T(m=>m.filter(g=>g.id!==c))},ee=(c,m,g)=>{T(z=>z.map(p=>p.id===c?{...p,[m]:g}:p))},I=c=>{const m=new Map;return t.forEach(g=>{const z=g[c];if(!z)return;const p=String(z).trim(),l=p.toLowerCase();m.has(l)?(p==="IT Support"||p[0]===p[0].toUpperCase()&&m.get(l)[0]!==m.get(l)[0].toUpperCase())&&m.set(l,p):m.set(l,p)}),Array.from(m.values()).sort()},oe=i.useMemo(()=>I("group"),[t]),q=i.useMemo(()=>I("section"),[t]),G=i.useMemo(()=>I("class"),[t]),B=V.filter(c=>c.selected),A=B.length+S.length>8,U=i.useMemo(()=>n==="all"||!d?t:t.filter(c=>{const m=c[n];return m&&String(m).trim().toLowerCase()===d.trim().toLowerCase()}),[t,n,d]),M=i.useMemo(()=>{const c=[],m=A?15:24;for(let g=0;g<U.length;g+=m)c.push(U.slice(g,g+m));return c},[U,A]),me=()=>{h("excel"),v(!0),setTimeout(()=>{try{const c=f=>{switch(f){case"index":return 60;case"studentId":return 100;case"name":return 220;case"latinName":return 200;case"gender":return 80;case"dob":return 120;case"position":return 250;case"telegram":return 150;case"academicYear":return 120;default:return 150}};let m="<colgroup>";B.forEach(f=>{m+=`<col width="${c(f.key)}">`}),S.forEach(()=>{m+='<col width="100">'}),m+="</colgroup>";const g=[...B.map(f=>f.label),...S.map(f=>f.label)],z=g.length;let p="";U.forEach((f,R)=>{const Z=R%2===0?"#ffffff":"#f9f9f9";let xe="";B.forEach(he=>{let ye=he.key==="index"?R+1:f[he.key]||"";const be=We.includes(he.key)?"white-space: normal; word-wrap: break-word;":"white-space: nowrap;";xe+=`
                            <td style="background-color: ${Z}; padding: 10px; border: 1px solid #000000; text-align: center; vertical-align: middle; font-size: 11pt; color: #000000; font-family: 'Khmer OS Battambang', 'Battambang', sans-serif; mso-number-format:'@'; ${be}">
                                ${ye}
                            </td>`}),S.forEach(()=>{xe+=`<td style="background-color: ${Z}; border: 1px solid #000000;"></td>`}),p+=`<tr style="height: 40px;">${xe}</tr>`});const l=`
                    <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">
                    <head>
                        <meta charset="UTF-8">
                        <style>
                            /* GLOBAL DEFAULT */
                            body { font-family: 'Khmer OS Battambang', sans-serif; }
                            table { border-collapse: collapse; width: 100%; table-layout: fixed; }
                            
                            /* --- HEADER MATCHING IMAGE --- */
                            th { 
                                background-color: #FFFF00; /* YELLOW */
                                color: #000000; /* BLACK TEXT */
                                font-family: 'Khmer OS Muol Light', 'Khmer OS Muol', 'Moul', sans-serif; 
                                font-weight: bold; 
                                font-size: 12pt; 
                                height: 50px; 
                                border: 1px solid #000000; /* BLACK BORDER */
                                vertical-align: middle; 
                                text-align: center; 
                                text-transform: uppercase; 
                            }
                            
                            /* DATA ROW STYLE */
                            td {
                                font-family: 'Khmer OS Battambang', sans-serif;
                            }
                        </style>
                    </head>
                    <body>
                        <table>
                            ${m}
                            
                            <tr style="height: auto;">
                                <td colspan="${z}" style="border: 1px solid #000000; background-color: #ffffff; vertical-align: middle; text-align: center; padding-top: 30px; padding-bottom: 30px;">
                                    <div style="font-family: 'Khmer OS Muol Light', 'Khmer OS Muol', sans-serif; font-size: 24pt; font-weight: bold; color: #4338ca; white-space: nowrap;">
                                        ${k.toUpperCase()}
                                    </div>
                                    <div style="font-family: 'Khmer OS Battambang', sans-serif; font-size: 12pt; color: #64748b; margin-top: 10px;">
                                        Generated by HR PRO System
                                    </div>
                                </td>
                            </tr>

                            <thead>
                                <tr>
                                    ${g.map(f=>`<th bgcolor="#FFFF00" style="background-color: #FFFF00; font-family: 'Khmer OS Muol Light', 'Khmer OS Muol', 'Moul', sans-serif;">${f}</th>`).join("")} 
                                </tr>
                            </thead>

                            <tbody>${p}</tbody>
                        </table>
                    </body>
                    </html>
                `,y=new Blob([l],{type:"application/vnd.ms-excel"}),$=document.createElement("a");$.href=URL.createObjectURL(y),$.download=`${k.replace(/[^\w\s\-\(\)]/g,"").replace(/\s+/g,"_")}_${new Date().toISOString().slice(0,10)}.xls`,document.body.appendChild($),$.click(),document.body.removeChild($),K({type:"success",message:"Excel Exported Successfully!"})}catch(c){console.error("Excel Export Error:",c),K({type:"error",message:"Failed to export Excel."})}finally{v(!1),h("")}},1e3)},j=async(c="download")=>{v(!0),h("checking"),await new Promise(m=>setTimeout(m,800));try{const m=document.querySelectorAll(".printable-page");if(m.length===0){K({type:"error",message:"No pages found to print."}),v(!1),h("");return}for(let p=0;p<m.length;p++){const l=m[p],y=l.querySelector(".pdf-wrapper");if(y){if(y.scrollWidth>l.clientWidth+5){K({type:"error",message:`Page ${p+1} is too wide! Content is cut off. Please uncheck some columns.`}),v(!1),h("");return}if(y.scrollHeight>l.clientHeight+5){K({type:"error",message:`Page ${p+1} is too tall! Please reduce columns or data slightly.`}),v(!1),h("");return}}}h(c),F(0),E(0);const g=m.length,z=[];for(let p=0;p<g;p++){E(p+1);const l=m[p],y=A?1555:1100,$=A?1100:1555,R=(await as(l,{scale:2,useCORS:!0,logging:!1,windowWidth:y,width:y,windowHeight:$,height:$,backgroundColor:"#ffffff"})).toDataURL("image/jpeg",.95);z.push(R);const Z=Math.round((p+1)/g*100);F(Z)}if(c==="download"){const p=A?"landscape":"portrait",l=new rs({orientation:p,unit:"mm",format:"a4"}),y=A?297:210,$=A?210:297;z.forEach((f,R)=>{R>0&&l.addPage(),l.addImage(f,"JPEG",0,0,y,$)}),l.save(`${k.replace(/[^\w\s\-\(\)]/g,"").replace(/\s+/g,"_")}_${new Date().toISOString().slice(0,10)}.pdf`),K({type:"success",message:"PDF Downloaded Successfully!"}),v(!1),h("")}else if(c==="print"){const p=document.createElement("iframe");p.style.position="fixed",p.style.width="0px",p.style.height="0px",p.style.border="none",p.style.zIndex="-1",document.body.appendChild(p);const l=p.contentWindow.document,y=A?"landscape":"portrait";l.write(`
                    <html>
                        <head>
                            <title>Print Report</title>
                            <style>
                                @page { size: ${y}; margin: 0; }
                                body { margin: 0; padding: 0; }
                                img { width: 100%; height: 100vh; object-fit: contain; display: block; page-break-after: always; }
                            </style>
                        </head>
                        <body>
                            ${z.map($=>`<img src="${$}" />`).join("")}
                        </body>
                    </html>
                `),l.close(),p.onload=function(){K({type:"success",message:"Print Dialog Opened"}),v(!1),h(""),setTimeout(function(){p.contentWindow.focus(),p.contentWindow.print(),setTimeout(()=>document.body.removeChild(p),2e3)},500)}}}catch(m){console.error("PDF Generation Error:",m),K({type:"error",message:"Failed to generate PDF."}),v(!1),h("")}};if(!s)return null;const L=new Date().toLocaleDateString("en-GB");return e.jsxs(e.Fragment,{children:[W&&e.jsxs("div",{className:`fixed top-6 right-6 z-[300] px-6 py-4 rounded-2xl shadow-2xl flex items-center gap-4 animate-in slide-in-from-top-10 fade-in duration-300 border ${W.type==="success"?"bg-emerald-500 border-emerald-400 text-white":"bg-red-500 border-red-400 text-white"}`,children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-full",children:W.type==="success"?e.jsx(Ae,{className:"h-6 w-6"}):e.jsx(Ue,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-lg",children:W.type==="success"?"Success":"Attention"}),e.jsx("p",{className:"text-sm font-medium opacity-90",children:W.message})]})]}),u&&e.jsx("div",{className:"fixed inset-0 z-[200] bg-slate-900/80 backdrop-blur-md flex flex-col items-center justify-center animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-slate-800 p-8 rounded-3xl shadow-2xl border border-slate-700 w-full max-w-md text-center",children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"h-20 w-20 border-4 border-slate-600 rounded-full mx-auto"}),e.jsx("div",{className:"h-20 w-20 border-4 border-indigo-500 border-t-transparent rounded-full mx-auto absolute top-0 left-0 right-0 animate-spin"}),b!=="excel"&&b!=="checking"&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center font-bold text-white text-lg",children:[w,"%"]})]}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:b==="checking"?"Checking Layout...":b==="print"?"Preparing to Print...":b==="excel"?"Exporting Excel...":"Generating PDF..."}),e.jsx("p",{className:"text-slate-400 text-sm mb-6",children:b==="checking"?"Ensuring data fits on A4...":b==="excel"?"Please wait...":`Processing page ${N} of ${M.length}`}),b!=="excel"&&b!=="checking"&&e.jsx("div",{className:"w-full bg-slate-700 rounded-full h-3 overflow-hidden shadow-inner",children:e.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-500 h-full rounded-full transition-all duration-300 ease-out",style:{width:`${w}%`}})})]})}),e.jsx("div",{className:"fixed inset-0 z-[100] bg-slate-900/40 backdrop-blur-md flex items-center justify-center p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white rounded-3xl w-full max-w-5xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh] ring-1 ring-slate-900/5",children:[e.jsxs("div",{className:"px-8 py-6 border-b border-slate-100 flex justify-between items-center bg-gradient-to-r from-slate-50 to-white",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 bg-indigo-600 rounded-2xl flex items-center justify-center shadow-lg shadow-indigo-200 text-white",children:e.jsx(Ie,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 tracking-tight",children:"Print Settings"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wider ${A?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:A?"Landscape":"Portrait"}),e.jsxs("span",{className:"text-xs text-slate-400 font-medium",children:["• ",U.length," Records • ",M.length," Pages"]})]})]})]}),e.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-slate-100 text-slate-400 hover:text-slate-600 transition-colors",children:e.jsx(je,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"p-8 overflow-y-auto custom-scrollbar flex-1 bg-[#F8FAFC]",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-full",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("section",{children:[e.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-3 flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-1 bg-indigo-500 rounded-full"})," Filter Scope"]}),e.jsx("div",{className:"bg-white p-1 rounded-xl border border-slate-200 shadow-sm flex",children:["all","group","section","class"].map(c=>e.jsx("button",{onClick:()=>{x(c),o("")},className:`flex-1 py-2 text-[11px] font-bold uppercase rounded-lg transition-all duration-200 ${n===c?"bg-slate-800 text-white shadow-md":"text-slate-500 hover:bg-slate-50"}`,children:c},c))}),e.jsx("div",{className:`mt-4 transition-all duration-300 ${n!=="all"?"opacity-100 translate-y-0":"opacity-0 -translate-y-2 pointer-events-none h-0"}`,children:e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:d,onChange:c=>o(c.target.value),className:"w-full p-3 pl-4 border border-slate-200 rounded-xl text-sm font-semibold bg-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none appearance-none shadow-sm text-slate-700",children:[e.jsxs("option",{value:"",children:["Select Specific ",n,"..."]}),n==="group"&&oe.map(c=>e.jsx("option",{value:c,children:c},c)),n==="section"&&q.map(c=>e.jsx("option",{value:c,children:c},c)),n==="class"&&G.map(c=>e.jsx("option",{value:c,children:c},c))]}),e.jsx("div",{className:"absolute right-4 top-3.5 pointer-events-none text-slate-400",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]})})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"flex justify-between items-end mb-3",children:[e.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-1 bg-teal-500 rounded-full"})," Custom Columns"]}),e.jsxs("button",{onClick:P,className:"text-[10px] flex items-center gap-1 bg-teal-5 text-teal-600 px-3 py-1.5 rounded-lg font-bold hover:bg-teal-100 transition-colors border border-teal-100",children:[e.jsx(Ee,{className:"h-3 w-3"})," Add New"]})]}),e.jsxs("div",{className:"space-y-3",children:[S.length===0&&e.jsx("div",{className:"text-center py-6 border-2 border-dashed border-slate-200 rounded-xl bg-slate-50/50",children:e.jsx("p",{className:"text-[10px] text-slate-400 font-medium",children:"No custom columns added."})}),S.map(c=>e.jsxs("div",{className:"p-3 bg-white border border-slate-200 shadow-sm rounded-xl relative group hover:border-teal-300 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("input",{value:c.label,onChange:m=>ee(c.id,"label",m.target.value),className:"flex-1 text-xs font-bold text-slate-700 bg-transparent border-none p-0 focus:ring-0 placeholder-slate-300",placeholder:"Header Name"}),e.jsx("button",{onClick:()=>re(c.id),className:"text-slate-300 hover:text-red-500 transition-colors",children:e.jsx(ae,{className:"h-3.5 w-3.5"})})]}),e.jsx("div",{className:"flex bg-slate-100 p-0.5 rounded-lg",children:["blank","checkbox"].map(m=>e.jsx("button",{onClick:()=>ee(c.id,"type",m),className:`flex-1 py-1 text-[9px] font-bold rounded-md uppercase transition-all ${c.type===m?"bg-white text-teal-700 shadow-sm":"text-slate-400 hover:text-slate-600"}`,children:m},m))})]},c.id))]})]})]}),e.jsxs("div",{className:"lg:col-span-2 flex flex-col h-full",children:[e.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-3 flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-1 bg-indigo-500 rounded-full"})," Visible Data Columns"]}),e.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-slate-200 shadow-sm flex-1 overflow-hidden flex flex-col",children:[e.jsx("div",{className:"overflow-y-auto custom-scrollbar pr-2 pb-2",children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:V.map(c=>e.jsxs("div",{onClick:()=>O(c.key),className:`
                                                        cursor-pointer select-none relative p-3 rounded-xl border transition-all duration-200 flex items-center justify-between group
                                                        ${c.selected?"bg-indigo-50 border-indigo-200 shadow-sm":"bg-slate-50 border-transparent hover:border-slate-200 hover:bg-slate-100"}
                                                    `,children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`text-[10px] font-bold uppercase tracking-wider mb-0.5 ${c.selected?"text-indigo-400":"text-slate-400"}`,children:c.key}),e.jsx("span",{className:`text-sm font-bold font-battambang ${c.selected?"text-indigo-900":"text-slate-500 group-hover:text-slate-700"}`,children:c.label})]}),e.jsx("div",{className:`
                                                        h-5 w-5 rounded-full flex items-center justify-center transition-colors
                                                        ${c.selected?"bg-indigo-600 text-white":"bg-slate-200 text-transparent"}
                                                    `,children:e.jsx(Ae,{className:"h-3 w-3"})})]},c.key))})}),e.jsx("div",{className:"mt-4 pt-4 border-t border-slate-100 text-center",children:e.jsxs("p",{className:"text-xs text-slate-400",children:["Currently showing ",e.jsx("span",{className:"text-indigo-600 font-bold",children:B.length})," data columns + ",e.jsx("span",{className:"text-teal-600 font-bold",children:S.length})," custom columns."]})})]})]})]})}),e.jsxs("div",{className:"px-6 py-5 border-t border-slate-100 bg-white flex flex-wrap justify-between items-center gap-4",children:[e.jsxs("div",{className:"text-xs text-slate-400 font-medium hidden md:block",children:["Paper Size: ",e.jsx("span",{className:"text-slate-700 font-bold",children:"A4"})]}),e.jsxs("div",{className:"flex gap-3 w-full md:w-auto justify-between md:justify-end flex-1",children:[e.jsx("button",{onClick:r,disabled:u,className:"hidden md:flex px-6 py-2.5 rounded-xl font-bold text-slate-500 hover:bg-slate-100 text-sm transition-colors items-center justify-center bg-transparent",children:e.jsx("span",{children:"Cancel"})}),e.jsxs("div",{className:"flex gap-2 md:gap-3 w-full md:w-auto justify-end",children:[e.jsxs("button",{onClick:me,disabled:U.length===0||u,className:"p-3 md:px-5 md:py-2.5 bg-emerald-50 border border-emerald-200 text-emerald-700 hover:bg-emerald-100 rounded-xl font-bold shadow-sm hover:shadow-md flex items-center justify-center gap-2 text-sm transform active:scale-95 transition-all disabled:opacity-50 disabled:transform-none",title:"Export Excel",children:[u&&b==="excel"?e.jsx(Le,{className:"h-5 w-5 animate-spin"}):e.jsx(Es,{className:"h-5 w-5"}),e.jsx("span",{className:"hidden md:inline",children:"Excel"})]}),e.jsxs("button",{onClick:()=>j("print"),disabled:U.length===0||u,className:"p-3 md:px-5 md:py-2.5 bg-white border border-slate-200 hover:bg-slate-50 text-slate-700 rounded-xl font-bold shadow-sm hover:shadow-md flex items-center justify-center gap-2 text-sm transform active:scale-95 transition-all disabled:opacity-50 disabled:transform-none",title:"Print PDF",children:[u&&b==="print"?e.jsx(Le,{className:"h-5 w-5 animate-spin"}):e.jsx(Ie,{className:"h-5 w-5"}),e.jsx("span",{className:"hidden md:inline",children:"Print"})]}),e.jsxs("button",{onClick:()=>j("download"),disabled:U.length===0||u,className:"p-3 md:px-6 md:py-2.5 bg-slate-900 hover:bg-indigo-600 text-white rounded-xl font-bold shadow-lg shadow-slate-200 hover:shadow-indigo-200 flex items-center justify-center gap-2 text-sm transform active:scale-95 transition-all disabled:opacity-50 disabled:transform-none",title:"Download PDF",children:[u&&b==="download"?e.jsx(Le,{className:"h-5 w-5 animate-spin"}):e.jsx(Ms,{className:"h-5 w-5"}),e.jsx("span",{className:"hidden md:inline",children:u&&b==="download"?"Processing...":"Download"})]})]})]})]})]})}),e.jsx("div",{style:{position:"absolute",top:0,left:"-9999px",width:A?"1555px":"1100px"},children:e.jsxs("div",{id:"pdf-content-area",style:{width:"100%",backgroundColor:"white"},children:[e.jsx("style",{children:`
                        @import url('https://fonts.googleapis.com/css2?family=Battambang:wght@400;700&family=Moul&family=Inter:wght@400;500;600;700&display=swap');
                        
                        .printable-page {
                            width: ${A?"1555px":"1100px"};
                            height: ${A?"1100px":"1555px"}; 
                            padding: 50px; 
                            background: white;
                            position: relative;
                            box-sizing: border-box;
                            overflow: hidden; 
                        }

                        @media print {
                            @page {
                                size: ${A?"landscape":"portrait"};
                                margin: 0;
                            }
                            body {
                                margin: 0;
                                -webkit-print-color-adjust: exact;
                            }
                        }

                        .pdf-wrapper { 
                            font-family: 'Inter', 'Khmer OS Battambang', 'Battambang', sans-serif; 
                            color: #0f172a; 
                            height: 100%; 
                            display: flex; 
                            flex-direction: column;
                        }
                        
                        .header-container {
                            display: flex; justify-content: space-between; align-items: flex-end;
                            margin-bottom: 25px; border-bottom: 3px solid #0f172a; padding-bottom: 20px;
                            flex-shrink: 0;
                        }

                        .header-left { display: flex; align-items: center; gap: 20px; }
                        
                        table { 
                            width: 100%; 
                            border-collapse: collapse; 
                            border: 2px solid #000000; 
                            table-layout: auto; 
                            flex-shrink: 0;
                        }
                        
                        /* *** HEADER COLUMNS = KHMER OS MUOL *** */
                        th {
                            background-color: #FFFF00; /* YELLOW */
                            color: #000000; /* BLACK */
                            font-weight: 800; 
                            text-transform: uppercase; 
                            padding: 12px 8px; 
                            text-align: center;
                            font-size: 20px; 
                            border: 1px solid #000000; /* BLACK BORDER */
                            white-space: nowrap;
                            font-family: 'Khmer OS Muol Light', 'Khmer OS Muol', 'Moul', sans-serif;
                        }

                        /* *** ROWS = KHMER OS BATTAMBANG *** */
                        td {
                            padding: 10px 8px; 
                            vertical-align: middle;
                            font-size: 18px; 
                            border: 1px solid #000000; /* BLACK BORDER */
                            text-align: center; 
                            font-family: 'Khmer OS Battambang', 'Battambang', sans-serif;
                            
                            white-space: nowrap;
                            overflow: hidden; 
                            text-overflow: ellipsis; 
                            max-width: 300px;
                        }

                        .custom-cell-center {
                            display: flex;
                            justify-content: center;
                            align-items: center;
                            width: 100%;
                            height: 100%;
                            min-height: 28px; 
                        }
                        
                        tr:nth-child(even) { background-color: #f8fafc; }

                        .box-check {
                            width: 22px; height: 22px; 
                            border: 2px solid #000000; 
                            border-radius: 6px; 
                            display: block; 
                        }
                        
                        .footer-text {
                            position: absolute; bottom: 30px; right: 40px;
                            text-align: right; font-size: 12px; color: #64748b; font-weight: bold;
                        }
                    `}),M.map((c,m)=>e.jsx("div",{className:"printable-page",children:e.jsxs("div",{className:"pdf-wrapper",children:[e.jsxs("div",{className:"header-container",children:[e.jsxs("div",{className:"header-left",children:[e.jsx("img",{src:Ds,alt:"Logo",style:{height:"70px",objectFit:"contain"}}),e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"30px",fontWeight:"800",textTransform:"uppercase",margin:0,fontFamily:"'Khmer OS Muol Light', 'Khmer OS Muol', 'Moul', sans-serif"},children:k}),e.jsx("span",{style:{fontSize:"14px",color:"#64748b",fontWeight:"bold"},children:"Generated by HR PRO System"})]})]}),e.jsxs("div",{style:{textAlign:"right",fontSize:"14px",color:"#64748b"},children:[e.jsxs("p",{children:["DATE: ",e.jsx("span",{style:{color:"#0f172a",fontWeight:"bold"},children:L})]}),d&&e.jsxs("p",{className:"uppercase",children:["FILTER: ",e.jsx("span",{style:{color:"#0f172a",fontWeight:"bold"},children:d})]})]})]}),e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[B.map(g=>e.jsx("th",{children:g.label},g.key)),S.map(g=>e.jsx("th",{children:g.label},g.id))]})}),e.jsx("tbody",{children:c.map((g,z)=>e.jsxs("tr",{children:[B.map(p=>e.jsx("td",{style:We.includes(p.key)?{whiteSpace:"normal",wordBreak:"break-word",maxWidth:"250px"}:{},children:p.key==="index"?m*(A?14:17)+z+1:g[p.key]||"-"},p.key)),S.map(p=>e.jsx("td",{children:e.jsx("div",{className:"custom-cell-center",children:p.type==="checkbox"&&e.jsx("div",{className:"box-check"})})},p.id))]},g.id||z))})]}),e.jsxs("div",{className:"footer-text",children:["Page ",m+1]})]})},m))]})})]})}const Ps=i.memo(({employee:s,onEdit:r,onDelete:t,index:n,isSelected:x,onToggleSelect:d})=>e.jsxs("div",{className:`group relative bg-white/70 backdrop-blur-md rounded-3xl border shadow-sm hover:shadow-xl hover:-translate-y-2 transition-all duration-300 overflow-hidden flex flex-col animate-fade-in ${x?"ring-2 ring-indigo-500 border-indigo-500 bg-indigo-50/50":"border-white/60"}`,style:{animationDelay:`${n*50}ms`},onDoubleClick:r,children:[e.jsx("div",{className:"absolute top-3 left-3 z-20",children:e.jsx("input",{type:"checkbox",checked:x||!1,onChange:o=>{o.stopPropagation(),d(s.id)},className:"h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 cursor-pointer accent-indigo-600"})}),e.jsxs("div",{className:"p-6 flex flex-col items-center text-center relative",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-24 bg-gradient-to-br from-indigo-50 to-blue-50 z-0"}),e.jsxs("div",{className:"absolute top-3 right-3 flex gap-2 opacity-0 group-hover:opacity-100 transition-all duration-300 z-10 translate-x-2 group-hover:translate-x-0",children:[e.jsx("button",{onClick:o=>{o.stopPropagation(),r()},className:"text-indigo-600 bg-white hover:bg-indigo-50 p-2 rounded-xl shadow-sm transition-colors border border-indigo-100",children:e.jsx(Ve,{className:"h-4 w-4"})}),e.jsx("button",{onClick:o=>{o.stopPropagation(),t()},className:"text-rose-500 bg-white hover:bg-rose-50 p-2 rounded-xl shadow-sm transition-colors border border-rose-100",children:e.jsx(ae,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"relative z-10 mt-4",children:[e.jsx("div",{className:"h-28 w-28 rounded-full border-4 border-white shadow-lg overflow-hidden mb-4 bg-white relative group-hover:ring-4 group-hover:ring-indigo-100 transition-all",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,alt:s.name,className:"h-full w-full object-cover transform group-hover:scale-110 transition-transform duration-700"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center text-slate-300",children:e.jsx(ge,{className:"h-12 w-12"})})}),e.jsx("div",{className:"absolute bottom-5 right-1 h-5 w-5 bg-emerald-500 border-4 border-white rounded-full"})]}),e.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-0.5",children:s.name}),e.jsx("p",{className:"text-slate-500 text-sm font-medium",children:s.latinName}),e.jsxs("div",{className:"mt-4 flex flex-wrap justify-center gap-2",children:[e.jsx("span",{className:"px-3 py-1 bg-blue-100/50 text-blue-600 rounded-lg text-xs font-bold",children:s.skill||"No Skill"}),e.jsx("span",{className:"px-3 py-1 bg-purple-100/50 text-purple-600 rounded-lg text-xs font-bold",children:s.group||"No Group"})]})]}),e.jsx("div",{className:"px-6 py-4 bg-slate-50/50 border-t border-slate-100 mt-auto backdrop-blur-sm",children:e.jsxs("div",{className:"grid grid-cols-2 gap-y-3 text-sm",children:[e.jsxs("div",{className:"text-slate-500 flex flex-col",children:[e.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-400",children:"ID"}),e.jsx("span",{className:"font-semibold text-slate-700",children:s.studentId})]}),e.jsxs("div",{className:"text-slate-500 flex flex-col text-right",children:[e.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Gender"}),e.jsx("span",{className:`font-semibold ${s.gender==="ស្រី"?"text-pink-500":"text-indigo-500"}`,children:s.gender})]}),e.jsxs("div",{className:"col-span-2 flex items-center gap-2 text-slate-500 truncate pt-2 border-t border-slate-200/50",children:[e.jsx("div",{className:"p-1.5 bg-blue-100 rounded-full text-blue-600",children:e.jsx(bs,{className:"h-3 w-3"})}),e.jsx("span",{className:"truncate text-xs font-medium text-blue-600 hover:underline cursor-pointer",children:s.telegram||"No Telegram"})]})]})})]})),zs=({toasts:s,removeToast:r})=>e.jsx("div",{className:"fixed bottom-6 right-6 z-[100] flex flex-col gap-3 pointer-events-none",children:s.map(t=>e.jsxs("div",{className:`pointer-events-auto flex items-center gap-3 px-5 py-3.5 rounded-2xl shadow-xl shadow-slate-200/50 transform transition-all animate-fade-in border ${t.type==="success"?"bg-white text-emerald-600 border-emerald-100":"bg-white text-red-600 border-red-100"}`,children:[t.type==="success"?e.jsx("div",{className:"bg-emerald-100 p-1.5 rounded-full",children:e.jsx(Je,{className:"h-4 w-4"})}):e.jsx("div",{className:"bg-red-100 p-1.5 rounded-full",children:e.jsx(Ue,{className:"h-4 w-4"})}),e.jsx("span",{className:"font-medium text-sm text-slate-700",children:t.message}),e.jsx("button",{onClick:()=>r(t.id),className:"opacity-60 hover:opacity-100 hover:bg-slate-100 p-1 rounded-md transition-all",children:e.jsx(je,{className:"h-4 w-4"})})]},t.id))}),Q=i.memo(({value:s,onSave:r,className:t,options:n,...x})=>{const[d,o]=i.useState(!1),[u,v]=i.useState(s),b=i.useRef(null);i.useEffect(()=>{v(s)},[s]),i.useEffect(()=>{d&&b.current&&b.current.focus()},[d]);const h=()=>{o(!1),u!==s&&r(u)},w=N=>{const E=N.target.value;v(E),r(E),o(!1)},F=N=>{N.key==="Enter"?b.current.blur():N.key==="Escape"&&(v(s),o(!1)),x.onKeyDown&&x.onKeyDown(N)};return d?n&&n.length>0?e.jsxs("select",{ref:b,value:u,onChange:w,onBlur:()=>o(!1),className:`w-full min-w-[100px] p-1.5 border-2 border-indigo-400 rounded-lg bg-white text-slate-900 outline-none text-sm shadow-lg animate-in fade-in zoom-in duration-200 ${t}`,onKeyDown:F,...x,children:[e.jsx("option",{value:"",disabled:!0,children:"Select..."}),!n.includes(s)&&s&&e.jsx("option",{value:s,children:s}),n.map((N,E)=>e.jsx("option",{value:N,children:N},`${N}-${E}`))]}):e.jsx("input",{ref:b,value:u,onChange:N=>v(N.target.value),onBlur:h,onKeyDown:F,className:`w-full min-w-[80px] p-1.5 border-2 border-indigo-400 rounded-lg bg-white text-slate-900 outline-none text-sm shadow-lg animate-in fade-in zoom-in duration-200 ${t}`,...x}):e.jsxs("div",{id:x.id,tabIndex:0,onFocus:()=>o(!0),onClick:N=>{N.stopPropagation(),o(!0)},className:`cursor-pointer group hover:bg-indigo-50 hover:text-indigo-700 px-2 py-1.5 -mx-2 rounded-lg transition-all border border-transparent hover:border-indigo-100 min-h-[32px] flex items-center relative outline-none focus:ring-2 focus:ring-indigo-400 ${t}`,title:"Click to edit",onKeyDown:N=>{N.key==="Enter"&&o(!0),x.onKeyDown&&x.onKeyDown(N)},children:[e.jsx("span",{className:"truncate w-full",children:s||e.jsx("span",{className:"text-slate-300 italic text-xs",children:"Empty"})}),e.jsx("span",{className:"absolute right-1 opacity-0 group-hover:opacity-40 text-[10px] text-indigo-400",children:"▼"})]})});i.memo(({icon:s,label:r,value:t,color:n})=>e.jsxs("div",{className:"bg-white/80 backdrop-blur-xl p-6 rounded-3xl border border-white/50 shadow-[0_8px_30px_rgb(0,0,0,0.04)] flex items-center gap-5 hover:-translate-y-1 transition-transform duration-300 group",children:[e.jsx("div",{className:`p-4 rounded-2xl ${n.replace("bg-","bg-opacity-10 text-")} group-hover:scale-110 transition-transform duration-300`,children:e.jsx(s,{className:`h-8 w-8 ${n.replace("bg-","text-")}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 text-sm font-semibold tracking-wide uppercase mb-1",children:r}),e.jsx("h3",{className:"text-3xl font-extrabold text-slate-800 tracking-tight",children:t})]})]}));const Ts=({isOpen:s,onClose:r,onConfirm:t,title:n,message:x,type:d="danger"})=>s?e.jsx("div",{className:"fixed inset-0 bg-slate-900/40 backdrop-blur-sm z-[60] flex items-center justify-center p-4 animate-fade-in",children:e.jsx("div",{className:"bg-white rounded-3xl max-w-sm w-full p-8 animate-scale-in shadow-2xl relative",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:`p-4 rounded-full mb-5 ${d==="danger"?"bg-red-50 text-red-500":"bg-blue-50 text-blue-500"}`,children:d==="danger"?e.jsx(Cs,{className:"h-8 w-8"}):e.jsx(pe,{className:"h-8 w-8"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-2",children:n}),e.jsx("p",{className:"text-slate-500 text-sm mb-8 leading-relaxed",children:x}),e.jsxs("div",{className:"flex gap-3 w-full",children:[e.jsx("button",{onClick:r,className:"flex-1 py-3 rounded-xl border border-slate-200 text-slate-600 font-bold hover:bg-slate-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:t,className:`flex-1 py-3 rounded-xl text-white font-bold shadow-lg hover:shadow-xl transition-all hover:-translate-y-0.5 ${d==="danger"?"bg-red-500 hover:bg-red-600 shadow-red-500/30":"bg-blue-600 hover:bg-blue-700 shadow-blue-500/30"}`,children:d==="danger"?"Confirm":"Restore"})]})]})})}):null,fe=s=>s?String(s).toLowerCase().replace(/\s+/g,""):"",Y=s=>s?String(s):"",Bs=["2023-2024","2024-2025","2025-2026","2026-2027"],Us=["Gen 1","Gen 2","Gen 3","Gen 4","Gen 5"],_s=["ប្រុស","ស្រី"],Ks=i.memo(({employee:s,onEdit:r,onDelete:t,onInlineUpdate:n,index:x,settings:d,isSelected:o,onToggleSelect:u,onNavigate:v})=>{const b=h=>({id:`cell-${x}-${h}`,onKeyDown:w=>{v&&v(w,x,h)}});return e.jsxs("tr",{className:`group transition-colors animate-fade-in border-b border-slate-100 last:border-0 ${o?"bg-indigo-50":"hover:bg-indigo-50/30"}`,onDoubleClick:r,children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap sticky left-0 bg-white/90 backdrop-blur-sm z-20 border-r border-slate-100",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:o||!1,onChange:h=>u(s.id),className:"h-4 w-4 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500 cursor-pointer accent-indigo-600"}),e.jsxs("div",{className:"flex items-center gap-1 opacity-40 group-hover:opacity-100 transition-all transform translate-x-[-10px] group-hover:translate-x-0",children:[e.jsx("button",{onClick:h=>{h.stopPropagation(),r()},className:"text-indigo-600 hover:bg-indigo-100 p-2 rounded-lg transition-colors",children:e.jsx(Ve,{className:"h-4 w-4"})}),e.jsx("button",{onClick:h=>{h.stopPropagation(),t()},className:"text-rose-500 hover:bg-rose-100 p-2 rounded-lg transition-colors",children:e.jsx(ae,{className:"h-4 w-4"})})]})]})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap sticky left-[88px] bg-white/90 backdrop-blur-sm z-20 border-r border-slate-100 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.05)]",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full overflow-hidden shadow-sm ring-2 ring-white",children:s.imageUrl?e.jsx("img",{className:"h-full w-full object-cover",src:s.imageUrl,alt:""}):e.jsx("div",{className:"h-full w-full bg-slate-100 flex items-center justify-center text-slate-400",children:e.jsx(ge,{className:"h-5 w-5"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("div",{className:"font-bold text-slate-800 text-sm",children:e.jsx(Q,{value:s.name,onSave:h=>n(s.id,"ឈ្មោះ",h),...b("name")})})})]})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600 font-medium",children:e.jsx(Q,{value:s.latinName,onSave:h=>n(s.id,"ឈ្មោះឡាតាំង",h),...b("latinName")})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:e.jsx(Q,{value:s.gender,onSave:h=>n(s.id,"ភេទ",h),options:_s,className:`font-semibold ${s.gender==="ស្រី"?"text-pink-500":"text-indigo-500"}`,...b("gender")})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600 font-mono",children:e.jsx("div",{className:"bg-slate-100 px-2 py-1 rounded text-center text-xs font-bold text-slate-700",children:e.jsx(Q,{value:s.studentId,onSave:h=>n(s.id,"អត្តលេខ",h),...b("studentId")})})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600",children:e.jsx(Q,{value:s.skill,onSave:h=>n(s.id,"ជំនាញ",h),options:d?.skills,...b("skill")})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600 font-semibold text-slate-700",children:e.jsx(Q,{value:s.group,onSave:h=>n(s.id,"ក្រុម",h),options:d?.groups,...b("group")})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600 text-[10px] text-slate-400",children:e.jsx(Q,{value:s.class,onSave:h=>n(s.id,"ថ្នាក់",h),options:d?.classes,...b("class")})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600",children:e.jsx(Q,{value:s.section,onSave:h=>n(s.id,"ផ្នែកការងារ",h),options:d?.sections,...b("section")})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600",children:e.jsx("div",{className:"px-2 py-1 bg-indigo-50 text-indigo-600 rounded border border-indigo-100 text-xs font-medium text-center",children:e.jsx(Q,{value:s.position,onSave:h=>n(s.id,"តួនាទី",h),options:d?.positions,...b("position")})})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:e.jsx(Q,{value:s.academicYear,onSave:h=>n(s.id,"ឆ្នាំសិក្សា",h),options:Bs,...b("academicYear")})}),e.jsxs("span",{className:"text-[10px] text-slate-400 flex items-center gap-1",children:["Gen:",e.jsx(Q,{value:s.generation,onSave:h=>n(s.id,"ជំនាន់",h),options:Us,...b("generation")})]})]})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600",children:e.jsx(Q,{value:s.dob,onSave:h=>n(s.id,"ថ្ងៃខែឆ្នាំកំណើត",h),...b("dob")})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600 max-w-xs truncate",title:s.pob,children:e.jsx(Q,{value:s.pob,onSave:h=>n(s.id,"ទីកន្លែងកំណើត",h),...b("pob")})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-blue-500 cursor-pointer font-medium hover:underline",children:e.jsx(Q,{value:s.telegram,onSave:h=>n(s.id,"តេឡេក្រាម",h),...b("telegram")})}),["mon","tue","wed","thu","fri","sat","sun"].map((h,w)=>{const F=["ចន្ទ","អង្គារ៍","ពុធ","ព្រហស្បត្តិ៍","សុក្រ","សៅរ៍","អាទិត្យ"][w];return e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center border-l border-slate-100 text-sm font-medium text-slate-700 bg-slate-50/30",children:e.jsx(Q,{value:s[h],onSave:N=>n(s.id,`កាលវិភាគ/${F}`,N),options:d?.schedules,...b(`schedule-${h}`)})},h)})]})},(s,r)=>s.employee===r.employee&&s.index===r.index&&s.settings===r.settings&&s.isSelected===r.isSelected),Gs=i.memo(({employee:s,onRestore:r,onPermanentDelete:t,index:n})=>e.jsxs("tr",{className:"group hover:bg-red-50/50 transition-colors animate-fade-in border-b border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap sticky left-0 bg-white/90 backdrop-blur-sm group-hover:bg-red-50/30 z-20 border-r border-slate-100",children:e.jsxs("div",{className:"flex items-center gap-2 opacity-60 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>r(s),className:"text-emerald-600 hover:bg-emerald-100 p-2 rounded-lg transition-colors",title:"ស្តារវិញ",children:e.jsx(pe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>t(s.id),className:"text-red-600 hover:bg-red-100 p-2 rounded-lg transition-colors",title:"លុបជារៀងរហូត",children:e.jsx(ae,{className:"h-4 w-4"})})]})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 border-2 border-slate-100 rounded-full overflow-hidden opacity-70 grayscale",children:s.imageUrl?e.jsx("img",{className:"h-full w-full object-cover",src:s.imageUrl,alt:""}):e.jsx("div",{className:"h-full w-full bg-slate-100 flex items-center justify-center text-slate-400",children:e.jsx(ge,{className:"h-5 w-5"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("div",{className:"font-bold text-slate-700 text-sm",children:s.name})})]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-500",children:s.latinName}),e.jsx("td",{className:"px-4 py-3 text-sm font-mono bg-slate-50 rounded text-center",children:s.studentId}),e.jsx("td",{className:"px-4 py-3 text-sm text-red-400 italic",children:"Deleted just now"})]})),Ws=({employees:s,loading:r,settings:t,isRecycleBin:n=!1,isModalOpen:x,onEdit:d,onDelete:o,onRestore:u,onPermanentDelete:v,onInlineUpdate:b,onCreate:h,onBulkDelete:w})=>{const[F,N]=i.useState(window.innerWidth<768?"grid":"list"),[E,W]=i.useState(""),[K,V]=i.useState(1),[_,S]=i.useState(new Set),[T,k]=i.useState(!1),[O,P]=i.useState(!1),[re,ee]=i.useState(!1),[I,oe]=i.useState(""),[q,G]=i.useState(""),[B,X]=i.useState(""),[A,U]=i.useState(""),[M,me]=i.useState({key:null,direction:"asc"}),[j,L]=i.useState(null),c=50,m=I||q||B||A;i.useEffect(()=>{const a=()=>{window.innerWidth<768&&N("grid")};return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]),i.useEffect(()=>{S(new Set)},[n]);const g=i.useRef(null),z=i.useRef(!1),p=i.useRef(0),l=i.useRef(0),y=a=>{["INPUT","SELECT","TEXTAREA"].includes(a.target.tagName)||(z.current=!0,g.current&&(p.current=a.pageX-g.current.offsetLeft,l.current=g.current.scrollLeft,g.current.classList.add("cursor-grabbing"),g.current.classList.add("select-none")))},$=()=>{z.current=!1,g.current&&(g.current.classList.remove("cursor-grabbing"),g.current.classList.remove("select-none"))},f=()=>{z.current=!1,g.current&&(g.current.classList.remove("cursor-grabbing"),g.current.classList.remove("select-none"))},R=a=>{if(z.current&&(a.preventDefault(),g.current)){const J=(a.pageX-g.current.offsetLeft-p.current)*2;g.current.scrollLeft=l.current-J}},Z=i.useMemo(()=>{const a=s.map(C=>C.group).filter(C=>C&&C.trim()!=="");return[...new Set(a)].sort()},[s]),xe=i.useMemo(()=>{const a=s.map(C=>C.class).filter(C=>C&&C.trim()!=="");return[...new Set(a)].sort()},[s]),he=i.useMemo(()=>{const a=s.map(C=>C.section).filter(C=>C&&C.trim()!=="");return[...new Set(a)].sort()},[s]),ye=i.useMemo(()=>{const a=s.map(C=>C.academicYear).filter(C=>C&&C.trim()!=="");return[...new Set(a)].sort()},[s]),de=i.useMemo(()=>s.filter(a=>{const C=!E||fe(a.name).includes(fe(E))||fe(a.latinName).includes(fe(E))||fe(a.studentId).includes(fe(E)),J=!I||a.group===I,se=!q||a.class===q,te=!B||a.section===B,ce=!A||a.academicYear===A;return C&&J&&se&&te&&ce}),[s,E,I,q,B,A]),be=i.useMemo(()=>{let a=[...de];return M.key!==null&&a.sort((C,J)=>{const se=C[M.key]?String(C[M.key]):"",te=J[M.key]?String(J[M.key]):"";return M.key==="studentId"?M.direction==="asc"?se.localeCompare(te,void 0,{numeric:!0,sensitivity:"base"}):te.localeCompare(se,void 0,{numeric:!0,sensitivity:"base"}):M.key==="name"?M.direction==="asc"?se.localeCompare(te,"km"):te.localeCompare(se,"km"):M.direction==="asc"?se.localeCompare(te,"en",{sensitivity:"base"}):te.localeCompare(se,"en",{sensitivity:"base"})}),a},[de,M]),ne=(a,C)=>{L({key:a,label:C,currentKey:M.key,currentDirection:M.direction})},Qe=(a,C,J=!1)=>{me(J?{key:null,direction:"asc"}:{key:a,direction:C}),L(null)};i.useEffect(()=>V(1),[E,I,q,B,A]);const _e=a=>{S(C=>{const J=new Set(C);return J.has(a)?J.delete(a):J.add(a),J})},$e=()=>{_.size===de.length&&de.length>0?S(new Set):S(new Set(de.map(a=>a.id)))},Oe=be.slice((K-1)*c,K*c),Ke=Math.ceil(be.length/c),De=["name","latinName","gender","studentId","skill","group","class","section","position","academicYear","dob","pob","telegram","schedule-mon","schedule-tue","schedule-wed","schedule-thu","schedule-fri","schedule-sat","schedule-sun"],es=(a,C,J)=>{if(!["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Enter"].includes(a.key))return;const se=a.target;if(a.key==="ArrowLeft"&&se.selectionStart>0&&se.tagName==="INPUT"||a.key==="ArrowRight"&&se.selectionEnd<se.value.length&&se.tagName==="INPUT")return;a.key!=="Enter"&&a.preventDefault();let te=C,ce=De.indexOf(J);if(ce===-1||(a.key==="ArrowUp"?te=C-1:a.key==="ArrowDown"||a.key==="Enter"?te=C+1:a.key==="ArrowLeft"?ce=ce-1:a.key==="ArrowRight"&&(ce=ce+1),te<0||te>=Oe.length)||ce<0||ce>=De.length)return;const ss=De[ce],ts=`cell-${te}-${ss}`;setTimeout(()=>{const ke=document.getElementById(ts);ke&&(ke.focus(),ke.select&&ke.select())},0)};return e.jsxs(e.Fragment,{children:[e.jsx(Os,{isOpen:!!j,sortData:j,onClose:()=>L(null),onConfirmSort:Qe}),e.jsx(Rs,{isOpen:re,onClose:()=>ee(!1),employees:s,uniqueGroups:Z,uniqueClasses:xe,uniqueSections:he}),!n&&!x&&e.jsxs("div",{className:"lg:hidden fixed bottom-6 right-6 flex flex-col gap-4 z-[90]",children:[_.size>0&&e.jsxs("button",{onClick:()=>{w(Array.from(_)),S(new Set)},className:"h-14 w-14 bg-red-600 text-white rounded-full flex items-center justify-center active:scale-95 transition-transform shadow-red-500/40 shadow-xl",children:[e.jsx("span",{className:"absolute -top-1 -right-1 bg-white text-red-600 text-[10px] font-bold h-5 w-5 rounded-full flex items-center justify-center border border-red-100",children:_.size}),e.jsx(ae,{className:"h-6 w-6"})]}),e.jsx("button",{onClick:()=>ee(!0),className:"h-14 w-14 bg-white text-slate-700 rounded-full shadow-2xl flex items-center justify-center border border-slate-100 transition-all duration-300 active:scale-95 hover:text-indigo-600",style:{boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.3)"},children:e.jsx(Ie,{className:"h-6 w-6"})}),e.jsx("button",{onClick:$e,className:`h-14 w-14 rounded-full shadow-2xl flex items-center justify-center transition-all duration-300 ${_.size>0&&_.size===de.length?"bg-indigo-600 text-white":"bg-white text-indigo-600 border border-indigo-100"}`,style:{boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.3)"},children:e.jsx(Be,{className:"h-6 w-6"})}),e.jsx("button",{onClick:()=>P(!0),className:`h-14 w-14 rounded-full shadow-2xl flex items-center justify-center transition-all duration-300 ${O?"bg-slate-800 text-white":"bg-white text-indigo-600 border border-indigo-100"}`,style:{boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.3)"},children:e.jsx(Ne,{className:"h-6 w-6"})}),e.jsx("button",{onClick:h,className:"h-14 w-14 bg-indigo-600 text-white rounded-full flex items-center justify-center active:scale-95 transition-transform",style:{boxShadow:"0 10px 25px -5px rgba(79, 70, 229, 0.5)"},children:e.jsx(Ee,{className:"h-7 w-7"})})]}),e.jsx("div",{className:`lg:hidden fixed inset-0 z-[100] bg-black/40 backdrop-blur-md transition-opacity duration-300 ${O?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,onClick:()=>P(!1),children:e.jsxs("div",{className:`absolute bottom-0 left-0 right-0 bg-white rounded-t-3xl p-5 shadow-2xl transition-transform duration-300 ${O?"translate-y-0":"translate-y-full"}`,onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-bold text-slate-700 text-lg",children:"Search & Filter"}),(E||I||q||B||A)&&e.jsxs("button",{onClick:()=>{W(""),oe(""),G(""),X(""),U("")},className:"text-xs font-bold text-red-500 hover:text-red-700 flex items-center gap-1",children:[e.jsx(pe,{className:"h-3 w-3"})," Reset"]}),e.jsx("button",{onClick:()=>P(!1),className:"p-2 bg-slate-100 rounded-full text-slate-500 hover:bg-slate-200",children:e.jsx(je,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"relative w-full group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Ne,{className:"h-4 w-4 text-slate-400 group-focus-within:text-indigo-500 transition-colors"})}),e.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-3 border border-slate-200 rounded-xl bg-white text-sm font-medium outline-none focus:ring-2 focus:ring-indigo-200",placeholder:"Search Name or ID...",value:E,onChange:a=>W(a.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-400 ml-1",children:"Group"}),e.jsxs("select",{value:I,onChange:a=>oe(a.target.value),className:"w-full py-3 px-3 border border-slate-200 rounded-xl bg-slate-50 text-sm font-bold outline-none",children:[e.jsx("option",{value:"",children:"All"}),Z.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-400 ml-1",children:"Class"}),e.jsxs("select",{value:q,onChange:a=>G(a.target.value),className:"w-full py-3 px-3 border border-slate-200 rounded-xl bg-slate-50 text-sm font-bold outline-none",children:[e.jsx("option",{value:"",children:"All"}),xe.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-400 ml-1",children:"Section"}),e.jsxs("select",{value:B,onChange:a=>X(a.target.value),className:"w-full py-3 px-3 border border-slate-200 rounded-xl bg-slate-50 text-sm font-bold outline-none",children:[e.jsx("option",{value:"",children:"All"}),he.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-400 ml-1",children:"Year"}),e.jsxs("select",{value:A,onChange:a=>U(a.target.value),className:"w-full py-3 px-3 border border-slate-200 rounded-xl bg-slate-50 text-sm font-bold outline-none",children:[e.jsx("option",{value:"",children:"All"}),ye.map(a=>e.jsx("option",{value:a,children:a},a))]})]})]}),e.jsxs("button",{onClick:()=>P(!1),className:"w-full py-3 bg-indigo-600 text-white rounded-xl font-bold mt-2 shadow-lg shadow-indigo-200",children:["Show Results (",de.length,")"]})]})]})}),e.jsxs("div",{className:"space-y-6 animate-fade-in relative min-h-[500px]",children:[e.jsxs("div",{className:"hidden lg:block glass-panel rounded-3xl sticky top-0 z-40 transition-all duration-300 shadow-sm border border-slate-100",children:[e.jsxs("div",{className:"p-4 flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex gap-3 items-center w-full md:w-auto flex-1",children:[e.jsxs("div",{className:"relative w-full md:w-72 lg:w-96 group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(Ne,{className:"h-5 w-5 text-slate-400 group-focus-within:text-indigo-500 transition-colors"})}),e.jsx("input",{type:"text",className:"block w-full pl-12 pr-4 py-3 border-none rounded-2xl bg-slate-100/50 focus:bg-white ring-1 ring-transparent focus:ring-slate-200 outline-none transition-all placeholder:text-slate-400 font-bold text-sm text-slate-700 shadow-inner",placeholder:"Search by Name or ID...",value:E,onChange:a=>W(a.target.value)})]}),e.jsxs("button",{onClick:()=>k(!T),className:`
                                    p-3 rounded-2xl transition-all duration-200 flex-shrink-0 border relative
                                    ${T||m?"bg-indigo-600 text-white border-indigo-500 shadow-md shadow-indigo-200":"bg-white text-slate-500 border-slate-200 hover:bg-slate-50"}
                                `,title:"Toggle Filters",children:[e.jsx(ps,{className:"h-5 w-5"}),m&&!T&&e.jsx("span",{className:"absolute top-2 right-2 h-2 w-2 bg-red-400 rounded-full border border-indigo-600"})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:!n&&e.jsxs(e.Fragment,{children:[_.size>0?e.jsxs("div",{className:"flex items-center gap-3 bg-indigo-50 border border-indigo-100 px-4 py-2 rounded-2xl animate-fade-in",children:[e.jsxs("span",{className:"text-sm font-bold text-indigo-700",children:[_.size," Selected"]}),e.jsxs("button",{onClick:()=>{w(Array.from(_)),S(new Set)},className:"flex items-center gap-2 bg-white text-red-600 px-3 py-1.5 rounded-xl text-sm font-bold border border-red-100 hover:bg-red-50 transition-colors",children:[e.jsx(ae,{className:"h-4 w-4"})," Delete"]}),e.jsx("button",{onClick:()=>S(new Set),className:"text-slate-400 hover:text-slate-600",children:e.jsx(je,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"bg-white/50 p-1.5 rounded-xl flex items-center ring-1 ring-slate-200",children:[e.jsx("button",{onClick:()=>N("grid"),className:`p-2.5 rounded-lg transition-all ${F==="grid"?"bg-white text-indigo-600 shadow-md":"text-slate-400 hover:text-slate-600"}`,children:e.jsx(Xe,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>N("list"),className:`p-2.5 rounded-lg transition-all ${F==="list"?"bg-white text-indigo-600 shadow-md":"text-slate-400 hover:text-slate-600"}`,children:e.jsx(fs,{className:"h-5 w-5"})}),e.jsx("div",{className:"w-px h-6 bg-slate-200 mx-1"}),e.jsx("button",{onClick:$e,className:"p-2.5 rounded-lg text-slate-400 hover:text-indigo-600 transition-all hover:bg-indigo-50",title:"Select All",children:e.jsx(Be,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>ee(!0),className:"p-2.5 rounded-lg text-indigo-600 hover:bg-indigo-50 transition-all",title:"Export PDF",children:e.jsx(Ie,{className:"h-5 w-5"})})]}),e.jsxs("button",{onClick:h,className:"flex items-center justify-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-2xl font-bold shadow-lg shadow-indigo-200 hover:-translate-y-1 transition-all",children:[e.jsx(Ee,{className:"h-5 w-5"})," New"]})]})})]}),e.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out border-t border-slate-100 bg-slate-50/50 ${T?"max-h-[500px] opacity-100 py-4":"max-h-0 opacity-0 py-0"}`,children:e.jsxs("div",{className:"px-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Filter By Options"}),(I||q||B||A)&&e.jsxs("button",{onClick:()=>{oe(""),G(""),X(""),U("")},className:"text-xs font-bold text-red-500 hover:text-red-700 flex items-center gap-1",children:[e.jsx(pe,{className:"h-3 w-3"})," Reset"]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 ml-1",children:"GROUP"}),e.jsxs("select",{value:I,onChange:a=>oe(a.target.value),className:"w-full py-2.5 px-3 rounded-xl border border-slate-200 bg-white text-sm font-semibold outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer hover:border-indigo-300",children:[e.jsx("option",{value:"",children:"All Groups"}),Z.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 ml-1",children:"CLASS"}),e.jsxs("select",{value:q,onChange:a=>G(a.target.value),className:"w-full py-2.5 px-3 rounded-xl border border-slate-200 bg-white text-sm font-semibold outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer hover:border-indigo-300",children:[e.jsx("option",{value:"",children:"All Classes"}),xe.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 ml-1",children:"SECTION"}),e.jsxs("select",{value:B,onChange:a=>X(a.target.value),className:"w-full py-2.5 px-3 rounded-xl border border-slate-200 bg-white text-sm font-semibold outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer hover:border-indigo-300",children:[e.jsx("option",{value:"",children:"All Sections"}),he.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 ml-1",children:"YEAR"}),e.jsxs("select",{value:A,onChange:a=>U(a.target.value),className:"w-full py-2.5 px-3 rounded-xl border border-slate-200 bg-white text-sm font-semibold outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer hover:border-indigo-300",children:[e.jsx("option",{value:"",children:"All Years"}),ye.map(a=>e.jsx("option",{value:a,children:a},a))]})]})]})]})})]}),r?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 animate-pulse",children:[1,2,3].map(a=>e.jsx("div",{className:"bg-white/50 h-64 rounded-3xl"},a))}):de.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 bg-white/40 rounded-3xl border-2 border-dashed border-slate-300",children:[e.jsx("div",{className:"bg-slate-100 p-6 rounded-full mb-4 text-slate-400",children:n?e.jsx(ae,{className:"h-10 w-10"}):e.jsx(Ne,{className:"h-10 w-10"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-700",children:"មិនមានទិន្នន័យ"})]}):e.jsx(e.Fragment,{children:F==="grid"&&!n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:Oe.map((a,C)=>e.jsx(Ps,{employee:a,onEdit:()=>d(a),onDelete:()=>o(a.id),index:C,isSelected:_.has(a.id),onToggleSelect:_e},a.id))}),e.jsx(Ge,{className:"glass-panel p-4 rounded-2xl flex flex-col md:flex-row justify-between items-center bg-white/80 mt-6",currentPage:K,totalPages:Ke,totalItems:be.length,itemsPerPage:c,onPageChange:V})]}):e.jsxs("div",{className:"glass-panel rounded-3xl overflow-hidden pb-0 bg-white/80",children:[e.jsx("div",{ref:g,className:"overflow-x-auto cursor-grab active:cursor-grabbing custom-scrollbar",onMouseDown:y,onMouseLeave:$,onMouseUp:f,onMouseMove:R,children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-100",children:[e.jsx("thead",{className:"bg-slate-50/80 backdrop-blur-md",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-4 text-left text-xs font-extrabold text-slate-500 uppercase tracking-wider sticky left-0 bg-slate-50 z-50 shadow-[4px_0_10px_-4px_rgba(0,0,0,0.05)]",children:n?"Action":e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:_.size>0&&_.size===de.length,onChange:$e,className:"h-4 w-4 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500 cursor-pointer accent-indigo-600"}),e.jsx("span",{children:"Action"})]})}),e.jsx(ie,{label:"Name / Profile",sortKey:"name",currentSort:M,onOpenSort:ne,className:"px-0 py-0 sticky left-[88px] bg-slate-50 z-40 shadow-[4px_0_10px_-4px_rgba(0,0,0,0.05)]"}),e.jsx(ie,{label:"Latin Name",sortKey:"latinName",currentSort:M,onOpenSort:ne}),n?e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-4 text-left text-xs font-bold text-slate-500 uppercase",children:"ID"}),e.jsx("th",{className:"px-4 py-4 text-left text-xs font-bold text-slate-500 uppercase",children:"Status"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{label:"Gender",sortKey:"gender",currentSort:M,onOpenSort:ne,className:"min-w-[100px]"}),e.jsx(ie,{label:"ID",sortKey:"studentId",currentSort:M,onOpenSort:ne,className:"min-w-[120px]"}),e.jsx(ie,{label:"Skill",sortKey:"skill",currentSort:M,onOpenSort:ne,className:"min-w-[150px]"}),e.jsx(ie,{label:"Group",sortKey:"group",currentSort:M,onOpenSort:ne,className:"min-w-[100px]"}),e.jsx(ie,{label:"Class",sortKey:"class",currentSort:M,onOpenSort:ne,className:"min-w-[100px]"}),e.jsx(ie,{label:"Section",sortKey:"section",currentSort:M,onOpenSort:ne,className:"min-w-[150px]"}),e.jsx(ie,{label:"Position",sortKey:"position",currentSort:M,onOpenSort:ne,className:"min-w-[150px]"}),e.jsx(ie,{label:"Academic",sortKey:"academicYear",currentSort:M,onOpenSort:ne,className:"min-w-[150px]"}),e.jsx(ie,{label:"DOB",sortKey:"dob",currentSort:M,onOpenSort:ne,className:"min-w-[120px]"}),e.jsx(ie,{label:"POB",sortKey:"pob",currentSort:M,onOpenSort:ne,className:"min-w-[150px]"}),e.jsx("th",{className:"px-4 py-4 text-left text-xs font-extrabold text-slate-500 uppercase tracking-wider min-w-[150px]",children:"Telegram"}),["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map(a=>e.jsx("th",{className:"px-4 py-4 text-center text-xs font-extrabold text-slate-500 uppercase border-l border-slate-200/50 min-w-[100px] bg-slate-100/30",children:a},a))]})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:Oe.map((a,C)=>n?e.jsx(Gs,{employee:a,onRestore:u,onPermanentDelete:v,index:C},a.id):e.jsx(Ks,{employee:a,onEdit:()=>d(a),onDelete:()=>o(a.id),onInlineUpdate:b,index:C,settings:t,isSelected:_.has(a.id),onToggleSelect:_e,onNavigate:es},a.id))})]})}),e.jsx(Ge,{className:"flex flex-col md:flex-row justify-between items-center px-6 py-4 border-t border-slate-100 bg-slate-50/50",currentPage:K,totalPages:Ke,totalItems:be.length,itemsPerPage:c,onPageChange:V})]})})]})]})},Ys=({employee:s,onRestore:r,onPermanentDelete:t})=>e.jsxs("div",{className:"bg-white rounded-2xl p-5 shadow-sm border border-slate-200 mb-4 relative overflow-hidden animate-scale-in",children:[e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1.5 bg-red-400"}),e.jsxs("div",{className:"flex items-start justify-between pl-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-slate-100 border border-slate-100 overflow-hidden flex-shrink-0 grayscale",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,alt:s.name,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center text-slate-400",children:e.jsx(ge,{className:"h-6 w-6"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-800 text-lg leading-tight",children:s.name}),e.jsx("p",{className:"text-xs text-slate-500 font-medium uppercase mt-0.5",children:s.latinName})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1.5",children:[e.jsx("span",{className:"bg-slate-100 text-slate-500 text-xs font-mono font-bold px-2 py-1 rounded-md",children:s.studentId}),s.class&&e.jsx("span",{className:"bg-indigo-50 text-indigo-600 text-[10px] font-bold px-2 py-0.5 rounded-md border border-indigo-100 uppercase tracking-wide",children:s.class})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 pl-3",children:[e.jsxs("button",{onClick:()=>r(s),className:"flex items-center justify-center gap-2 py-2.5 rounded-xl bg-emerald-50 text-emerald-600 font-bold text-sm active:scale-95 transition-transform border border-emerald-100",children:[e.jsx(pe,{className:"w-4 h-4"})," Restore"]}),e.jsxs("button",{onClick:()=>t(s.id),className:"flex items-center justify-center gap-2 py-2.5 rounded-xl bg-red-50 text-red-600 font-bold text-sm active:scale-95 transition-transform border border-red-100",children:[e.jsx(ae,{className:"w-4 h-4"})," Delete"]})]})]}),Hs=({employee:s,onRestore:r,onPermanentDelete:t})=>e.jsxs("tr",{className:"group hover:bg-slate-50/80 transition-colors border-b border-slate-100 last:border-0",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-4 opacity-70 group-hover:opacity-100 transition-opacity",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-slate-100 overflow-hidden grayscale group-hover:grayscale-0 transition-all border border-slate-200",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,alt:"",className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center",children:e.jsx(ge,{className:"h-5 w-5 text-slate-400"})})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-slate-700",children:s.name}),e.jsx("div",{className:"text-xs text-slate-400 uppercase font-semibold tracking-wide",children:s.latinName})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"bg-slate-100 text-slate-600 px-2.5 py-1 rounded-md text-xs font-mono font-bold border border-slate-200",children:s.studentId})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm font-semibold text-slate-600",children:s.class||e.jsx("span",{className:"text-slate-300 italic",children:"N/A"})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full bg-red-50 text-red-500 border border-red-100 text-xs font-medium",children:[e.jsx(Ue,{className:"w-3 h-3"})," Deleted"]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2 opacity-100 sm:opacity-60 group-hover:opacity-100 transition-all",children:[e.jsx("button",{onClick:()=>r(s),className:"p-2 bg-white text-emerald-600 border border-slate-200 hover:border-emerald-200 hover:bg-emerald-50 rounded-lg shadow-sm transition-all tooltip",title:"Restore",children:e.jsx(pe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>t(s.id),className:"p-2 bg-white text-red-600 border border-slate-200 hover:border-red-200 hover:bg-red-50 rounded-lg shadow-sm transition-all tooltip",title:"Delete Forever",children:e.jsx(ae,{className:"w-4 h-4"})})]})})]});function Vs({employees:s,loading:r,onRestore:t,onPermanentDelete:n}){const[x,d]=i.useState(""),o=i.useMemo(()=>{if(!s)return[];const u=x.toLowerCase();return s.filter(v=>{const b=v.name?.toLowerCase().includes(u),h=v.latinName?.toLowerCase().includes(u),w=v.studentId?.toLowerCase().includes(u),F=v.class?.toLowerCase().includes(u);return b||h||w||F})},[s,x]);return r?e.jsxs("div",{className:"flex items-center justify-center h-64 text-slate-400 gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-slate-400 border-t-transparent rounded-full animate-spin"}),"Loading..."]}):e.jsxs("div",{className:"max-w-7xl mx-auto pb-20",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4 mb-8 pt-2",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-extrabold text-slate-800 flex items-center gap-2",children:[e.jsx(ae,{className:"w-7 h-7 text-red-500"}),"Recycle Bin"]}),e.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Manage and restore deleted employee records"})]}),e.jsxs("div",{className:"relative w-full md:w-80 group",children:[e.jsx(Ne,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400 group-focus-within:text-indigo-500 transition-colors"}),e.jsx("input",{type:"text",placeholder:"Search name, ID, or class...",value:x,onChange:u=>d(u.target.value),className:"w-full pl-10 pr-4 py-2.5 rounded-xl bg-white border border-slate-200 focus:outline-none focus:ring-2 focus:ring-indigo-100 focus:border-indigo-500 transition-all shadow-sm"})]})]}),o.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-24 bg-white rounded-3xl border border-dashed border-slate-200 text-center",children:[e.jsx("div",{className:"p-4 bg-slate-50 rounded-full mb-4",children:e.jsx(ae,{className:"w-8 h-8 text-slate-300"})}),e.jsx("h3",{className:"text-slate-800 font-bold text-lg",children:"No deleted items found"}),e.jsx("p",{className:"text-slate-500 text-sm max-w-xs mx-auto",children:"Your recycle bin is empty. Deleted employees will appear here."})]}),e.jsx("div",{className:"block md:hidden space-y-4",children:o.map(u=>e.jsx(Ys,{employee:u,onRestore:t,onPermanentDelete:n},u.id))}),o.length>0&&e.jsx("div",{className:"hidden md:block bg-white rounded-2xl shadow-[0_2px_15px_rgb(0,0,0,0.04)] border border-slate-100 overflow-hidden",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:"bg-slate-50/50 border-b border-slate-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Employee"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"ID Code"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Class"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{children:o.map(u=>e.jsx(Hs,{employee:u,onRestore:t,onPermanentDelete:n},u.id))})]})})]})}const qs=["2023-2024","2024-2025","2025-2026","2026-2027","ឆ្នាំទី១","ឆ្នាំទី២","ឆ្នាំទី៣","ឆ្នាំទី៤"],Xs=["Gen 1","Gen 2","Gen 3","Gen 4","Gen 5","Gen 6","ទី១","ទី២","ទី៣","ទី៤","ទី៥","ទី៦"],Zs="dsruankj0",Js="staff_app";function Qs({isOpen:s,onClose:r,employee:t,db:n,addToast:x,settings:d}){const[o,u]=i.useState({name:"",latinName:"",gender:"ប្រុស",dob:"",pob:"",studentId:"",academicYear:"",generation:"",group:"",class:"",skill:"",section:"",position:"",telegram:"",imageUrl:"",mon:"",tue:"",wed:"",thu:"",fri:"",sat:"",sun:""}),[v,b]=i.useState(!1),[h,w]=i.useState(""),[F,N]=i.useState(null);i.useEffect(()=>{s&&(t?(console.log("Editing Employee Data:",t),u({name:t.name||"",latinName:t.latinName||"",gender:t.gender||"ប្រុស",dob:t.dob||"",pob:t.pob||"",studentId:t.studentId||"",academicYear:t.academicYear||"",generation:t.generation||"",group:t.group||"",class:t.class||"",skill:t.skill||"",section:t.section||"",position:t.position||"",telegram:t.telegram||"",imageUrl:t.imageUrl||"",mon:t.mon||"",tue:t.tue||"",wed:t.wed||"",thu:t.thu||"",fri:t.fri||"",sat:t.sat||"",sun:t.sun||""}),w(t.imageUrl||""),N(null)):(w(""),N(null),u({name:"",latinName:"",gender:"ប្រុស",dob:"",pob:"",studentId:"",academicYear:"",generation:"",group:"",class:"",skill:"",section:"",position:"",telegram:"",imageUrl:"",mon:"",tue:"",wed:"",thu:"",fri:"",sat:"",sun:""})))},[s,t]);const E=T=>{const{name:k,value:O}=T.target;if(!(k==="name"&&/[^ \u1780-\u17FF]/.test(O))){if(k==="latinName"){if(/[^a-zA-Z\s]/.test(O))return;u(P=>({...P,[k]:O.toUpperCase()}));return}u(P=>({...P,[k]:O}))}},W=T=>{const k=T.target.files[0];if(!k)return;if(k.size>5*1024*1024){alert("រូបភាពធំពេក! សូមជ្រើសរើសរូបភាពក្រោម 5MB");return}N(k);const O=new FileReader;O.onloadend=()=>w(O.result),O.readAsDataURL(k)},K=async T=>{const k=new FormData;k.append("file",T),k.append("upload_preset",Js);const O=await fetch(`https://api.cloudinary.com/v1_1/${Zs}/image/upload`,{method:"POST",body:k});if(!O.ok)throw new Error("Cloudinary upload failed");return(await O.json()).secure_url},V=async T=>{T.preventDefault(),b(!0);try{if(!o.studentId||o.studentId.trim()===""){alert("សូមបញ្ចូលអត្តលេខ (ID) ជាមុនសិន!"),b(!1);return}if(o.telegram&&!/^(https?:\/\/)?(t\.me\/|telegram\.me\/)?[a-zA-Z0-9_]{5,}$/.test(o.telegram)){alert("តេឡេក្រាមត្រូវតែជា Link (ឧ. t.me/username)!"),b(!1);return}let k=o.imageUrl;if(F)try{k=await K(F)}catch{alert("បរាជ័យក្នុងការ Upload រូបភាព។"),b(!1);return}const O={ឈ្មោះ:o.name,ឈ្មោះឡាតាំង:o.latinName,ភេទ:o.gender,ថ្ងៃខែឆ្នាំកំណើត:o.dob,ទីកន្លែងកំណើត:o.pob,អត្តលេខ:o.studentId,ឆ្នាំសិក្សា:o.academicYear,ជំនាន់:o.generation,ក្រុម:o.group,ថ្នាក់:o.class,ជំនាញ:o.skill,ផ្នែកការងារ:o.section,តួនាទី:o.position,តេឡេក្រាម:o.telegram,រូបថត:k,កាលវិភាគ:{ចន្ទ:o.mon,អង្គារ៍:o.tue,ពុធ:o.wed,ព្រហស្បត្តិ៍:o.thu,សុក្រ:o.fri,សៅរ៍:o.sat,អាទិត្យ:o.sun}};if(t&&t.id)await n.ref(`students/${t.id}`).update(O),x("កែប្រែព័ត៌មានជោគជ័យ","success");else{if((await n.ref(`students/${o.studentId}`).once("value")).exists()){alert(`អត្តលេខ ${o.studentId} មានរួចហើយ!`),b(!1);return}await n.ref(`students/${o.studentId}`).set(O),x("បញ្ចូលទិន្នន័យថ្មីជោគជ័យ","success")}r()}catch(k){console.error(k),x("បរាជ័យ: "+k.message,"error")}finally{b(!1)}},_=i.useMemo(()=>o.name?.trim().length>0&&o.studentId?.trim().length>0,[o.name,o.studentId]),S=(T,k,O=[],P=!1)=>e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase mb-1.5 block tracking-wide",children:[T," ",P&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:k,value:o[k],onChange:E,className:"w-full p-3 border border-slate-200 rounded-xl bg-slate-50/50 outline-none input-modern",children:[e.jsx("option",{value:"",children:"ជ្រើសរើស..."}),o[k]&&!O.includes(o[k])&&e.jsxs("option",{value:o[k],children:[o[k]," (Current)"]}),O.map((re,ee)=>e.jsx("option",{value:re,children:re},ee))]})]});return s?e.jsx("div",{className:"fixed inset-0 z-[100] bg-slate-900/60 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"relative bg-white rounded-3xl w-full max-w-5xl shadow-2xl overflow-hidden flex flex-col max-h-[95vh] border border-white animate-scale-in",children:[e.jsxs("div",{className:"px-8 py-5 border-b border-slate-100 flex justify-between items-center bg-white/50 shrink-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 tracking-tight",children:t?"កែប្រែព័ត៌មាន":"បញ្ចូលបុគ្គលិកថ្មី"}),e.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"សូមបំពេញព័ត៌មានឱ្យបានត្រឹមត្រូវ"})]}),e.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-slate-200 transition-colors",children:e.jsx(je,{className:"h-6 w-6 text-slate-500"})})]}),e.jsxs("form",{onSubmit:V,className:"p-8 overflow-y-auto grow custom-scrollbar bg-slate-50/30",children:[e.jsxs("div",{className:"flex gap-10 flex-col lg:flex-row mb-8",children:[e.jsxs("div",{className:"flex flex-col items-center gap-6 lg:w-1/4",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"h-48 w-48 rounded-3xl border-4 border-white overflow-hidden bg-white shadow-xl rotate-3 group-hover:rotate-0 transition-all duration-500",children:h?e.jsx("img",{src:h,className:"h-full w-full object-cover",alt:"Preview"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center text-slate-300",children:e.jsx(Ls,{className:"h-16 w-16"})})}),e.jsxs("label",{className:"absolute -bottom-2 -right-2 bg-indigo-600 p-3.5 rounded-2xl text-white cursor-pointer shadow-lg hover:bg-indigo-700 hover:scale-110 transition-all ring-4 ring-white",children:[e.jsx(gs,{className:"h-5 w-5"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:W})]})]}),e.jsxs("div",{className:"w-full mt-4",children:[e.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 block text-center",children:["លេខសម្គាល់ (ID) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{name:"studentId",value:o.studentId,onChange:E,disabled:!!t,className:`w-full p-4 border-slate-200 rounded-2xl bg-white focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 transition-all text-center font-mono font-bold text-xl text-indigo-600 tracking-widest shadow-sm input-modern ${t?"opacity-70 cursor-not-allowed":""}`,placeholder:"ID..."})]})]}),e.jsxs("div",{className:"flex-1 space-y-8",children:[e.jsxs("div",{className:"bg-white/60 p-6 rounded-3xl border border-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6 pb-2 border-b border-slate-100",children:[e.jsx(ge,{className:"h-5 w-5 text-indigo-500"}),e.jsx("h3",{className:"font-bold text-slate-800",children:"ព័ត៌មានផ្ទាល់ខ្លួន"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase mb-1.5 block",children:["ឈ្មោះ (ខ្មែរ) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{name:"name",value:o.name,onChange:E,required:!0,className:"w-full p-3 border border-slate-200 rounded-xl bg-slate-50/50 outline-none input-modern"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase mb-1.5 block",children:["ឈ្មោះ (ឡាតាំង) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{name:"latinName",value:o.latinName,onChange:E,className:"w-full p-3 border border-slate-200 rounded-xl bg-slate-50/50 outline-none input-modern"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase mb-1.5 block",children:"ភេទ"}),e.jsxs("select",{name:"gender",value:o.gender,onChange:E,className:"w-full p-3 border border-slate-200 rounded-xl bg-slate-50/50 outline-none input-modern",children:[e.jsx("option",{value:"ប្រុស",children:"ប្រុស"}),e.jsx("option",{value:"ស្រី",children:"ស្រី"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase mb-1.5 block",children:"ថ្ងៃកំណើត"}),e.jsx("input",{name:"dob",value:o.dob,onChange:E,placeholder:"DD/MM/YYYY",className:"w-full p-3 border border-slate-200 rounded-xl bg-slate-50/50 outline-none input-modern"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase mb-1.5 block",children:"ទីកន្លែងកំណើត"}),e.jsx("input",{name:"pob",value:o.pob,onChange:E,className:"w-full p-3 border border-slate-200 rounded-xl bg-slate-50/50 outline-none input-modern"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase mb-1.5 block",children:"តេឡេក្រាម Link"}),e.jsx("input",{name:"telegram",value:o.telegram,onChange:E,className:"w-full p-3 border border-slate-200 rounded-xl bg-slate-50/50 outline-none input-modern text-blue-600"})]})]})]}),e.jsxs("div",{className:"bg-white/60 p-6 rounded-3xl border border-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6 pb-2 border-b border-slate-100",children:[e.jsx(vs,{className:"h-5 w-5 text-purple-500"}),e.jsx("h3",{className:"font-bold text-slate-800",children:"ការសិក្សា & ការងារ"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5",children:[S("ជំនាញ","skill",d?.skills),S("ឆ្នាំសិក្សា","academicYear",qs),S("ជំនាន់","generation",Xs),S("ក្រុម","group",d?.groups),S("ថ្នាក់","class",d?.classes,!0),S("ផ្នែក","section",d?.sections),e.jsx("div",{className:"md:col-span-2",children:S("តួនាទី","position",d?.positions)})]})]})]})]}),e.jsxs("div",{className:"bg-white/60 p-6 rounded-3xl border border-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6 pb-2 border-b border-slate-100",children:[e.jsx(Ns,{className:"h-5 w-5 text-orange-500"}),e.jsx("h3",{className:"font-bold text-slate-800",children:"កាលវិភាគប្រចាំសប្តាហ៍"})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-7 gap-4",children:["mon","tue","wed","thu","fri","sat","sun"].map((T,k)=>e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("label",{className:"text-[11px] font-bold text-slate-500 uppercase tracking-wider text-center",children:["ចន្ទ","អង្គារ៍","ពុធ","ព្រហ","សុក្រ","សៅរ៍","អាទិត្យ"][k]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{name:T,value:o[T],onChange:E,className:"w-full py-3 pl-3 pr-8 border border-slate-200 rounded-xl bg-white text-xs font-bold text-slate-700 outline-none focus:ring-2 focus:ring-indigo-500/20 appearance-none cursor-pointer transition-all shadow-sm hover:border-indigo-300",children:[e.jsx("option",{value:"",children:"-"}),d?.schedules&&d.schedules.map(O=>e.jsx("option",{value:O,children:O},O))]}),e.jsx("div",{className:"absolute inset-y-0 right-2.5 flex items-center pointer-events-none text-slate-400",children:e.jsx(us,{className:"h-3.5 w-3.5"})})]})]},T))})]})]}),e.jsxs("div",{className:"px-8 py-5 bg-white border-t border-slate-100 flex justify-end gap-4 shrink-0",children:[e.jsx("button",{onClick:r,className:"px-8 py-3 rounded-xl text-slate-600 font-semibold hover:bg-slate-100 transition-colors",children:"បោះបង់"}),e.jsxs("button",{onClick:V,disabled:v||!_,className:"px-10 py-3 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold shadow-lg shadow-indigo-200 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed transform hover:-translate-y-1 transition-all",children:[v?e.jsx(Le,{className:"h-5 w-5 animate-spin"}):e.jsx(Je,{className:"h-5 w-5"})," ",t?"កែប្រែ":"រក្សាទុក"]})]})]})}):null}const et=()=>{const[s,r]=i.useState([]),t=(x,d="success")=>{const o=Date.now();r(u=>[...u,{id:o,message:x,type:d}]),setTimeout(()=>n(o),3e3)},n=x=>r(d=>d.filter(o=>o.id!==x));return{toasts:s,addToast:t,removeToast:n}},Fe=({icon:s,label:r,value:t,color:n,delay:x})=>e.jsxs("div",{className:`relative overflow-hidden bg-white rounded-3xl p-5 shadow-[0_8px_30px_rgb(0,0,0,0.04)] border border-slate-100 hover:shadow-lg transition-all duration-300 hover:-translate-y-1 group ${x}`,children:[e.jsx("div",{className:`absolute -right-4 -top-4 w-24 h-24 rounded-full opacity-10 transition-transform group-hover:scale-110 ${n}`}),e.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm font-medium mb-1 tracking-wide uppercase",children:r}),e.jsx("h3",{className:"text-3xl font-extrabold text-slate-800",children:t})]}),e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center text-white shadow-md ${n} transform group-hover:rotate-6 transition-transform`,children:e.jsx(s,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"mt-4 flex items-center text-xs font-medium text-emerald-500 bg-emerald-50 w-fit px-2 py-1 rounded-lg",children:e.jsx("span",{children:"↑ Active"})})]}),Ye=({icon:s,label:r,onClick:t,colorClass:n})=>e.jsxs("button",{onClick:t,className:"flex flex-col items-center justify-center p-4 bg-white border border-slate-100 rounded-2xl shadow-sm hover:shadow-md hover:bg-slate-50 transition-all active:scale-95",children:[e.jsx("div",{className:`p-3 rounded-full mb-2 ${n}`,children:e.jsx(s,{className:"w-6 h-6"})}),e.jsx("span",{className:"text-sm font-semibold text-slate-600",children:r})]});function st({stats:s,onNavigate:r}){return e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 pb-20 px-4 sm:px-6",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-[2.5rem] bg-gradient-to-br from-indigo-600 to-violet-600 shadow-xl shadow-indigo-200 text-white p-8 md:p-12 animate-fade-in",children:[e.jsx("div",{className:"absolute top-0 right-0 -mt-10 -mr-10 w-64 h-64 bg-white opacity-10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 -mb-10 -ml-10 w-40 h-40 bg-pink-500 opacity-20 rounded-full blur-2xl"}),e.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-start md:items-center justify-between gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 opacity-90",children:[e.jsx(Ss,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-bold tracking-wider uppercase",children:"Dashboard"})]}),e.jsxs("h1",{className:"text-3xl md:text-5xl font-bold mb-4 leading-tight",children:["Welcome to ",e.jsx("br",{})," ",e.jsx("span",{className:"text-indigo-200",children:"HR System Pro"})]}),e.jsx("p",{className:"text-indigo-100 text-lg max-w-lg leading-relaxed opacity-90",children:"គ្រប់គ្រងទិន្នន័យបុគ្គលិករបស់អ្នកដោយងាយស្រួល និងមានប្រសិទ្ធភាពខ្ពស់។"})]}),e.jsx("button",{onClick:()=>r("employees"),className:"group relative px-8 py-4 bg-white text-indigo-600 rounded-2xl font-bold shadow-lg hover:shadow-xl transition-all hover:-translate-y-1 active:translate-y-0",children:e.jsxs("span",{className:"flex items-center gap-2",children:["ចាប់ផ្តើមគ្រប់គ្រង",e.jsx("span",{className:"group-hover:translate-x-1 transition-transform",children:"→"})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 md:gap-8",children:[e.jsx(Fe,{icon:Te,label:"Total Staff",value:s.total,color:"bg-blue-500",delay:"animate-[fade-in_0.4s]"}),e.jsx(Fe,{icon:js,label:"Male",value:s.male,color:"bg-indigo-500",delay:"animate-[fade-in_0.6s]"}),e.jsx(Fe,{icon:ws,label:"Female",value:s.female,color:"bg-pink-500",delay:"animate-[fade-in_0.8s]"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4 px-2",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-4",children:[e.jsx(Ye,{icon:Ee,label:"Add New",colorClass:"bg-emerald-100 text-emerald-600",onClick:()=>r("employees")}),e.jsx(Ye,{icon:Te,label:"View All",colorClass:"bg-blue-100 text-blue-600",onClick:()=>r("employees")}),e.jsx("div",{className:"flex flex-col items-center justify-center p-4 border border-dashed border-slate-300 rounded-2xl opacity-50",children:e.jsx("span",{className:"text-xs text-slate-400",children:"Coming Soon"})})]})]})]})}function tt({db:s,settings:r,setConfirmDialog:t,addToast:n}){const[x,d]=i.useState("skills"),[o,u]=i.useState(""),v=[{id:"skills",label:"ជំនាញ (Skills)"},{id:"groups",label:"ក្រុម (Groups)"},{id:"classes",label:"ថ្នាក់ (Classes)"},{id:"sections",label:"ផ្នែក (Sections)"},{id:"positions",label:"តួនាទី (Positions)"},{id:"schedules",label:"កាលវិភាគ (Schedules)"}],b=async w=>{if(w&&w.preventDefault(),!!o.trim())try{const F=r?.[x]||[];if(F.includes(o)){n("មានរួចហើយ!","error");return}await s.ref(`settings/${x}`).set([...F,o]),u(""),n("បានបន្ថែមជោគជ័យ")}catch(F){console.error(F),n("បរាជ័យ","error")}},h=w=>{t({isOpen:!0,type:"danger",title:"លុបការកំណត់",message:`តើអ្នកពិតជាចង់លុប "${w}" ចេញពីបញ្ជីមែនទេ?`,onConfirm:async()=>{try{const F=r?.[x]||[];await s.ref(`settings/${x}`).set(F.filter(N=>N!==w)),t(N=>({...N,isOpen:!1})),n("បានលុបជោគជ័យ")}catch(F){console.error(F),n("បរាជ័យ","error")}}})};return e.jsxs("div",{className:"animate-fade-in space-y-6",children:[e.jsxs("h2",{className:"text-2xl md:text-3xl font-extrabold text-slate-800 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-xl text-blue-600",children:e.jsx(Ze,{className:"h-6 w-6"})}),"ការកំណត់ Dropdown"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 md:gap-8",children:[e.jsx("div",{className:"glass-panel rounded-3xl p-4 h-fit",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-1 gap-2 md:space-y-2",children:v.map(w=>e.jsxs("button",{onClick:()=>d(w.id),className:`w-full text-left px-3 py-3 md:px-5 md:py-3.5 rounded-xl md:rounded-2xl font-bold transition-all duration-300 flex justify-between items-center text-sm md:text-base ${x===w.id?"bg-indigo-600 text-white shadow-lg shadow-indigo-300 transform scale-105":"text-slate-500 hover:bg-white hover:text-slate-800"}`,children:[e.jsx("span",{className:"truncate",children:w.label}),x===w.id&&e.jsx("div",{className:"hidden md:block h-2 w-2 bg-white rounded-full animate-pulse shrink-0"})]},w.id))})}),e.jsxs("div",{className:"md:col-span-3 glass-panel rounded-3xl p-5 md:p-8 min-h-[500px]",children:[e.jsxs("h3",{className:"text-xl font-bold text-slate-700 mb-6 border-b border-slate-200/50 pb-4",children:[v.find(w=>w.id===x)?.label," List"]}),e.jsxs("form",{onSubmit:b,className:"flex flex-col sm:flex-row gap-3 mb-8",children:[e.jsx("input",{value:o,onChange:w=>u(w.target.value),placeholder:"បញ្ចូលឈ្មោះថ្មី...",className:"flex-1 px-5 py-3 border border-slate-200 rounded-2xl focus:ring-4 focus:ring-indigo-100 outline-none shadow-sm input-modern w-full"}),e.jsx("button",{type:"submit",className:"px-8 py-3 bg-indigo-600 text-white rounded-2xl hover:bg-indigo-700 font-bold shadow-lg shadow-indigo-200 transition-all hover:-translate-y-1 w-full sm:w-auto",children:"បន្ថែម"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:r?.[x]?.map((w,F)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-white border border-slate-100 rounded-2xl group hover:border-indigo-200 hover:shadow-md transition-all",children:[e.jsx("span",{className:"font-semibold text-slate-700 break-words",children:w}),e.jsx("button",{type:"button",onClick:()=>h(w),className:"p-2 text-slate-300 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors shrink-0 cursor-pointer",children:e.jsx(ae,{className:"h-4 w-4"})})]},F))})]})]})]})}const lt=["ឆ្នាំទី១","ឆ្នាំទី២","ឆ្នាំទី៣","ឆ្នាំទី៤"],Re=50,H={Search:s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),Filter:s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:e.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),Sliders:s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("line",{x1:"4",y1:"21",x2:"4",y2:"14"}),e.jsx("line",{x1:"4",y1:"10",x2:"4",y2:"3"}),e.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"3"}),e.jsx("line",{x1:"20",y1:"21",x2:"20",y2:"16"}),e.jsx("line",{x1:"20",y1:"12",x2:"20",y2:"3"}),e.jsx("line",{x1:"1",y1:"14",x2:"7",y2:"14"}),e.jsx("line",{x1:"9",y1:"8",x2:"15",y2:"8"}),e.jsx("line",{x1:"17",y1:"16",x2:"23",y2:"16"})]}),Check:s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",...s,children:e.jsx("polyline",{points:"20 6 9 17 4 12"})}),Edit:s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),X:s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),Briefcase:s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("rect",{x:"2",y:"7",width:"20",height:"14",rx:"2",ry:"2"}),e.jsx("path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"})]}),Calendar:s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),e.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),e.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),User:s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),Loader:s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:e.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),ChevronLeft:s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:e.jsx("polyline",{points:"15 18 9 12 15 6"})}),ChevronRight:s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:e.jsx("polyline",{points:"9 18 15 12 9 6"})}),ListCheck:s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("path",{d:"M16 6h6"}),e.jsx("path",{d:"M16 12h6"}),e.jsx("path",{d:"M16 18h6"}),e.jsx("path",{d:"M5.5 5.5l1.5 1.5 2.5-2.5"}),e.jsx("path",{d:"M5.5 11.5l1.5 1.5 2.5-2.5"}),e.jsx("path",{d:"M5.5 17.5l1.5 1.5 2.5-2.5"})]})},Se=({label:s,value:r,onChange:t,options:n,placeholder:x="មិនកែប្រែ (Keep Current)"})=>{const d=r&&r!==""&&!n.includes(r);return e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("label",{className:"text-[11px] font-bold text-slate-500 uppercase tracking-wide",children:s}),e.jsxs("div",{className:"relative group",children:[e.jsxs("select",{value:r,onChange:t,className:`w-full appearance-none rounded-xl border-2 px-4 py-3 text-sm font-bold outline-none transition-all 
          ${r?"border-indigo-500 bg-indigo-50/50 text-indigo-700":"border-slate-200 bg-white text-slate-400 hover:border-slate-300"}`,children:[e.jsx("option",{value:"",children:x}),d&&e.jsxs("option",{value:r,children:[r," (Current)"]}),n?.map(o=>e.jsx("option",{value:o,children:o},o))]}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none opacity-50",children:e.jsx("svg",{width:"10",height:"6",viewBox:"0 0 10 6",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"m1 1 4 4 4-4"})})})]})]})},at=({dayLabel:s,value:r,onChange:t,options:n})=>{const x=r&&r!=="";return e.jsxs("div",{className:`p-2 rounded-xl border-2 transition-all duration-200 ${x?"bg-white border-orange-400 shadow-sm":"bg-slate-50 border-transparent hover:bg-white hover:border-slate-200"}`,children:[e.jsx("div",{className:"text-[10px] font-extrabold text-slate-400 uppercase text-center mb-1.5",children:s}),e.jsxs("select",{value:r,onChange:t,className:`w-full bg-transparent text-center text-xs font-bold outline-none cursor-pointer ${x?"text-orange-600":"text-slate-400"}`,children:[e.jsx("option",{value:"",children:"-"}),r&&!n?.includes(r)&&e.jsx("option",{value:r,children:r}),n?.map(d=>e.jsx("option",{value:d,children:d},d))]})]})},ue=({label:s,value:r,onChange:t,options:n})=>e.jsxs("div",{className:"relative w-full",children:[e.jsx("label",{className:"text-[10px] font-extrabold text-slate-400 uppercase mb-1 block ml-1",children:s}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:r,onChange:t,className:`w-full appearance-none py-3 pl-4 pr-10 rounded-xl text-sm font-bold border-2 outline-none transition-all cursor-pointer
        ${r?"bg-indigo-600 text-white border-indigo-600 shadow-lg shadow-indigo-200":"bg-slate-50 text-slate-700 border-slate-200 hover:border-indigo-300 hover:bg-white"}`,children:[e.jsxs("option",{value:"",children:["All ",s,"s"]}),n.map(x=>e.jsx("option",{value:x,children:x},x))]}),e.jsx(H.Filter,{className:`absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 pointer-events-none ${r?"text-indigo-200":"text-slate-400"}`})]})]});function rt({db:s,employees:r,settings:t,addToast:n,setConfirmDialog:x}){const[d,o]=i.useState(new Set),[u,v]=i.useState(1),b=i.useRef(null),h=i.useRef(null),[w,F]=i.useState(""),[N,E]=i.useState(""),[W,K]=i.useState(""),[V,_]=i.useState(""),[S,T]=i.useState(""),[k,O]=i.useState(!1),[P,re]=i.useState(!1),[ee,I]=i.useState(!1),[oe,q]=i.useState(!1),[G,B]=i.useState({group:"",section:"",position:"",academicYear:"",mon:"",tue:"",wed:"",thu:"",fri:"",sat:"",sun:""}),X=[w,N,W,V].filter(Boolean).length;i.useEffect(()=>{v(1)},[w,N,W,V,S]),i.useEffect(()=>{if(d.size===0){B({group:"",section:"",position:"",academicYear:"",mon:"",tue:"",wed:"",thu:"",fri:"",sat:"",sun:""});return}const l=r.filter(R=>d.has(R.id));if(l.length===0)return;const y=R=>R==null?"":String(R).trim(),$=["group","section","position","academicYear","mon","tue","wed","thu","fri","sat","sun"],f={};$.forEach(R=>{const Z=y(l[0][R]),xe=l.every(he=>y(he[R])===Z);f[R]=xe&&Z!==""?l[0][R]:""}),B(f)},[d,r]);const A=i.useMemo(()=>{const l=y=>[...new Set(r.map($=>$[y]).filter($=>$))].sort();return{classes:l("class"),years:l("academicYear"),groups:l("group"),sections:l("section")}},[r]),U=i.useMemo(()=>r.filter(l=>{if(![!w||l.class===w,!N||l.academicYear===N,!W||l.group===W,!V||l.section===V,/^\d+$/.test(l.studentId||"")].every(Boolean))return!1;const $=S.toLowerCase().trim(),f=(l.name||"").toLowerCase(),R=(l.latinName||"").toLowerCase(),Z=(l.studentId||"").toLowerCase();return f.includes($)||R.includes($)||Z.includes($)}),[r,w,N,W,V,S]),M=Math.ceil(U.length/Re),me=i.useMemo(()=>{const l=(u-1)*Re;return U.slice(l,l+Re)},[U,u]),j=U.length>0&&d.size===U.length,L=()=>{o(j?new Set:new Set(U.map(l=>l.id)))},c=l=>{const y=new Set(d);y.has(l)?y.delete(l):y.add(l),o(y)},m=l=>{l>=1&&l<=M&&(v(l),window.scrollTo({top:0,behavior:"smooth"}),h.current&&h.current.scrollIntoView({behavior:"smooth"}))},g=()=>{F(""),E(""),K(""),_(""),T("")},z=async()=>{q(!0),x($=>({...$,isOpen:!1})),O(!1);const l={},y={group:"ក្រុម",section:"ផ្នែកការងារ",position:"តួនាទី",academicYear:"ឆ្នាំសិក្សា"};d.forEach($=>{Object.entries(y).forEach(([f,R])=>{G[f]!==""&&(l[`students/${$}/${R}`]=G[f])}),["mon","tue","wed","thu","fri","sat","sun"].forEach((f,R)=>{const Z=["ចន្ទ","អង្គារ៍","ពុធ","ព្រហស្បត្តិ៍","សុក្រ","សៅរ៍","អាទិត្យ"][R];G[f]!==""&&(l[`students/${$}/កាលវិភាគ/${Z}`]=G[f])})});try{Object.keys(l).length>0?(await s.ref().update(l),n(`Successfully updated ${d.size} employees`,"success"),o(new Set)):n("No changes detected to apply","warning")}catch($){console.error($),n("Update failed","error")}finally{q(!1)}},p=()=>{if(!Object.values(G).some(y=>y!==""))return n("Please select at least one field to update","warning");x({isOpen:!0,type:"warning",title:"Confirm Bulk Update",message:`Are you sure you want to update data for ${d.size} selected employees?`,onConfirm:z})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{ref:h,className:"min-h-screen flex flex-col relative animate-fade-in bg-slate-50/50",children:[e.jsx("div",{className:"hidden md:block sticky top-0 z-30 p-4 pb-0",children:e.jsxs("div",{className:"glass-panel px-6 py-4 rounded-3xl flex flex-row gap-6 justify-between items-center shadow-lg shadow-slate-200/50 border border-white/60 relative backdrop-blur-xl bg-white/80",children:[e.jsx("div",{className:"flex items-center gap-3 pr-6 border-r border-slate-200",children:e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group select-none",children:[e.jsx("div",{className:`w-6 h-6 rounded-lg border-2 flex items-center justify-center transition-all ${j?"bg-indigo-600 border-indigo-600":"border-slate-300 bg-white group-hover:border-indigo-400"}`,children:j&&e.jsx(H.Check,{className:"w-4 h-4 text-white"})}),e.jsx("input",{type:"checkbox",className:"hidden",checked:j,onChange:L}),e.jsx("span",{className:`text-sm font-bold ${j?"text-indigo-700":"text-slate-600 group-hover:text-slate-800"}`,children:"Select All"})]})}),e.jsxs("div",{className:"relative flex-1 max-w-xl group",children:[e.jsx(H.Search,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-slate-400 group-focus-within:text-indigo-500 transition-colors"}),e.jsx("input",{type:"text",className:"w-full pl-12 pr-4 py-3 bg-slate-50/50 border-2 border-slate-100 rounded-2xl outline-none focus:bg-white focus:border-indigo-100 focus:ring-4 focus:ring-indigo-50 font-bold transition-all placeholder:font-medium placeholder:text-slate-400",placeholder:"Search by ID, Name...",value:S,onChange:l=>T(l.target.value)})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>I(!ee),className:`flex items-center gap-2 px-5 py-3 rounded-2xl font-bold transition-all border-2 select-none active:scale-95
              ${ee||X>0?"bg-indigo-600 text-white border-indigo-600 shadow-lg shadow-indigo-200":"bg-white text-slate-600 border-slate-200 hover:border-indigo-300 hover:bg-slate-50"}`,children:[e.jsx(H.Sliders,{className:"h-5 w-5"}),e.jsx("span",{children:"Filters"}),X>0&&e.jsx("span",{className:"ml-1 bg-white text-indigo-600 px-2 py-0.5 rounded-md text-xs font-extrabold min-w-[20px] text-center",children:X})]}),ee&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>I(!1)}),e.jsxs("div",{className:"absolute top-full right-0 mt-3 w-[500px] bg-white/95 backdrop-blur-xl rounded-3xl shadow-2xl border border-slate-100 p-6 animate-in fade-in slide-in-from-top-2 z-20",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2.5 bg-indigo-50 rounded-xl text-indigo-600",children:e.jsx(H.Filter,{className:"h-5 w-5"})}),e.jsx("h3",{className:"font-bold text-slate-800 text-lg",children:"Filter Options"})]}),(X>0||S)&&e.jsxs("button",{onClick:g,className:"text-xs font-bold text-slate-400 hover:text-red-500 transition-colors flex items-center gap-1 bg-slate-50 px-3 py-1.5 rounded-lg",children:[e.jsx(H.X,{className:"h-3.5 w-3.5"})," Clear"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[e.jsx(ue,{label:"Group",value:W,onChange:l=>K(l.target.value),options:A.groups}),e.jsx(ue,{label:"Section",value:V,onChange:l=>_(l.target.value),options:A.sections}),e.jsx(ue,{label:"Class",value:w,onChange:l=>F(l.target.value),options:A.classes}),e.jsx(ue,{label:"Year",value:N,onChange:l=>E(l.target.value),options:A.years})]}),e.jsxs("div",{className:"mt-8 pt-5 border-t border-slate-100 flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm font-bold text-slate-500",children:["Found ",e.jsx("span",{className:"text-indigo-600 text-base",children:U.length})," results"]}),e.jsx("button",{onClick:()=>I(!1),className:"bg-indigo-600 text-white font-bold px-6 py-2.5 rounded-xl hover:bg-indigo-700 transition-colors shadow-lg shadow-indigo-200",children:"View Results"})]})]})]})]})]})}),e.jsxs("div",{className:"p-4 md:p-6 pb-32",children:[e.jsx("div",{className:"md:hidden flex justify-between items-end mb-4 px-1",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-slate-800",children:"Employees"}),e.jsxs("p",{className:"text-xs text-slate-500 font-medium",children:["Found: ",e.jsx("span",{className:"text-indigo-600 font-bold",children:U.length})]})]})}),U.length===0?e.jsxs("div",{className:"h-96 flex flex-col items-center justify-center text-slate-400 bg-white/50 rounded-3xl border border-dashed border-slate-200",children:[e.jsx("div",{className:"bg-slate-50 p-6 rounded-full mb-4",children:e.jsx(H.Search,{className:"h-10 w-10 opacity-30"})}),e.jsx("p",{className:"font-bold",children:"No employees found"}),e.jsx("p",{className:"text-xs mt-1",children:"Try adjusting your filters"}),e.jsx("button",{onClick:g,className:"mt-6 text-indigo-600 font-bold text-sm hover:underline bg-indigo-50 px-4 py-2 rounded-lg",children:"Clear All Filters"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-4 mb-8",children:me.map(l=>{const y=d.has(l.id);return e.jsxs("div",{onClick:()=>c(l.id),className:`relative group p-4 rounded-2xl border-2 transition-all cursor-pointer select-none
                    ${y?"bg-indigo-50/90 border-indigo-500 shadow-xl shadow-indigo-100 ring-0 transform scale-[1.01]":"bg-white border-slate-100 hover:border-indigo-300 hover:shadow-lg hover:-translate-y-1"}`,children:[e.jsx("div",{className:`absolute top-4 right-4 h-6 w-6 rounded-lg border-2 flex items-center justify-center transition-all z-10
                      ${y?"bg-indigo-600 border-indigo-600 scale-110":"border-slate-200 bg-white group-hover:border-indigo-400"}`,children:y&&e.jsx(H.Check,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`h-14 w-14 rounded-2xl overflow-hidden shrink-0 border-2 transition-colors ${y?"border-indigo-200":"border-slate-100 bg-slate-50"}`,children:l.imageUrl?e.jsx("img",{src:l.imageUrl,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full flex items-center justify-center text-slate-300",children:e.jsx(H.User,{className:"h-6 w-6"})})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"inline-flex items-center px-2 py-0.5 rounded-md bg-slate-100 text-slate-600 text-[10px] font-mono font-bold mb-1",children:l.studentId}),e.jsx("h3",{className:`font-bold truncate transition-colors ${y?"text-indigo-700":"text-slate-800"}`,children:l.name}),e.jsx("p",{className:"text-xs text-slate-500 truncate",children:l.latinName})]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-slate-100/80 flex gap-2 text-[10px] font-bold text-slate-500 uppercase overflow-hidden",children:[e.jsx("span",{className:"bg-slate-50 px-2 py-1 rounded-md border border-slate-200 truncate max-w-[80px]",children:l.group||"N/A"}),e.jsx("span",{className:"bg-slate-50 px-2 py-1 rounded-md border border-slate-200 truncate max-w-[80px]",children:l.section||"N/A"}),e.jsx("span",{className:"bg-slate-50 px-2 py-1 rounded-md border border-slate-200 ml-auto",children:l.academicYear||"N/A"})]})]},l.id)})}),M>1&&e.jsxs("div",{className:"flex justify-center items-center gap-2",children:[e.jsx("button",{onClick:()=>m(u-1),disabled:u===1,className:"p-3 rounded-xl border-2 border-slate-200 bg-white text-slate-600 hover:border-indigo-300 hover:text-indigo-600 disabled:opacity-40 disabled:hover:border-slate-200 transition-all active:scale-95",children:e.jsx(H.ChevronLeft,{className:"h-5 w-5"})}),e.jsx("div",{className:"hidden sm:flex gap-2",children:Array.from({length:M},(l,y)=>y+1).map(l=>l===1||l===M||l>=u-1&&l<=u+1?e.jsx("button",{onClick:()=>m(l),className:`w-10 h-10 rounded-xl font-bold text-sm border-2 transition-all
                          ${u===l?"bg-indigo-600 border-indigo-600 text-white shadow-lg shadow-indigo-200":"bg-white border-slate-200 text-slate-600 hover:border-indigo-300 hover:text-indigo-600"}`,children:l},l):l===u-2||l===u+2?e.jsx("span",{className:"w-10 h-10 flex items-center justify-center text-slate-300 font-bold",children:"..."},l):null)}),e.jsxs("div",{className:"sm:hidden font-bold text-slate-600 text-sm bg-white px-4 py-2 rounded-xl border border-slate-200",children:["Page ",u," of ",M]}),e.jsx("button",{onClick:()=>m(u+1),disabled:u===M,className:"p-3 rounded-xl border-2 border-slate-200 bg-white text-slate-600 hover:border-indigo-300 hover:text-indigo-600 disabled:opacity-40 disabled:hover:border-slate-200 transition-all active:scale-95",children:e.jsx(H.ChevronRight,{className:"h-5 w-5"})})]})]})]})]}),e.jsxs("div",{className:"md:hidden fixed bottom-6 right-6 z-40 flex flex-col gap-3 items-end",children:[e.jsx("button",{onClick:L,className:`h-14 w-14 rounded-full shadow-lg flex items-center justify-center transition-all border-2 
            ${j?"bg-indigo-600 text-white border-indigo-600 shadow-indigo-300":"bg-white text-slate-500 border-slate-200 shadow-slate-200"}`,children:j?e.jsx(H.Check,{className:"h-6 w-6"}):e.jsx(H.ListCheck,{className:"h-6 w-6"})}),e.jsxs("button",{onClick:()=>re(!0),className:`h-14 w-14 rounded-full shadow-xl flex items-center justify-center hover:scale-105 active:scale-95 transition-all border-4 border-white/20
            ${S||X>0?"bg-indigo-600 text-white shadow-indigo-300":"bg-slate-800 text-white shadow-slate-400"}`,children:[e.jsx(H.Search,{className:"h-6 w-6"}),X>0&&e.jsx("span",{className:"absolute top-0 right-0 h-4 w-4 bg-red-500 text-[10px] font-bold text-white flex items-center justify-center rounded-full border border-white",children:X})]})]}),P&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end justify-center md:hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm animate-in fade-in duration-200",onClick:()=>re(!1)}),e.jsxs("div",{className:"relative w-full bg-white rounded-t-[2rem] shadow-2xl p-6 pb-8 animate-in slide-in-from-bottom duration-300 max-h-[85vh] overflow-y-auto flex flex-col",children:[e.jsx("div",{className:"absolute top-3 left-1/2 -translate-x-1/2 h-1.5 w-12 bg-slate-200 rounded-full"}),e.jsxs("div",{className:"flex justify-between items-center mb-6 mt-2",children:[e.jsx("h2",{className:"text-xl font-black text-slate-800",children:"Search & Filters"}),e.jsx("button",{onClick:g,className:"text-xs font-bold text-slate-400 hover:text-red-500 transition-colors",children:"Reset All"})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative group",children:[e.jsx(H.Search,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-indigo-500"}),e.jsx("input",{ref:b,type:"text",className:"w-full pl-12 pr-10 py-4 bg-slate-50 border-2 border-slate-100 rounded-2xl outline-none focus:border-indigo-500 focus:bg-white font-bold text-lg transition-all text-slate-800 placeholder:text-slate-400",placeholder:"Search name or ID...",value:S,onChange:l=>T(l.target.value)}),S&&e.jsx("button",{onClick:()=>T(""),className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 bg-slate-200 rounded-full text-slate-500 hover:bg-slate-300",children:e.jsx(H.X,{className:"h-3 w-3"})})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8",children:[e.jsx(ue,{label:"Group",value:W,onChange:l=>K(l.target.value),options:A.groups}),e.jsx(ue,{label:"Section",value:V,onChange:l=>_(l.target.value),options:A.sections}),e.jsx(ue,{label:"Class",value:w,onChange:l=>F(l.target.value),options:A.classes}),e.jsx(ue,{label:"Year",value:N,onChange:l=>E(l.target.value),options:A.years})]}),e.jsxs("button",{onClick:()=>re(!1),className:"w-full py-4 bg-indigo-600 text-white rounded-2xl font-bold text-lg shadow-lg shadow-indigo-200 active:scale-[0.98] transition-all",children:["Show ",U.length," Results"]})]})]}),e.jsx("div",{className:`fixed bottom-6 left-0 right-0 flex justify-center z-30 transition-all duration-300 ${d.size>0?"translate-y-0 opacity-100":"translate-y-32 opacity-0 pointer-events-none"}`,children:e.jsxs("div",{className:"bg-slate-900/90 backdrop-blur-md text-white px-2 py-2 rounded-2xl shadow-2xl flex items-center gap-4 border border-white/10 mx-4 max-w-lg w-full",children:[e.jsxs("div",{className:"bg-indigo-600 px-4 py-2 rounded-xl font-bold flex items-center gap-2 text-sm shadow-inner",children:[e.jsx("span",{className:"bg-white text-indigo-700 px-1.5 rounded text-xs",children:d.size}),e.jsx("span",{children:"Selected"})]}),e.jsx("div",{className:"flex-1 text-xs text-slate-400 font-medium truncate hidden sm:block",children:"Ready to update details"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>o(new Set),className:"text-slate-300 hover:text-white text-xs font-bold px-3 py-2 hover:bg-white/10 rounded-lg transition-colors",children:"Clear"}),e.jsxs("button",{onClick:()=>O(!0),className:"bg-white text-slate-900 px-5 py-2.5 rounded-xl text-sm font-bold hover:bg-indigo-50 active:scale-95 transition-all flex items-center gap-2 shadow-lg",children:[e.jsx(H.Edit,{className:"h-4 w-4"})," Edit"]})]})]})}),k&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-md animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white rounded-[2rem] shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"px-8 py-6 border-b border-slate-100 flex justify-between items-center bg-slate-50/50",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-slate-800",children:"Bulk Edit"}),e.jsxs("p",{className:"text-sm text-slate-500 font-medium",children:["Updating ",e.jsxs("span",{className:"text-indigo-600 font-bold bg-indigo-50 px-2 py-0.5 rounded",children:[d.size," employees"]})]})]}),e.jsx("button",{onClick:()=>O(!1),className:"h-10 w-10 rounded-full bg-white border border-slate-200 flex items-center justify-center text-slate-400 hover:bg-slate-100 transition-colors",children:e.jsx(H.X,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-8 custom-scrollbar bg-slate-50/30",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-indigo-600 font-bold uppercase text-xs tracking-wider mb-2",children:[e.jsx(H.Briefcase,{className:"h-4 w-4"})," Employment Details"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Se,{label:"Group (ក្រុម)",name:"group",value:G.group,onChange:l=>B({...G,group:l.target.value}),options:t?.groups}),e.jsx(Se,{label:"Section (ផ្នែក)",name:"section",value:G.section,onChange:l=>B({...G,section:l.target.value}),options:t?.sections}),e.jsx(Se,{label:"Position (តួនាទី)",name:"position",value:G.position,onChange:l=>B({...G,position:l.target.value}),options:t?.positions}),e.jsx(Se,{label:"Academic Year",name:"academicYear",value:G.academicYear,onChange:l=>B({...G,academicYear:l.target.value}),options:lt})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-orange-500 font-bold uppercase text-xs tracking-wider mb-2",children:[e.jsx(H.Calendar,{className:"h-4 w-4"})," Weekly Schedule"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:["mon","tue","wed","thu","fri","sat","sun"].map((l,y)=>e.jsx(at,{dayLabel:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"][y],value:G[l],onChange:$=>B({...G,[l]:$.target.value}),options:t?.schedules},l))})]})]})}),e.jsxs("div",{className:"p-6 border-t border-slate-100 bg-white flex justify-end gap-3 z-10",children:[e.jsx("button",{onClick:()=>O(!1),className:"px-6 py-3 rounded-xl font-bold text-slate-500 hover:bg-slate-100 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:p,disabled:oe,className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold shadow-lg shadow-indigo-200 flex items-center gap-2 active:scale-95 transition-all disabled:opacity-50",children:[oe?e.jsx(H.Loader,{className:"h-5 w-5 animate-spin"}):e.jsx(H.Check,{className:"h-5 w-5"})," Save Changes"]})]})]})})]})}function nt(){const[s,r]=i.useState(null),[t,n]=i.useState(null),[x,d]=i.useState(!1),[o,u]=i.useState(""),[v,b]=i.useState(!1),[h,w]=i.useState([]),[F,N]=i.useState([]),[E,W]=i.useState({}),[K,V]=i.useState(!0),[_,S]=i.useState(!1),[T,k]=i.useState(null),[O,P]=i.useState({isOpen:!1,title:"",message:"",onConfirm:null,type:"danger"}),re=ns(),{toasts:ee,addToast:I,removeToast:oe}=et();i.useEffect(()=>{const j=Ce.onAuthStateChanged(L=>{L&&(L.isAnonymous||!L.email)?(Ce.signOut(),r(null),localStorage.removeItem("user_session"),n(null)):(r(L),L?localStorage.setItem("user_session",JSON.stringify({uid:L.uid,email:L.email})):(localStorage.removeItem("user_session"),n(null))),V(!1)});return()=>j()},[]),i.useEffect(()=>{if(!s)return;const j=le.ref("students"),L=le.ref("deleted_students"),c=le.ref("settings"),m=le.ref("userAdmin/"+s.uid),g=(z,p)=>{const l=z.val();if(l){const y=Object.keys(l).map($=>{const f=l[$]||{},R=f.កាលវិភាគ||{};return{id:$,imageUrl:Y(f.រូបថត||f.imageUrl),name:Y(f.ឈ្មោះ||f.name),latinName:Y(f.ឈ្មោះឡាតាំង),gender:Y(f.ភេទ),dob:Y(f.ថ្ងៃខែឆ្នាំកំណើត),pob:Y(f.ទីកន្លែងកំណើត),studentId:Y(f.អត្តលេខ),academicYear:Y(f.ឆ្នាំសិក្សា),generation:Y(f.ជំនាន់),group:Y(f.ក្រុម),class:Y(f.ថ្នាក់),skill:Y(f.ជំនាញ),section:Y(f.ផ្នែកការងារ),position:Y(f.តួនាទី),telegram:Y(f.តេឡេក្រាម),mon:Y(R.ចន្ទ||f.ចន្ទ),tue:Y(R.អង្គារ៍||f.អង្គារ៍),wed:Y(R.ពុធ||f.ពុធ),thu:Y(R.ព្រហស្បត្តិ៍||f.ព្រហស្បត្តិ៍),fri:Y(R.សុក្រ||f.សុក្រ),sat:Y(R.សៅរ៍||f.សៅរ៍),sun:Y(R.អាទិត្យ||f.អាទិត្យ),originalData:f}});p(y.reverse())}else p([])};return j.on("value",z=>{g(z,w),V(!1)}),L.on("value",z=>g(z,N)),c.on("value",z=>W(z.val()||{})),m.on("value",z=>{const p=z.val();p&&n(p)}),()=>{j.off(),L.off(),c.off(),m.off()}},[s]);const q=async(j,L)=>{d(!0),u("");try{await Ce.signInWithEmailAndPassword(j,L)}catch(c){console.error("Login failed:",c);let m="Failed to sign in. Please check your credentials.";c.code==="auth/wrong-password"&&(m="Incorrect password."),c.code==="auth/user-not-found"&&(m="No user found with this email."),u(m)}finally{d(!1)}},G=()=>{P({isOpen:!0,type:"danger",title:"Sign Out",message:"Are you sure you want to sign out?",onConfirm:async()=>{await Ce.signOut(),localStorage.removeItem("user_session"),P(j=>({...j,isOpen:!1})),I("Signed out successfully","success")}})},B=i.useCallback(j=>{const L=h.find(c=>c.id===j);P({isOpen:!0,type:"danger",title:"បញ្ជាក់ការលុប",message:`តើអ្នកពិតជាចង់លុប "${L?.name}" ទៅកាន់ធុងសំរាមមែនទេ?`,onConfirm:async()=>{try{await le.ref(`deleted_students/${L.id}`).set({...L.originalData,deletedAt:Date.now()}),await le.ref(`students/${L.id}`).remove(),P(c=>({...c,isOpen:!1})),I("បានបញ្ជូនទៅធុងសំរាម","success")}catch{I("បរាជ័យក្នុងការលុប","error")}}})},[h,I]),X=i.useCallback(j=>{!j||j.length===0||P({isOpen:!0,type:"danger",title:"បញ្ជាក់ការលុបជាក្រុម",message:`តើអ្នកប្រាកដជាចង់លុបបុគ្គលិកចំនួន ${j.length} នាក់ ទៅកាន់ធុងសំរាមមែនទេ?`,onConfirm:async()=>{try{const L={};j.forEach(c=>{const m=h.find(g=>g.id===c);m&&(L[`deleted_students/${c}`]={...m.originalData,deletedAt:Date.now()},L[`students/${c}`]=null)}),await le.ref().update(L),P(c=>({...c,isOpen:!1})),I(`បានលុបចំនួន ${j.length} នាក់ជោគជ័យ`,"success")}catch{I("បរាជ័យក្នុងការលុបជាក្រុម","error")}}})},[h,I]),A=i.useCallback(j=>{P({isOpen:!0,type:"restore",title:"បញ្ជាក់ការស្តារ",message:`តើអ្នកចង់ស្តារ "${j.name}" ត្រឡប់មកវិញទេ?`,onConfirm:async()=>{try{await le.ref(`students/${j.id}`).set(j.originalData),await le.ref(`deleted_students/${j.id}`).remove(),P(L=>({...L,isOpen:!1})),I("បានស្តារទិន្នន័យជោគជ័យ","success")}catch{I("បរាជ័យ","error")}}})},[I]),U=i.useCallback(j=>{P({isOpen:!0,type:"danger",title:"លុបជារៀងរហូត",message:"តើអ្នកចង់លុបជារៀងរហូតមែនទេ? ទិន្នន័យមិនអាចយកមកវិញបានទេ។",onConfirm:async()=>{try{await le.ref(`deleted_students/${j}`).remove(),P(L=>({...L,isOpen:!1})),I("លុបជាស្ថាពរជោគជ័យ","success")}catch{I("បរាជ័យ","error")}}})},[I]),M=i.useCallback(async(j,L,c)=>{try{await le.ref(`students/${j}`).update({[L]:c})}catch{I("បរាជ័យក្នុងការកែប្រែ","error")}},[I]),me=i.useMemo(()=>({total:h.length,male:h.filter(j=>j.gender==="ប្រុស").length,female:h.filter(j=>j.gender==="ស្រី").length}),[h]);return K?e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"text-slate-400 text-sm font-medium animate-pulse",children:"Loading HR Pro..."})]})}):s?e.jsxs("div",{className:"flex h-screen overflow-hidden bg-slate-50",children:[e.jsx(Is,{sidebarOpen:v,setSidebarOpen:b,adminProfile:t,user:s,handleLogout:G}),v&&e.jsx("div",{className:"fixed inset-0 bg-black/60 z-40 md:hidden backdrop-blur-sm transition-opacity",onClick:()=>b(!1)}),e.jsxs("div",{className:"flex-1 flex flex-col h-full overflow-hidden relative",children:[e.jsx(As,{setSidebarOpen:b,adminProfile:t,user:s}),e.jsx("main",{className:"flex-1 overflow-y-auto px-4 pb-4 md:px-8 md:pb-8 custom-scrollbar",children:e.jsxs(is,{children:[e.jsx(ve,{path:"/",element:e.jsx(st,{stats:me,onNavigate:j=>re(j)})}),e.jsx(ve,{path:"/employees",element:e.jsx(Ws,{employees:h,loading:K,settings:E,isModalOpen:_,onEdit:j=>{k(j),S(!0)},onDelete:B,onInlineUpdate:M,onCreate:()=>{k(null),S(!0)},onBulkDelete:X})}),e.jsx(ve,{path:"/recycle-bin",element:e.jsx(Vs,{employees:F,loading:K,onRestore:A,onPermanentDelete:U})}),e.jsx(ve,{path:"/bulk-edit",element:e.jsx(rt,{db:le,employees:h,settings:E,addToast:I,setConfirmDialog:P})}),e.jsx(ve,{path:"/settings",element:e.jsx(tt,{db:le,settings:E,setConfirmDialog:P,addToast:I})})]})})]}),_&&e.jsx(Qs,{isOpen:_,onClose:()=>S(!1),employee:T,db:le,addToast:I,settings:E}),e.jsx(Ts,{isOpen:O.isOpen,onClose:()=>P(j=>({...j,isOpen:!1})),...O}),e.jsx(zs,{toasts:ee,removeToast:oe})]}):e.jsx($s,{onLogin:q,loading:x,error:o})}os.createRoot(document.getElementById("root")).render(e.jsx(ds.StrictMode,{children:e.jsx(cs,{children:e.jsx(nt,{})})}));
