import{f as ue,j as e,r as d,u as _e,R as Ye,a as oe,N as de,b as Ue,c as We,d as Ge,H as Te}from"./vendor-BxNiQCT2.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))o(u);new MutationObserver(u=>{for(const r of u)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function n(u){const r={};return u.integrity&&(r.integrity=u.integrity),u.referrerPolicy&&(r.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?r.credentials="include":u.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(u){if(u.ep)return;u.ep=!0;const r=n(u);fetch(u.href,r)}})();const Ve={apiKey:"AIzaSyAc2g-t9A7du3K_nI2fJnw_OGxhmLfpP6s",authDomain:"dilistname.firebaseapp.com",databaseURL:"https://dilistname-default-rtdb.firebaseio.com",projectId:"dilistname",storageBucket:"dilistname.firebasestorage.app",messagingSenderId:"897983357871",appId:"1:897983357871:web:42a046bc9fb3e0543dc55a",measurementId:"G-NQ798D9J6K"};ue.apps.length||ue.initializeApp(Ve);const W=ue.database(),xe=ue.auth(),A=({children:s,className:i,...n})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:i,...n,children:s}),Oe=s=>e.jsxs(A,{...s,children:[e.jsx("ellipse",{cx:"12",cy:"5",rx:"9",ry:"3"}),e.jsx("path",{d:"M3 5V19A9 3 0 0 0 21 19V5"}),e.jsx("path",{d:"M3 12A9 3 0 0 0 21 12"})]}),he=s=>e.jsxs(A,{...s,children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"m21 21-4.3-4.3"})]}),fe=s=>e.jsxs(A,{...s,children:[e.jsx("path",{d:"M5 12h14"}),e.jsx("path",{d:"M12 5v14"})]}),ze=s=>e.jsxs(A,{...s,children:[e.jsx("rect",{width:"7",height:"7",x:"3",y:"3",rx:"1"}),e.jsx("rect",{width:"7",height:"7",x:"14",y:"3",rx:"1"}),e.jsx("rect",{width:"7",height:"7",x:"14",y:"14",rx:"1"}),e.jsx("rect",{width:"7",height:"7",x:"3",y:"14",rx:"1"})]}),He=s=>e.jsxs(A,{...s,children:[e.jsx("line",{x1:"8",x2:"21",y1:"6",y2:"6"}),e.jsx("line",{x1:"8",x2:"21",y1:"12",y2:"12"}),e.jsx("line",{x1:"8",x2:"21",y1:"18",y2:"18"}),e.jsx("line",{x1:"3",x2:"3.01",y1:"6",y2:"6"}),e.jsx("line",{x1:"3",x2:"3.01",y1:"12",y2:"12"}),e.jsx("line",{x1:"3",x2:"3.01",y1:"18",y2:"18"})]}),De=s=>e.jsx(A,{...s,children:e.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"})}),ne=s=>e.jsxs(A,{...s,children:[e.jsx("path",{d:"M3 6h18"}),e.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),e.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),e.jsx("line",{x1:"10",x2:"10",y1:"11",y2:"17"}),e.jsx("line",{x1:"14",x2:"14",y1:"11",y2:"17"})]}),pe=s=>e.jsxs(A,{...s,children:[e.jsx("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),Pe=s=>e.jsxs(A,{...s,children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),Ke=s=>e.jsxs(A,{...s,children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("polyline",{points:"16 11 18 13 22 9"})]}),qe=s=>e.jsxs(A,{...s,children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("line",{x1:"19",x2:"19",y1:"8",y2:"14"}),e.jsx("line",{x1:"22",x2:"16",y1:"11",y2:"11"})]}),Xe=s=>e.jsxs(A,{...s,children:[e.jsx("line",{x1:"22",x2:"11",y1:"2",y2:"13"}),e.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]}),me=s=>e.jsxs(A,{...s,children:[e.jsx("path",{d:"M18 6 6 18"}),e.jsx("path",{d:"m6 6 12 12"})]}),Ze=s=>e.jsxs(A,{...s,children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),Je=s=>e.jsxs(A,{...s,children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",x2:"12",y1:"8",y2:"12"}),e.jsx("line",{x1:"12",x2:"12.01",y1:"16",y2:"16"})]}),Qe=s=>e.jsx(A,{...s,children:e.jsx("polyline",{points:"15 18 9 12 15 6"})}),Fe=s=>e.jsx(A,{...s,children:e.jsx("polyline",{points:"9 18 15 12 9 6"})}),ge=s=>e.jsxs(A,{...s,children:[e.jsx("polyline",{points:"1 4 1 10 7 10"}),e.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),es=s=>e.jsxs(A,{...s,children:[e.jsx("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}),e.jsx("line",{x1:"12",x2:"12",y1:"9",y2:"13"}),e.jsx("line",{x1:"12",x2:"12.01",y1:"17",y2:"17"})]}),ss=s=>e.jsxs(A,{...s,children:[e.jsx("line",{x1:"4",x2:"20",y1:"12",y2:"12"}),e.jsx("line",{x1:"4",x2:"20",y1:"6",y2:"6"}),e.jsx("line",{x1:"4",x2:"20",y1:"18",y2:"18"})]}),ts=s=>e.jsxs(A,{...s,children:[e.jsx("path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),Re=s=>e.jsxs(A,{...s,children:[e.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.35a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),ls=s=>e.jsxs(A,{...s,children:[e.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),e.jsx("polyline",{points:"16 17 21 12 16 7"}),e.jsx("line",{x1:"21",x2:"9",y1:"12",y2:"12"})]}),as=s=>e.jsxs(A,{...s,children:[e.jsx("path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"}),e.jsx("path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0"})]}),ve=s=>e.jsxs(A,{...s,children:[e.jsx("polyline",{points:"9 11 12 14 22 4"}),e.jsx("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"})]}),Ie=({className:s})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:s,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),ns=({toasts:s,removeToast:i})=>e.jsx("div",{className:"fixed bottom-6 right-6 z-[100] flex flex-col gap-3 pointer-events-none",children:s.map(n=>e.jsxs("div",{className:`pointer-events-auto flex items-center gap-3 px-5 py-3.5 rounded-2xl shadow-xl shadow-slate-200/50 transform transition-all animate-fade-in border ${n.type==="success"?"bg-white text-emerald-600 border-emerald-100":"bg-white text-red-600 border-red-100"}`,children:[n.type==="success"?e.jsx("div",{className:"bg-emerald-100 p-1.5 rounded-full",children:e.jsx(Ze,{className:"h-4 w-4"})}):e.jsx("div",{className:"bg-red-100 p-1.5 rounded-full",children:e.jsx(Je,{className:"h-4 w-4"})}),e.jsx("span",{className:"font-medium text-sm text-slate-700",children:n.message}),e.jsx("button",{onClick:()=>i(n.id),className:"opacity-60 hover:opacity-100 hover:bg-slate-100 p-1 rounded-md transition-all",children:e.jsx(me,{className:"h-4 w-4"})})]},n.id))}),_=d.memo(({value:s,onSave:i,className:n,options:o})=>{const[u,r]=d.useState(!1),[l,y]=d.useState(s),h=d.useRef(null);d.useEffect(()=>{y(s)},[s]),d.useEffect(()=>{u&&h.current&&h.current.focus()},[u]);const $=()=>{r(!1),l!==s&&i(l)},L=x=>{const S=x.target.value;y(S),i(S),r(!1)};return u?o&&o.length>0?e.jsxs("select",{ref:h,value:l,onChange:L,onBlur:()=>r(!1),className:`w-full min-w-[100px] p-1.5 border-2 border-indigo-400 rounded-lg bg-white text-slate-900 outline-none text-sm shadow-lg animate-in fade-in zoom-in duration-200 ${n}`,children:[e.jsx("option",{value:"",disabled:!0,children:"Select..."}),!o.includes(s)&&s&&e.jsx("option",{value:s,children:s}),o.map((x,S)=>e.jsx("option",{value:x,children:x},`${x}-${S}`))]}):e.jsx("input",{ref:h,value:l,onChange:x=>y(x.target.value),onBlur:$,onKeyDown:x=>{x.key==="Enter"?h.current.blur():x.key==="Escape"&&(y(s),r(!1))},className:`w-full min-w-[80px] p-1.5 border-2 border-indigo-400 rounded-lg bg-white text-slate-900 outline-none text-sm shadow-lg animate-in fade-in zoom-in duration-200 ${n}`}):e.jsxs("div",{onClick:x=>{x.stopPropagation(),r(!0)},className:`cursor-pointer group hover:bg-indigo-50 hover:text-indigo-700 px-2 py-1.5 -mx-2 rounded-lg transition-all border border-transparent hover:border-indigo-100 min-h-[32px] flex items-center relative ${n}`,title:"Click to edit",children:[e.jsx("span",{className:"truncate w-full",children:s||e.jsx("span",{className:"text-slate-300 italic text-xs",children:"Empty"})}),e.jsx("span",{className:"absolute right-1 opacity-0 group-hover:opacity-40 text-[10px] text-indigo-400",children:"▼"})]})}),je=d.memo(({icon:s,label:i,value:n,color:o})=>e.jsxs("div",{className:"bg-white/80 backdrop-blur-xl p-6 rounded-3xl border border-white/50 shadow-[0_8px_30px_rgb(0,0,0,0.04)] flex items-center gap-5 hover:-translate-y-1 transition-transform duration-300 group",children:[e.jsx("div",{className:`p-4 rounded-2xl ${o.replace("bg-","bg-opacity-10 text-")} group-hover:scale-110 transition-transform duration-300`,children:e.jsx(s,{className:`h-8 w-8 ${o.replace("bg-","text-")}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 text-sm font-semibold tracking-wide uppercase mb-1",children:i}),e.jsx("h3",{className:"text-3xl font-extrabold text-slate-800 tracking-tight",children:n})]})]})),rs=({isOpen:s,onClose:i,onConfirm:n,title:o,message:u,type:r="danger"})=>s?e.jsx("div",{className:"fixed inset-0 bg-slate-900/40 backdrop-blur-sm z-[60] flex items-center justify-center p-4 animate-fade-in",children:e.jsx("div",{className:"bg-white rounded-3xl max-w-sm w-full p-8 animate-scale-in shadow-2xl relative",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:`p-4 rounded-full mb-5 ${r==="danger"?"bg-red-50 text-red-500":"bg-blue-50 text-blue-500"}`,children:r==="danger"?e.jsx(es,{className:"h-8 w-8"}):e.jsx(ge,{className:"h-8 w-8"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-2",children:o}),e.jsx("p",{className:"text-slate-500 text-sm mb-8 leading-relaxed",children:u}),e.jsxs("div",{className:"flex gap-3 w-full",children:[e.jsx("button",{onClick:i,className:"flex-1 py-3 rounded-xl border border-slate-200 text-slate-600 font-bold hover:bg-slate-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:n,className:`flex-1 py-3 rounded-xl text-white font-bold shadow-lg hover:shadow-xl transition-all hover:-translate-y-0.5 ${r==="danger"?"bg-red-500 hover:bg-red-600 shadow-red-500/30":"bg-blue-600 hover:bg-blue-700 shadow-blue-500/30"}`,children:r==="danger"?"Confirm":"Restore"})]})]})})}):null;function is({stats:s,onNavigate:i}){return e.jsxs("div",{className:"space-y-8 animate-fade-in max-w-7xl mx-auto",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(je,{icon:Pe,label:"Total Employees",value:s.total,color:"bg-blue-500"}),e.jsx(je,{icon:Ke,label:"Male Staff",value:s.male,color:"bg-indigo-500"}),e.jsx(je,{icon:qe,label:"Female Staff",value:s.female,color:"bg-pink-500"})]}),e.jsxs("div",{className:"glass-panel rounded-3xl p-10 flex flex-col items-center justify-center text-center min-h-[400px]",children:[e.jsx("div",{className:"bg-indigo-50 p-6 rounded-full mb-6 animate-scale-in",children:e.jsx(ts,{className:"h-16 w-16 text-indigo-500"})}),e.jsx("h2",{className:"text-3xl font-extrabold text-slate-800 mb-3",children:"Welcome to HR System Pro"}),e.jsx("p",{className:"text-slate-500 max-w-lg text-lg mb-8",children:"គ្រប់គ្រងទិន្នន័យបុគ្គលិករបស់អ្នកដោយងាយស្រួល និងមានប្រសិទ្ធភាពខ្ពស់។"}),e.jsx("button",{onClick:()=>i("employees"),className:"px-8 py-3 bg-indigo-600 text-white rounded-2xl font-bold hover:bg-indigo-700 shadow-xl shadow-indigo-300 hover:-translate-y-1 transition-all",children:"ចាប់ផ្តើមគ្រប់គ្រង"})]})]})}function os({db:s,settings:i,setConfirmDialog:n,addToast:o}){const[u,r]=d.useState("skills"),[l,y]=d.useState(""),h=[{id:"skills",label:"ជំនាញ (Skills)"},{id:"groups",label:"ក្រុម (Groups)"},{id:"classes",label:"ថ្នាក់ (Classes)"},{id:"sections",label:"ផ្នែក (Sections)"},{id:"positions",label:"តួនាទី (Positions)"},{id:"schedules",label:"កាលវិភាគ (Schedules)"}],$=async x=>{if(x&&x.preventDefault(),!!l.trim())try{const S=i?.[u]||[];if(S.includes(l)){o("មានរួចហើយ!","error");return}await s.ref(`settings/${u}`).set([...S,l]),y(""),o("បានបន្ថែមជោគជ័យ")}catch(S){console.error(S),o("បរាជ័យ","error")}},L=x=>{n({isOpen:!0,type:"danger",title:"លុបការកំណត់",message:`តើអ្នកពិតជាចង់លុប "${x}" ចេញពីបញ្ជីមែនទេ?`,onConfirm:async()=>{try{const S=i?.[u]||[];await s.ref(`settings/${u}`).set(S.filter(z=>z!==x)),n(z=>({...z,isOpen:!1})),o("បានលុបជោគជ័យ")}catch(S){console.error(S),o("បរាជ័យ","error")}}})};return e.jsxs("div",{className:"animate-fade-in space-y-6",children:[e.jsxs("h2",{className:"text-2xl md:text-3xl font-extrabold text-slate-800 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-xl text-blue-600",children:e.jsx(Re,{className:"h-6 w-6"})}),"ការកំណត់ Dropdown"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 md:gap-8",children:[e.jsx("div",{className:"glass-panel rounded-3xl p-4 h-fit",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-1 gap-2 md:space-y-2",children:h.map(x=>e.jsxs("button",{onClick:()=>r(x.id),className:`w-full text-left px-3 py-3 md:px-5 md:py-3.5 rounded-xl md:rounded-2xl font-bold transition-all duration-300 flex justify-between items-center text-sm md:text-base ${u===x.id?"bg-indigo-600 text-white shadow-lg shadow-indigo-300 transform scale-105":"text-slate-500 hover:bg-white hover:text-slate-800"}`,children:[e.jsx("span",{className:"truncate",children:x.label}),u===x.id&&e.jsx("div",{className:"hidden md:block h-2 w-2 bg-white rounded-full animate-pulse shrink-0"})]},x.id))})}),e.jsxs("div",{className:"md:col-span-3 glass-panel rounded-3xl p-5 md:p-8 min-h-[500px]",children:[e.jsxs("h3",{className:"text-xl font-bold text-slate-700 mb-6 border-b border-slate-200/50 pb-4",children:[h.find(x=>x.id===u)?.label," List"]}),e.jsxs("form",{onSubmit:$,className:"flex flex-col sm:flex-row gap-3 mb-8",children:[e.jsx("input",{value:l,onChange:x=>y(x.target.value),placeholder:"បញ្ចូលឈ្មោះថ្មី...",className:"flex-1 px-5 py-3 border border-slate-200 rounded-2xl focus:ring-4 focus:ring-indigo-100 outline-none shadow-sm input-modern w-full"}),e.jsx("button",{type:"submit",className:"px-8 py-3 bg-indigo-600 text-white rounded-2xl hover:bg-indigo-700 font-bold shadow-lg shadow-indigo-200 transition-all hover:-translate-y-1 w-full sm:w-auto",children:"បន្ថែម"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:i?.[u]?.map((x,S)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-white border border-slate-100 rounded-2xl group hover:border-indigo-200 hover:shadow-md transition-all",children:[e.jsx("span",{className:"font-semibold text-slate-700 break-words",children:x}),e.jsx("button",{type:"button",onClick:()=>L(x),className:"p-2 text-slate-300 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors shrink-0 cursor-pointer",children:e.jsx(ne,{className:"h-4 w-4"})})]},S))})]})]})]})}const ds=["2023-2024","2024-2025","2025-2026","2026-2027"],Be=s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),cs=s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:e.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),xs=s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:e.jsx("polyline",{points:"6 9 12 15 18 9"})}),Le=s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),hs=s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:e.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),us=s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("rect",{x:"2",y:"7",width:"20",height:"14",rx:"2",ry:"2"}),e.jsx("path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"})]}),$e=s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),e.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),e.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),we=s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),Me=s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),ms=s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),e.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]}),ps=s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),Ae=({searchTerm:s,setSearchTerm:i,filterClass:n,setFilterClass:o,filterYear:u,setFilterYear:r,filterGroup:l,setFilterGroup:y,uniqueClasses:h,uniqueYears:$,uniqueGroups:L})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative w-full md:w-64 group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Be,{className:"h-4 w-4 text-slate-400 group-focus-within:text-indigo-500 transition-colors"})}),e.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2.5 border border-slate-200 rounded-xl bg-white text-sm font-medium outline-none focus:ring-2 focus:ring-indigo-200 transition-all placeholder:text-slate-400",placeholder:"ស្វែងរក...",value:s,onChange:x=>i(x.target.value)})]}),e.jsxs("div",{className:"flex gap-3 w-full md:w-auto overflow-x-auto pb-1 md:pb-0",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-indigo-50/50 rounded-xl border border-indigo-100 whitespace-nowrap",children:[e.jsx(cs,{className:"h-4 w-4 text-indigo-500"}),e.jsx("span",{className:"text-xs font-bold text-indigo-600",children:"Filter:"})]}),e.jsxs("select",{value:l,onChange:x=>y(x.target.value),className:"py-2.5 px-4 rounded-xl border border-slate-200 bg-white text-sm font-medium outline-none focus:ring-2 focus:ring-indigo-200 min-w-[120px]",children:[e.jsx("option",{value:"",children:"គ្រប់ក្រុម"}),L.map(x=>e.jsx("option",{value:x,children:x},x))]}),e.jsxs("select",{value:n,onChange:x=>o(x.target.value),className:"py-2.5 px-4 rounded-xl border border-slate-200 bg-white text-sm font-medium outline-none focus:ring-2 focus:ring-indigo-200 min-w-[120px]",children:[e.jsx("option",{value:"",children:"គ្រប់ថ្នាក់"}),h.map(x=>e.jsx("option",{value:x,children:x},x))]}),e.jsxs("select",{value:u,onChange:x=>r(x.target.value),className:"py-2.5 px-4 rounded-xl border border-slate-200 bg-white text-sm font-medium outline-none focus:ring-2 focus:ring-indigo-200 min-w-[120px]",children:[e.jsx("option",{value:"",children:"គ្រប់ឆ្នាំសិក្សា"}),$.map(x=>e.jsx("option",{value:x,children:x},x))]})]})]});function gs({db:s,employees:i,settings:n,addToast:o,setConfirmDialog:u}){const[r,l]=d.useState(new Set),[y,h]=d.useState(""),[$,L]=d.useState(""),[x,S]=d.useState(""),[z,M]=d.useState(""),[K,D]=d.useState(!1),[Y,B]=d.useState(!1),[w,j]=d.useState(null),[p,f]=d.useState("personal"),[N,I]=d.useState({group:"",section:"",position:"",academicYear:"",mon:"",tue:"",wed:"",thu:"",fri:"",sat:"",sun:""}),Z=d.useMemo(()=>{const c=i.map(a=>a.class).filter(a=>a&&a.trim()!=="");return[...new Set(c)].sort()},[i]),E=d.useMemo(()=>{const c=i.map(a=>a.academicYear).filter(a=>a&&a.trim()!=="");return[...new Set(c)].sort()},[i]),J=d.useMemo(()=>{const c=i.map(a=>a.group).filter(a=>a&&a.trim()!=="");return[...new Set(c)].sort()},[i]),g=d.useMemo(()=>i.filter(c=>{const a=y?c.class===y:!0,m=$?c.academicYear===$:!0,C=x?c.group===x:!0,k=/^\d+$/.test(c.studentId||""),F=z.toLowerCase().replace(/\s+/g,""),R=(c.name||"").toLowerCase().replace(/\s+/g,""),H=(c.latinName||"").toLowerCase().replace(/\s+/g,""),se=(c.studentId||"").toLowerCase().replace(/\s+/g,""),U=R.includes(F)||H.includes(F)||se.includes(F);return a&&m&&C&&k&&U}),[i,y,$,x,z]),re=c=>{if(c.target.checked){const a=new Set(g.map(m=>m.id));l(a)}else l(new Set)},Q=c=>{const a=new Set(r);a.has(c)?a.delete(c):a.add(c),l(a)},ee=(c,a)=>I(m=>({...m,[c]:a})),q=async()=>{B(!0),u(k=>({...k,isOpen:!1}));const c={},a={};N.group&&(a.ក្រុម=N.group),N.section&&(a.ផ្នែកការងារ=N.section),N.position&&(a.តួនាទី=N.position),N.academicYear&&(a.ឆ្នាំសិក្សា=N.academicYear);const m=["mon","tue","wed","thu","fri","sat","sun"],C=["ចន្ទ","អង្គារ៍","ពុធ","ព្រហស្បត្តិ៍","សុក្រ","សៅរ៍","អាទិត្យ"];r.forEach(k=>{Object.keys(a).forEach(F=>{c[`students/${k}/${F}`]=a[F]}),m.forEach((F,R)=>{N[F]&&(c[`students/${k}/កាលវិភាគ/${C[R]}`]=N[F])})});try{Object.keys(c).length>0?(await s.ref().update(c),o(`បានកែប្រែទិន្នន័យជោគជ័យសម្រាប់ ${r.size} នាក់`,"success"),l(new Set),I({group:"",section:"",position:"",academicYear:"",mon:"",tue:"",wed:"",thu:"",fri:"",sat:"",sun:""})):o("សូមជ្រើសរើសទិន្នន័យដែលត្រូវកែប្រែ","warning")}catch(k){console.error(k),o("បរាជ័យក្នុងការកែប្រែ","error")}finally{B(!1)}},P=()=>{if(r.size===0){o("សូមជ្រើសរើសបុគ្គលិកជាមុនសិន","warning");return}if(!Object.values(N).some(a=>a!=="")){o("សូមជ្រើសរើសព័ត៌មានដែលត្រូវកែប្រែ","warning");return}u({isOpen:!0,type:"warning",title:"បញ្ជាក់ការកែប្រែ",message:`តើអ្នកចង់កែប្រែទិន្នន័យសម្រាប់បុគ្គលិកចំនួន ${r.size} នាក់ដែលបានជ្រើសរើសមែនទេ?`,onConfirm:q})},V=(c,a,m,C="មិនកែប្រែ")=>e.jsxs("div",{className:"min-w-[140px]",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase mb-1 block",children:c}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:N[a],onChange:k=>ee(a,k.target.value),className:`w-full py-2 pl-2 pr-6 border rounded-xl outline-none text-xs font-bold appearance-none transition-all ${N[a]?"bg-indigo-50 border-indigo-300 text-indigo-700":"bg-white border-slate-200 text-slate-400"}`,children:[e.jsx("option",{value:"",children:C}),m&&m.map(k=>e.jsx("option",{value:k,children:k},k))]}),e.jsx("div",{className:"absolute inset-y-0 right-2 flex items-center pointer-events-none opacity-50",children:e.jsx(xs,{className:"h-3 w-3"})})]})]});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"h-full flex flex-col relative animate-fade-in",children:[e.jsxs("div",{className:"hidden md:flex glass-panel p-4 rounded-3xl flex-col xl:flex-row justify-between items-start xl:items-center gap-4 mb-4 shrink-0",children:[e.jsx("div",{className:"flex flex-col md:flex-row gap-4 w-full xl:w-auto",children:e.jsx(Ae,{searchTerm:z,setSearchTerm:M,filterClass:y,setFilterClass:h,filterYear:$,setFilterYear:L,filterGroup:x,setFilterGroup:S,uniqueClasses:Z,uniqueYears:E,uniqueGroups:J})}),e.jsxs("div",{className:"text-xs font-bold text-slate-500 bg-white px-3 py-1.5 rounded-lg border border-slate-200",children:["Total Found: ",e.jsx("span",{className:"text-indigo-600 text-sm",children:g.length})]})]}),e.jsxs("div",{className:"md:hidden flex justify-between items-center mb-4 px-2",children:[e.jsxs("h2",{className:"text-lg font-bold text-slate-700",children:["បុគ្គលិក (",g.length,")"]}),e.jsx("div",{className:"text-xs text-slate-500 italic",children:"Double tap for full detail"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar pb-32 px-1 md:px-0",children:[e.jsx("div",{className:"hidden md:block glass-panel rounded-3xl overflow-hidden bg-white/80",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-100",children:[e.jsx("thead",{className:"bg-slate-50/90 backdrop-blur sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left w-12",children:e.jsx("input",{type:"checkbox",onChange:re,checked:g.length>0&&r.size===g.length,className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 h-4 w-4 cursor-pointer"})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-extrabold text-slate-500 uppercase",children:"Profile"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-extrabold text-slate-500 uppercase",children:"ID / Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-extrabold text-slate-500 uppercase",children:"Current Info"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[g.map(c=>e.jsxs("tr",{className:`hover:bg-indigo-50/30 transition-colors ${r.has(c.id)?"bg-indigo-50/60":""}`,onClick:()=>Q(c.id),children:[e.jsx("td",{className:"px-4 py-3",onClick:a=>a.stopPropagation(),children:e.jsx("input",{type:"checkbox",checked:r.has(c.id),onChange:()=>Q(c.id),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 h-4 w-4 cursor-pointer"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"h-10 w-10 rounded-full overflow-hidden border border-slate-200",children:c.imageUrl?e.jsx("img",{src:c.imageUrl,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full bg-slate-100 flex items-center justify-center text-slate-400",children:e.jsx(we,{className:"h-5 w-5"})})})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-mono text-xs font-bold text-indigo-600 bg-indigo-50 px-1.5 py-0.5 rounded w-fit mb-1",children:c.studentId}),e.jsx("span",{className:"text-sm font-bold text-slate-700",children:c.name}),e.jsx("span",{className:"text-xs text-slate-400",children:c.latinName})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[e.jsx("span",{className:"bg-white border border-slate-200 px-2 py-1 rounded text-slate-600",children:c.class||"No Class"}),e.jsx("span",{className:"bg-white border border-slate-200 px-2 py-1 rounded text-slate-600",children:c.academicYear||"No Year"}),e.jsx("span",{className:"bg-white border border-slate-200 px-2 py-1 rounded text-slate-600",children:c.group||"No Group"})]})})]},c.id)),g.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-10 text-slate-400 italic",children:"No employees found"})})]})]})}),e.jsxs("div",{className:"md:hidden grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 px-1",children:[e.jsx("input",{type:"checkbox",id:"selectAllMobile",onChange:re,checked:g.length>0&&r.size===g.length,className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 h-4 w-4 cursor-pointer"}),e.jsx("label",{htmlFor:"selectAllMobile",className:"text-sm font-bold text-slate-600",children:"Select All"})]}),g.map(c=>e.jsxs("div",{onDoubleClick:()=>{j(c),f("personal")},onClick:()=>Q(c.id),className:`glass-panel p-4 rounded-2xl border transition-all active:scale-[0.98] relative overflow-hidden ${r.has(c.id)?"border-indigo-500 bg-indigo-50/50 ring-1 ring-indigo-500":"border-transparent bg-white"}`,children:[e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:`h-5 w-5 rounded-full border flex items-center justify-center transition-colors ${r.has(c.id)?"bg-indigo-600 border-indigo-600":"border-slate-300 bg-white"}`,children:r.has(c.id)&&e.jsx(Le,{className:"h-3.5 w-3.5 text-white"})})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-12 w-12 rounded-full overflow-hidden border border-slate-200 shrink-0",children:c.imageUrl?e.jsx("img",{src:c.imageUrl,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full bg-slate-100 flex items-center justify-center text-slate-400",children:e.jsx(we,{className:"h-6 w-6"})})}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:"font-mono text-[10px] font-bold text-indigo-600 bg-indigo-50 px-1.5 py-0.5 rounded w-fit mb-0.5",children:c.studentId}),e.jsx("span",{className:"text-sm font-bold text-slate-700 truncate",children:c.name}),e.jsx("span",{className:"text-xs text-slate-400 truncate",children:c.latinName})]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2 text-[10px]",children:[e.jsx("span",{className:"bg-slate-50 border border-slate-100 px-2 py-1 rounded-lg text-slate-600 font-medium",children:c.class||"No Class"}),e.jsx("span",{className:"bg-slate-50 border border-slate-100 px-2 py-1 rounded-lg text-slate-600 font-medium",children:c.academicYear||"No Year"}),e.jsx("span",{className:"bg-slate-50 border border-slate-100 px-2 py-1 rounded-lg text-slate-600 font-medium",children:c.group||"No Group"})]})]},c.id)),g.length===0&&e.jsx("div",{className:"text-center py-10 text-slate-400 italic col-span-full",children:"No employees found"})]})]}),e.jsxs("div",{className:`absolute bottom-0 left-0 right-0 glass-modal rounded-t-3xl border-t border-indigo-100 shadow-[0_-10px_40px_rgba(0,0,0,0.1)] transition-transform duration-300 transform z-20 ${r.size>0?"translate-y-0":"translate-y-full"}`,children:[e.jsxs("div",{className:"p-2 bg-gradient-to-r from-indigo-600 to-blue-600 text-white text-center text-xs font-bold tracking-wider rounded-t-3xl",children:["កែប្រែទិន្នន័យសម្រាប់ ",r.size," នាក់"]}),e.jsx("div",{className:"p-4 md:p-6 overflow-x-auto custom-scrollbar",children:e.jsxs("div",{className:"flex gap-6 min-w-max",children:[e.jsxs("div",{className:"flex gap-3 pr-6 border-r border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-indigo-600 font-bold text-xs whitespace-nowrap",children:[e.jsx(us,{className:"h-4 w-4"})," ការងារ:"]}),V("ក្រុម","group",n?.groups),V("ផ្នែក","section",n?.sections),V("តួនាទី","position",n?.positions),V("ឆ្នាំសិក្សា","academicYear",ds)]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-orange-500 font-bold text-xs whitespace-nowrap",children:[e.jsx($e,{className:"h-4 w-4"})," កាលវិភាគ:"]}),["mon","tue","wed","thu","fri","sat","sun"].map((c,a)=>e.jsxs("div",{className:"min-w-[80px]",children:[e.jsx("label",{className:"text-[9px] font-bold text-slate-400 uppercase mb-1 block text-center",children:["ចន្ទ","អង្គារ៍","ពុធ","ព្រហ","សុក្រ","សៅរ៍","អាទិត្យ"][a]}),e.jsxs("select",{value:N[c],onChange:m=>ee(c,m.target.value),className:`w-full py-1.5 px-1 border rounded-lg text-xs font-bold outline-none text-center ${N[c]?"bg-orange-50 border-orange-200 text-orange-700":"bg-white border-slate-200"}`,children:[e.jsx("option",{value:"",children:"-"}),n?.schedules?.map(m=>e.jsx("option",{value:m,children:m},m))]})]},c))]})]})}),e.jsx("div",{className:"p-4 border-t border-slate-100 bg-white/50 flex justify-end",children:e.jsxs("button",{onClick:P,disabled:Y,className:"px-8 py-2.5 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold shadow-lg shadow-indigo-200 flex items-center gap-2 disabled:opacity-50 transition-all active:scale-95",children:[Y?e.jsx(hs,{className:"h-4 w-4 animate-spin"}):e.jsx(Le,{className:"h-4 w-4"})," រក្សាទុកការកែប្រែ"]})})]})]}),e.jsx("button",{onClick:()=>D(!0),className:`md:hidden fixed z-[50] bottom-6 right-4 h-12 w-12 bg-indigo-600 text-white rounded-full shadow-lg shadow-indigo-300 flex items-center justify-center transition-transform active:scale-90 hover:scale-105 ${r.size>0?"translate-y-[-200px]":""}`,children:e.jsx(Be,{className:"h-6 w-6"})}),e.jsx("div",{className:`md:hidden fixed inset-0 z-[60] bg-black/40 backdrop-blur-md transition-opacity duration-300 ${K?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,onClick:()=>D(!1),children:e.jsxs("div",{className:`absolute bottom-0 left-0 right-0 bg-white rounded-t-3xl p-5 shadow-2xl transition-transform duration-300 ${K?"translate-y-0":"translate-y-full"}`,onClick:c=>c.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-bold text-slate-700 text-lg",children:"ស្វែងរក & Filter"}),e.jsx("button",{onClick:()=>D(!1),className:"p-2 bg-slate-100 rounded-full text-slate-500 hover:bg-slate-200",children:e.jsx(Me,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(Ae,{searchTerm:z,setSearchTerm:M,filterClass:y,setFilterClass:h,filterYear:$,setFilterYear:L,filterGroup:x,setFilterGroup:S,uniqueClasses:Z,uniqueYears:E,uniqueGroups:J}),e.jsxs("button",{onClick:()=>D(!1),className:"w-full py-3 bg-indigo-600 text-white rounded-xl font-bold mt-2 shadow-lg shadow-indigo-200",children:["បង្ហាញលទ្ធផល (",g.length,")"]})]})]})}),w&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-900/60 backdrop-blur-md p-4 animate-in fade-in zoom-in-95 duration-200",children:e.jsxs("div",{className:"bg-white w-full max-w-lg rounded-3xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh] relative transform transition-all scale-100",onClick:c=>c.stopPropagation(),children:[e.jsxs("div",{className:"relative h-32 bg-gradient-to-br from-indigo-600 to-purple-700 shrink-0",children:[e.jsx("button",{onClick:()=>j(null),className:"absolute top-4 right-4 z-10 p-2 bg-black/20 hover:bg-black/30 backdrop-blur-md rounded-full text-white transition-all",children:e.jsx(Me,{className:"h-5 w-5"})}),e.jsx("div",{className:"absolute -bottom-10 left-6",children:e.jsx("div",{className:"h-24 w-24 rounded-full border-[6px] border-white shadow-lg overflow-hidden bg-white",children:w.imageUrl?e.jsx("img",{src:w.imageUrl,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center text-slate-300",children:e.jsx(we,{className:"h-12 w-12"})})})})]}),e.jsx("div",{className:"pt-12 px-6 pb-4 shrink-0",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 leading-tight",children:w.name}),e.jsx("p",{className:"text-slate-500 font-medium",children:w.latinName})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsx("span",{className:"px-3 py-1 bg-indigo-50 text-indigo-700 rounded-full text-xs font-mono font-bold border border-indigo-100",children:w.studentId}),e.jsx("span",{className:`text-xs font-bold px-2 py-0.5 rounded-md ${w.gender==="ស្រី"?"bg-pink-50 text-pink-600":"bg-blue-50 text-blue-600"}`,children:w.gender})]})]})}),e.jsxs("div",{className:"flex px-6 border-b border-slate-100 shrink-0 gap-6 overflow-x-auto no-scrollbar",children:[e.jsxs("button",{onClick:()=>f("personal"),className:`pb-3 text-sm font-bold transition-all relative whitespace-nowrap ${p==="personal"?"text-indigo-600":"text-slate-400 hover:text-slate-600"}`,children:["Personal",p==="personal"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-indigo-600 rounded-t-full"})]}),e.jsxs("button",{onClick:()=>f("work"),className:`pb-3 text-sm font-bold transition-all relative whitespace-nowrap ${p==="work"?"text-indigo-600":"text-slate-400 hover:text-slate-600"}`,children:["Work & Study",p==="work"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-indigo-600 rounded-t-full"})]}),e.jsxs("button",{onClick:()=>f("schedule"),className:`pb-3 text-sm font-bold transition-all relative whitespace-nowrap ${p==="schedule"?"text-indigo-600":"text-slate-400 hover:text-slate-600"}`,children:["Schedule",p==="schedule"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-indigo-600 rounded-t-full"})]})]}),e.jsxs("div",{className:"overflow-y-auto custom-scrollbar p-6 flex-1 bg-slate-50/50",children:[p==="personal"&&e.jsx("div",{className:"space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300",children:e.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-slate-100 shadow-sm space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-50 text-blue-600 rounded-lg",children:e.jsx($e,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase",children:"Date of Birth"}),e.jsx("p",{className:"text-sm font-semibold text-slate-700",children:w.dob||"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-emerald-50 text-emerald-600 rounded-lg",children:e.jsx(ps,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase",children:"Place of Birth"}),e.jsx("p",{className:"text-sm font-semibold text-slate-700 leading-relaxed",children:w.pob||"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-sky-50 text-sky-600 rounded-lg",children:e.jsx(ms,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase",children:"Telegram"}),e.jsx("p",{className:"text-sm font-semibold text-blue-600 cursor-pointer hover:underline",children:w.telegram||"N/A"})]})]})]})}),p==="work"&&e.jsxs("div",{className:"grid grid-cols-2 gap-3 animate-in fade-in slide-in-from-bottom-2 duration-300",children:[e.jsxs("div",{className:"col-span-2 bg-indigo-600 p-4 rounded-2xl text-white shadow-lg shadow-indigo-200 mb-2",children:[e.jsx("p",{className:"text-indigo-200 text-xs font-bold uppercase mb-1",children:"Current Position"}),e.jsx("p",{className:"text-xl font-bold",children:w.position||"N/A"})]}),e.jsxs("div",{className:"bg-white p-3 rounded-2xl border border-slate-100 shadow-sm",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Section"}),e.jsx("p",{className:"text-sm font-bold text-slate-700",children:w.section||"-"})]}),e.jsxs("div",{className:"bg-white p-3 rounded-2xl border border-slate-100 shadow-sm",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Group"}),e.jsx("p",{className:"text-sm font-bold text-slate-700",children:w.group||"-"})]}),e.jsxs("div",{className:"bg-white p-3 rounded-2xl border border-slate-100 shadow-sm",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Class"}),e.jsx("p",{className:"text-sm font-bold text-slate-700",children:w.class||"-"})]}),e.jsxs("div",{className:"bg-white p-3 rounded-2xl border border-slate-100 shadow-sm",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Generation"}),e.jsx("p",{className:"text-sm font-bold text-slate-700",children:w.generation||"-"})]}),e.jsxs("div",{className:"col-span-2 bg-white p-3 rounded-2xl border border-slate-100 shadow-sm flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Academic Year"}),e.jsx("p",{className:"text-sm font-bold text-slate-700",children:w.academicYear||"-"})]}),e.jsx("div",{className:"px-3 py-1 bg-slate-100 rounded-lg text-xs font-bold text-slate-500",children:w.skill||"No Skill"})]})]}),p==="schedule"&&e.jsx("div",{className:"space-y-3 animate-in fade-in slide-in-from-bottom-2 duration-300",children:["mon","tue","wed","thu","fri","sat","sun"].map((c,a)=>{const m=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"][a],C=w[c],k=new Date().getDay()===(a+1)%7;return e.jsxs("div",{className:`flex items-center p-3 rounded-2xl border ${k?"bg-indigo-50 border-indigo-200 ring-1 ring-indigo-200":"bg-white border-slate-100 shadow-sm"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-xs font-bold mr-3 ${k?"bg-indigo-600 text-white":"bg-slate-100 text-slate-500"}`,children:m.substring(0,3)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`text-xs font-bold mb-0.5 ${k?"text-indigo-600":"text-slate-400"}`,children:m}),e.jsx("p",{className:`text-sm font-medium ${C?"text-slate-800":"text-slate-300 italic"}`,children:C||"No Schedule"})]})]},c)})})]})]})})]})}const bs=["2023-2024","2024-2025","2025-2026","2026-2027"],fs=["Gen 1","Gen 2","Gen 3","Gen 4","Gen 5","Gen 6"],js=s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("path",{d:"M18 6 6 18"}),e.jsx("path",{d:"m6 6 12 12"})]}),ws=s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"}),e.jsx("circle",{cx:"12",cy:"13",r:"3"})]}),vs=s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"17 8 12 3 7 8"}),e.jsx("line",{x1:"12",x2:"12",y1:"3",y2:"15"})]}),Ns=s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),ys=s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2"}),e.jsx("path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"})]}),ks=s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",x2:"16",y1:"2",y2:"6"}),e.jsx("line",{x1:"8",x2:"8",y1:"2",y2:"6"}),e.jsx("line",{x1:"3",x2:"21",y1:"10",y2:"10"})]}),Cs=s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:e.jsx("path",{d:"m6 9 6 6 6-6"})}),Ss=s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:e.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),Is=s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),Ls="dsruankj0",$s="staff_app";function Ms({isOpen:s,onClose:i,employee:n,db:o,addToast:u,settings:r}){const[l,y]=d.useState({name:"",latinName:"",gender:"ប្រុស",dob:"",pob:"",studentId:"",academicYear:"",generation:"",group:"",class:"",skill:"",section:"",position:"",telegram:"",imageUrl:"",mon:"",tue:"",wed:"",thu:"",fri:"",sat:"",sun:""}),[h,$]=d.useState(!1),[L,x]=d.useState(""),[S,z]=d.useState(null);d.useEffect(()=>{n?(y({...n}),x(n.imageUrl||""),z(null)):(x(""),z(null),y({name:"",latinName:"",gender:"ប្រុស",dob:"",pob:"",studentId:"",academicYear:"",generation:"",group:"",class:"",skill:"",section:"",position:"",telegram:"",imageUrl:"",mon:"",tue:"",wed:"",thu:"",fri:"",sat:"",sun:""}))},[n]);const M=j=>{const{name:p,value:f}=j.target;if(!(p==="name"&&/[^ \u1780-\u17FF]/.test(f))){if(p==="latinName"){if(/[^a-zA-Z\s]/.test(f))return;y(N=>({...N,[p]:f.toUpperCase()}));return}y(N=>({...N,[p]:f}))}},K=j=>{const p=j.target.files[0];if(!p)return;if(p.size>5*1024*1024){alert("រូបភាពធំពេក! សូមជ្រើសរើសរូបភាពក្រោម 5MB");return}z(p);const f=new FileReader;f.onloadend=()=>{x(f.result)},f.readAsDataURL(p)},D=async j=>{const p=new FormData;p.append("file",j),p.append("upload_preset",$s);const f=await fetch(`https://api.cloudinary.com/v1_1/${Ls}/image/upload`,{method:"POST",body:p});if(!f.ok)throw new Error("Cloudinary upload failed");return(await f.json()).secure_url},Y=async j=>{j.preventDefault(),$(!0);try{if(!l.studentId||l.studentId.trim()===""){alert("សូមបញ្ចូលអត្តលេខ (ID) ជាមុនសិន!"),$(!1);return}if(l.telegram&&!/^(https?:\/\/)?(t\.me\/|telegram\.me\/)?[a-zA-Z0-9_]{5,}$/.test(l.telegram)){alert("តេឡេក្រាមត្រូវតែជា Link (ឧ. t.me/username)!"),$(!1);return}let p=l.imageUrl;if(S)try{p=await D(S)}catch(N){console.error("Image upload failed:",N),alert("បរាជ័យក្នុងការ Upload រូបភាព។ សូមព្យាយាមម្តងទៀត។"),$(!1);return}const f={ឈ្មោះ:l.name,ឈ្មោះឡាតាំង:l.latinName,ភេទ:l.gender,ថ្ងៃខែឆ្នាំកំណើត:l.dob,ទីកន្លែងកំណើត:l.pob,អត្តលេខ:l.studentId,ឆ្នាំសិក្សា:l.academicYear,ជំនាន់:l.generation,ក្រុម:l.group,ថ្នាក់:l.class,ជំនាញ:l.skill,ផ្នែកការងារ:l.section,តួនាទី:l.position,តេឡេក្រាម:l.telegram,រូបថត:p,កាលវិភាគ:{ចន្ទ:l.mon,អង្គារ៍:l.tue,ពុធ:l.wed,ព្រហស្បត្តិ៍:l.thu,សុក្រ:l.fri,សៅរ៍:l.sat,អាទិត្យ:l.sun}};if(n?.id)await o.ref(`students/${n.id}`).update(f),u("កែប្រែព័ត៌មានជោគជ័យ");else{if((await o.ref(`students/${l.studentId}`).once("value")).exists()){alert(`អត្តលេខ ${l.studentId} មានរួចហើយ! សូមប្រើអត្តលេខផ្សេង។`),$(!1);return}await o.ref(`students/${l.studentId}`).set(f),u("បញ្ចូលទិន្នន័យថ្មីជោគជ័យ")}i()}catch(p){console.error(p),u("បរាជ័យក្នុងការរក្សាទុក: "+p.message,"error")}finally{$(!1)}},B=d.useMemo(()=>l.name?.trim().length>0&&l.studentId?.trim().length>0,[l.name,l.studentId]),w=(j,p,f,N=!1)=>e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase mb-1.5 block tracking-wide",children:[j," ",N&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:p,value:l[p],onChange:M,className:"w-full p-3 border border-slate-200 rounded-xl bg-slate-50/50 outline-none input-modern",children:[e.jsx("option",{value:"",children:"ជ្រើសរើស..."}),f&&f.map(I=>e.jsx("option",{value:I,children:I},I))]})]});return s?e.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"glass-modal rounded-3xl w-full max-w-5xl shadow-2xl overflow-hidden flex flex-col max-h-[95vh] border border-white animate-scale-in",children:[e.jsxs("div",{className:"px-8 py-5 border-b border-slate-100 flex justify-between items-center bg-white/50 shrink-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 tracking-tight",children:n?"កែប្រែព័ត៌មាន":"បញ្ចូលបុគ្គលិកថ្មី"}),e.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"សូមបំពេញព័ត៌មានឱ្យបានត្រឹមត្រូវ"})]}),e.jsx("button",{onClick:i,className:"p-2 rounded-full hover:bg-slate-200 transition-colors",children:e.jsx(js,{className:"h-6 w-6 text-slate-500"})})]}),e.jsxs("form",{onSubmit:Y,className:"p-8 overflow-y-auto grow custom-scrollbar bg-slate-50/30",children:[e.jsxs("div",{className:"flex gap-10 flex-col lg:flex-row mb-8",children:[e.jsxs("div",{className:"flex flex-col items-center gap-6 lg:w-1/4",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"h-48 w-48 rounded-3xl border-4 border-white overflow-hidden bg-white shadow-xl rotate-3 group-hover:rotate-0 transition-all duration-500",children:L?e.jsx("img",{src:L,className:"h-full w-full object-cover",alt:"Preview"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center text-slate-300",children:e.jsx(ws,{className:"h-16 w-16"})})}),e.jsxs("label",{className:"absolute -bottom-2 -right-2 bg-indigo-600 p-3.5 rounded-2xl text-white cursor-pointer shadow-lg hover:bg-indigo-700 hover:scale-110 transition-all ring-4 ring-white",children:[e.jsx(vs,{className:"h-5 w-5"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:K})]})]}),e.jsxs("div",{className:"w-full mt-4",children:[e.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 block text-center",children:["លេខសម្គាល់ (ID) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{name:"studentId",value:l.studentId,onChange:M,disabled:!!n,className:`w-full p-4 border-slate-200 rounded-2xl bg-white focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 transition-all text-center font-mono font-bold text-xl text-indigo-600 tracking-widest shadow-sm input-modern ${n?"opacity-70 cursor-not-allowed":""}`,placeholder:"ID..."}),!!n&&e.jsx("p",{className:"text-[10px] text-center text-slate-400 mt-1",children:"ID មិនអាចកែបានទេ (Edit)"})]})]}),e.jsxs("div",{className:"flex-1 space-y-8",children:[e.jsxs("div",{className:"bg-white/60 p-6 rounded-3xl border border-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6 pb-2 border-b border-slate-100",children:[e.jsx(Ns,{className:"h-5 w-5 text-indigo-500"}),e.jsx("h3",{className:"font-bold text-slate-800",children:"ព័ត៌មានផ្ទាល់ខ្លួន"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase mb-1.5 block",children:["ឈ្មោះ (ខ្មែរ) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{name:"name",value:l.name,onChange:M,required:!0,className:"w-full p-3 border border-slate-200 rounded-xl bg-slate-50/50 outline-none input-modern"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase mb-1.5 block",children:["ឈ្មោះ (ឡាតាំង) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{name:"latinName",value:l.latinName,onChange:M,className:"w-full p-3 border border-slate-200 rounded-xl bg-slate-50/50 outline-none input-modern"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase mb-1.5 block",children:"ភេទ"}),e.jsxs("select",{name:"gender",value:l.gender,onChange:M,className:"w-full p-3 border border-slate-200 rounded-xl bg-slate-50/50 outline-none input-modern",children:[e.jsx("option",{value:"ប្រុស",children:"ប្រុស"}),e.jsx("option",{value:"ស្រី",children:"ស្រី"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase mb-1.5 block",children:"ថ្ងៃកំណើត"}),e.jsx("input",{name:"dob",value:l.dob,onChange:M,placeholder:"DD/MM/YYYY",className:"w-full p-3 border border-slate-200 rounded-xl bg-slate-50/50 outline-none input-modern"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase mb-1.5 block",children:"ទីកន្លែងកំណើត"}),e.jsx("input",{name:"pob",value:l.pob,onChange:M,className:"w-full p-3 border border-slate-200 rounded-xl bg-slate-50/50 outline-none input-modern"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase mb-1.5 block",children:"តេឡេក្រាម Link"}),e.jsx("input",{name:"telegram",value:l.telegram,onChange:M,className:"w-full p-3 border border-slate-200 rounded-xl bg-slate-50/50 outline-none input-modern text-blue-600"})]})]})]}),e.jsxs("div",{className:"bg-white/60 p-6 rounded-3xl border border-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6 pb-2 border-b border-slate-100",children:[e.jsx(ys,{className:"h-5 w-5 text-purple-500"}),e.jsx("h3",{className:"font-bold text-slate-800",children:"ការសិក្សា & ការងារ"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5",children:[w("ជំនាញ","skill",r?.skills),w("ឆ្នាំសិក្សា","academicYear",bs),w("ជំនាន់","generation",fs),w("ក្រុម","group",r?.groups),w("ថ្នាក់","class",r?.classes,!0),w("ផ្នែក","section",r?.sections),e.jsx("div",{className:"md:col-span-2",children:w("តួនាទី","position",r?.positions)})]})]})]})]}),e.jsxs("div",{className:"bg-white/60 p-6 rounded-3xl border border-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6 pb-2 border-b border-slate-100",children:[e.jsx(ks,{className:"h-5 w-5 text-orange-500"}),e.jsx("h3",{className:"font-bold text-slate-800",children:"កាលវិភាគប្រចាំសប្តាហ៍"})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-7 gap-4",children:["mon","tue","wed","thu","fri","sat","sun"].map((j,p)=>e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("label",{className:"text-[11px] font-bold text-slate-500 uppercase tracking-wider text-center",children:["ចន្ទ","អង្គារ៍","ពុធ","ព្រហ","សុក្រ","សៅរ៍","អាទិត្យ"][p]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{name:j,value:l[j],onChange:M,className:"w-full py-3 pl-3 pr-8 border border-slate-200 rounded-xl bg-white text-xs font-bold text-slate-700 outline-none focus:ring-2 focus:ring-indigo-500/20 appearance-none cursor-pointer transition-all shadow-sm hover:border-indigo-300",children:[e.jsx("option",{value:"",children:"-"}),r?.schedules&&r.schedules.map(f=>e.jsx("option",{value:f,children:f},f))]}),e.jsx("div",{className:"absolute inset-y-0 right-2.5 flex items-center pointer-events-none text-slate-400",children:e.jsx(Cs,{className:"h-3.5 w-3.5"})})]})]},j))})]})]}),e.jsxs("div",{className:"px-8 py-5 bg-white border-t border-slate-100 flex justify-end gap-4 shrink-0",children:[e.jsx("button",{onClick:i,className:"px-8 py-3 rounded-xl text-slate-600 font-semibold hover:bg-slate-100 transition-colors",children:"បោះបង់"}),e.jsxs("button",{onClick:Y,disabled:h||!B,className:"px-10 py-3 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold shadow-lg shadow-indigo-200 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed transform hover:-translate-y-1 transition-all",children:[h?e.jsx(Ss,{className:"h-5 w-5 animate-spin"}):e.jsx(Is,{className:"h-5 w-5"})," ",n?"កែប្រែ":"រក្សាទុក"]})]})]})}):null}const As=["ឆ្នាំទី១","ឆ្នាំទី២","ឆ្នាំទី៣","ឆ្នាំទី៤"],Es=Array.from({length:14},(s,i)=>`ទី${i+1}`),Os=["ប្រុស","ស្រី"],O=s=>s==null||typeof s=="object"?"":String(s),zs=s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:e.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),Ne=s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("path",{d:"M12 19V5"}),e.jsx("path",{d:"M5 12l7-7 7 7"})]}),ye=s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("path",{d:"M12 5v14"}),e.jsx("path",{d:"M19 12l-7 7-7-7"})]}),ie=s=>s?String(s).toLowerCase().replace(/\s+/g,""):"",Ds=()=>{const[s,i]=d.useState([]),n=(u,r="success")=>{const l=Date.now();i(y=>[...y,{id:l,message:u,type:r}]),setTimeout(()=>o(l),3e3)},o=u=>i(r=>r.filter(l=>l.id!==u));return{toasts:s,addToast:n,removeToast:o}},Ps=({onLogin:s,loading:i,error:n})=>{const[o,u]=d.useState("admin@dilistname.com"),[r,l]=d.useState(""),y=h=>{h.preventDefault(),s(o,r)};return e.jsxs("div",{className:"min-h-screen w-full flex items-center justify-center bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 relative overflow-hidden font-sans",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[500px] h-[500px] bg-indigo-500/20 rounded-full blur-[120px] animate-pulse"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[500px] h-[500px] bg-blue-500/20 rounded-full blur-[120px] animate-pulse delay-1000"}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-2xl border border-white/10 p-10 rounded-[40px] shadow-2xl w-full max-w-md m-4 animate-fade-in z-10 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-blue-500 to-indigo-500"}),e.jsxs("div",{className:"flex flex-col items-center mb-10",children:[e.jsx("div",{className:"h-20 w-20 bg-gradient-to-tr from-blue-500 to-indigo-600 rounded-3xl flex items-center justify-center shadow-lg shadow-indigo-500/30 mb-6 transform rotate-6 border border-white/20",children:e.jsx(Oe,{className:"h-10 w-10 text-white"})}),e.jsx("h1",{className:"text-4xl font-extrabold text-white tracking-tight mb-2",children:"HR PRO"}),e.jsx("p",{className:"text-slate-400 text-sm font-medium",children:"Please sign in to continue"})]}),e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider ml-2",children:"Email Address"}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(pe,{className:"h-5 w-5 text-slate-500 group-focus-within:text-blue-400 transition-colors"})}),e.jsx("input",{type:"email",value:o,onChange:h=>u(h.target.value),className:"block w-full pl-12 pr-4 py-4 bg-slate-900/60 border border-slate-700/50 rounded-2xl text-white placeholder-slate-600 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50 transition-all font-medium",placeholder:"admin@dilistname.com",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider ml-2",children:"Password"}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsxs("svg",{className:"h-5 w-5 text-slate-500 group-focus-within:text-blue-400 transition-colors",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),e.jsx("input",{type:"password",value:r,onChange:h=>l(h.target.value),className:"block w-full pl-12 pr-4 py-4 bg-slate-900/60 border border-slate-700/50 rounded-2xl text-white placeholder-slate-600 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50 transition-all font-medium",placeholder:"••••••••••••",required:!0})]})]}),n&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-2xl p-4 flex items-center gap-3 text-red-200 text-sm animate-pulse",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-red-500 shrink-0"}),n]}),e.jsx("button",{type:"submit",disabled:i,className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white font-bold py-4 rounded-2xl shadow-xl shadow-indigo-600/20 active:scale-[0.98] transition-all disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-3 mt-4",children:i?e.jsx("div",{className:"h-5 w-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:["Sign In ",e.jsx(Fe,{className:"h-5 w-5"})]})})]}),e.jsx("div",{className:"mt-10 text-center",children:e.jsx("p",{className:"text-slate-500 text-xs font-medium",children:"Secured by Google Firebase"})})]})]})},Fs=({isOpen:s,onClose:i,sortData:n,onConfirmSort:o})=>!s||!n?null:e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm transition-opacity",onClick:i}),e.jsx("div",{className:"relative bg-white rounded-3xl shadow-2xl w-full max-w-sm overflow-hidden transform transition-all scale-100 animate-fade-in border border-white/20",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Sort By"}),e.jsx("p",{className:"text-sm text-indigo-500 font-medium",children:n.label})]}),e.jsx("button",{onClick:i,className:"p-2 bg-slate-100 hover:bg-slate-200 rounded-full text-slate-500 transition-colors",children:e.jsx(me,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>o(n.key,"asc"),className:`w-full flex items-center justify-between p-4 rounded-2xl border transition-all ${n.currentDirection==="asc"&&n.currentKey===n.key?"bg-indigo-50 border-indigo-500 ring-1 ring-indigo-500 text-indigo-700":"bg-white border-slate-200 hover:border-indigo-300 hover:bg-slate-50 text-slate-700"}`,children:[e.jsxs("span",{className:"font-bold flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg text-indigo-600",children:e.jsx(Ne,{className:"h-4 w-4"})}),"Ascending (A-Z / 0-9)"]}),n.currentDirection==="asc"&&n.currentKey===n.key&&e.jsx(Ie,{className:"h-5 w-5 text-indigo-600"})]}),e.jsxs("button",{onClick:()=>o(n.key,"desc"),className:`w-full flex items-center justify-between p-4 rounded-2xl border transition-all ${n.currentDirection==="desc"&&n.currentKey===n.key?"bg-indigo-50 border-indigo-500 ring-1 ring-indigo-500 text-indigo-700":"bg-white border-slate-200 hover:border-indigo-300 hover:bg-slate-50 text-slate-700"}`,children:[e.jsxs("span",{className:"font-bold flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg text-indigo-600",children:e.jsx(ye,{className:"h-4 w-4"})}),"Descending (Z-A / 9-0)"]}),n.currentDirection==="desc"&&n.currentKey===n.key&&e.jsx(Ie,{className:"h-5 w-5 text-indigo-600"})]}),e.jsx("div",{className:"border-t border-slate-100 my-4"}),e.jsxs("button",{onClick:()=>o(n.key,null,!0),className:"w-full flex items-center justify-center gap-2 p-4 rounded-2xl bg-slate-50 text-slate-500 font-bold hover:bg-red-50 hover:text-red-500 transition-colors",children:[e.jsx(ge,{className:"h-4 w-4"}),"Reset / Clear Sort"]})]})]})})]}),T=({label:s,sortKey:i,currentSort:n,onOpenSort:o,className:u=""})=>e.jsx("th",{className:`px-4 py-4 text-left text-xs font-extrabold text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-100 transition-colors group select-none ${u}`,onClick:()=>o(i,s),children:e.jsx("div",{className:"flex items-center gap-1.5 justify-between",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[s,e.jsx("span",{className:"text-slate-400 flex flex-col",children:n.key===i?n.direction==="asc"?e.jsx(Ne,{className:"h-3 w-3 text-indigo-600"}):e.jsx(ye,{className:"h-3 w-3 text-indigo-600"}):e.jsxs("div",{className:"opacity-0 group-hover:opacity-50 transition-opacity",children:[e.jsx(Ne,{className:"h-2 w-2 mb-[-2px]"}),e.jsx(ye,{className:"h-2 w-2"})]})})]})})}),Rs=d.memo(({employee:s,onEdit:i,onDelete:n,index:o,isSelected:u,onToggleSelect:r})=>e.jsxs("div",{className:`group relative bg-white/70 backdrop-blur-md rounded-3xl border shadow-sm hover:shadow-xl hover:-translate-y-2 transition-all duration-300 overflow-hidden flex flex-col animate-fade-in ${u?"ring-2 ring-indigo-500 border-indigo-500 bg-indigo-50/50":"border-white/60"}`,style:{animationDelay:`${o*50}ms`},onDoubleClick:i,children:[e.jsx("div",{className:"absolute top-3 left-3 z-20",children:e.jsx("input",{type:"checkbox",checked:u||!1,onChange:l=>{l.stopPropagation(),r(s.id)},className:"h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 cursor-pointer accent-indigo-600"})}),e.jsxs("div",{className:"p-6 flex flex-col items-center text-center relative",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-24 bg-gradient-to-br from-indigo-50 to-blue-50 z-0"}),e.jsxs("div",{className:"absolute top-3 right-3 flex gap-2 opacity-0 group-hover:opacity-100 transition-all duration-300 z-10 translate-x-2 group-hover:translate-x-0",children:[e.jsx("button",{onClick:l=>{l.stopPropagation(),i()},className:"text-indigo-600 bg-white hover:bg-indigo-50 p-2 rounded-xl shadow-sm transition-colors border border-indigo-100",children:e.jsx(De,{className:"h-4 w-4"})}),e.jsx("button",{onClick:l=>{l.stopPropagation(),n()},className:"text-rose-500 bg-white hover:bg-rose-50 p-2 rounded-xl shadow-sm transition-colors border border-rose-100",children:e.jsx(ne,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"relative z-10 mt-4",children:[e.jsx("div",{className:"h-28 w-28 rounded-full border-4 border-white shadow-lg overflow-hidden mb-4 bg-white relative group-hover:ring-4 group-hover:ring-indigo-100 transition-all",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,alt:s.name,className:"h-full w-full object-cover transform group-hover:scale-110 transition-transform duration-700"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center text-slate-300",children:e.jsx(pe,{className:"h-12 w-12"})})}),e.jsx("div",{className:"absolute bottom-5 right-1 h-5 w-5 bg-emerald-500 border-4 border-white rounded-full"})]}),e.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-0.5",children:s.name}),e.jsx("p",{className:"text-slate-500 text-sm font-medium",children:s.latinName}),e.jsxs("div",{className:"mt-4 flex flex-wrap justify-center gap-2",children:[e.jsx("span",{className:"px-3 py-1 bg-blue-100/50 text-blue-600 rounded-lg text-xs font-bold",children:s.skill||"No Skill"}),e.jsx("span",{className:"px-3 py-1 bg-purple-100/50 text-purple-600 rounded-lg text-xs font-bold",children:s.group||"No Group"})]})]}),e.jsx("div",{className:"px-6 py-4 bg-slate-50/50 border-t border-slate-100 mt-auto backdrop-blur-sm",children:e.jsxs("div",{className:"grid grid-cols-2 gap-y-3 text-sm",children:[e.jsxs("div",{className:"text-slate-500 flex flex-col",children:[e.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-400",children:"ID"}),e.jsx("span",{className:"font-semibold text-slate-700",children:s.studentId})]}),e.jsxs("div",{className:"text-slate-500 flex flex-col text-right",children:[e.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Gender"}),e.jsx("span",{className:`font-semibold ${s.gender==="ស្រី"?"text-pink-500":"text-indigo-500"}`,children:s.gender})]}),e.jsxs("div",{className:"col-span-2 flex items-center gap-2 text-slate-500 truncate pt-2 border-t border-slate-200/50",children:[e.jsx("div",{className:"p-1.5 bg-blue-100 rounded-full text-blue-600",children:e.jsx(Xe,{className:"h-3 w-3"})}),e.jsx("span",{className:"truncate text-xs font-medium text-blue-600 hover:underline cursor-pointer",children:s.telegram||"No Telegram"})]})]})})]})),Bs=d.memo(({employee:s,onEdit:i,onDelete:n,onInlineUpdate:o,index:u,settings:r,isSelected:l,onToggleSelect:y})=>e.jsxs("tr",{className:`group transition-colors animate-fade-in border-b border-slate-100 last:border-0 ${l?"bg-indigo-50":"hover:bg-indigo-50/30"}`,onDoubleClick:i,children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap sticky left-0 bg-white/90 backdrop-blur-sm z-20 border-r border-slate-100",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:l||!1,onChange:h=>y(s.id),className:"h-4 w-4 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500 cursor-pointer accent-indigo-600"}),e.jsxs("div",{className:"flex items-center gap-1 opacity-40 group-hover:opacity-100 transition-all transform translate-x-[-10px] group-hover:translate-x-0",children:[e.jsx("button",{onClick:h=>{h.stopPropagation(),i()},className:"text-indigo-600 hover:bg-indigo-100 p-2 rounded-lg transition-colors",children:e.jsx(De,{className:"h-4 w-4"})}),e.jsx("button",{onClick:h=>{h.stopPropagation(),n()},className:"text-rose-500 hover:bg-rose-100 p-2 rounded-lg transition-colors",children:e.jsx(ne,{className:"h-4 w-4"})})]})]})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap sticky left-[88px] bg-white/90 backdrop-blur-sm z-20 border-r border-slate-100 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.05)]",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full overflow-hidden shadow-sm ring-2 ring-white",children:s.imageUrl?e.jsx("img",{className:"h-full w-full object-cover",src:s.imageUrl,alt:""}):e.jsx("div",{className:"h-full w-full bg-slate-100 flex items-center justify-center text-slate-400",children:e.jsx(pe,{className:"h-5 w-5"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("div",{className:"font-bold text-slate-800 text-sm",children:e.jsx(_,{value:s.name,onSave:h=>o(s.id,"ឈ្មោះ",h)})})})]})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600 font-medium",children:e.jsx(_,{value:s.latinName,onSave:h=>o(s.id,"ឈ្មោះឡាតាំង",h)})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:e.jsx(_,{value:s.gender,onSave:h=>o(s.id,"ភេទ",h),options:Os,className:`font-semibold ${s.gender==="ស្រី"?"text-pink-500":"text-indigo-500"}`})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600 font-mono",children:e.jsx("div",{className:"bg-slate-100 px-2 py-1 rounded text-center text-xs font-bold text-slate-700",children:e.jsx(_,{value:s.studentId,onSave:h=>o(s.id,"អត្តលេខ",h)})})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600",children:e.jsx(_,{value:s.skill,onSave:h=>o(s.id,"ជំនាញ",h),options:r?.skills})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600 font-semibold text-slate-700",children:e.jsx(_,{value:s.group,onSave:h=>o(s.id,"ក្រុម",h),options:r?.groups})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600 text-[10px] text-slate-400",children:e.jsx(_,{value:s.class,onSave:h=>o(s.id,"ថ្នាក់",h),options:r?.classes})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600",children:e.jsx(_,{value:s.section,onSave:h=>o(s.id,"ផ្នែកការងារ",h),options:r?.sections})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600",children:e.jsx("div",{className:"px-2 py-1 bg-indigo-50 text-indigo-600 rounded border border-indigo-100 text-xs font-medium text-center",children:e.jsx(_,{value:s.position,onSave:h=>o(s.id,"តួនាទី",h),options:r?.positions})})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:e.jsx(_,{value:s.academicYear,onSave:h=>o(s.id,"ឆ្នាំសិក្សា",h),options:As})}),e.jsxs("span",{className:"text-[10px] text-slate-400 flex items-center gap-1",children:["Gen: ",e.jsx(_,{value:s.generation,onSave:h=>o(s.id,"ជំនាន់",h),options:Es})]})]})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600",children:e.jsx(_,{value:s.dob,onSave:h=>o(s.id,"ថ្ងៃខែឆ្នាំកំណើត",h)})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600 max-w-xs truncate",title:s.pob,children:e.jsx(_,{value:s.pob,onSave:h=>o(s.id,"ទីកន្លែងកំណើត",h)})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-blue-500 cursor-pointer font-medium hover:underline",children:e.jsx(_,{value:s.telegram,onSave:h=>o(s.id,"តេឡេក្រាម",h)})}),["mon","tue","wed","thu","fri","sat","sun"].map((h,$)=>{const L=["ចន្ទ","អង្គារ៍","ពុធ","ព្រហស្បត្តិ៍","សុក្រ","សៅរ៍","អាទិត្យ"][$];return e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center border-l border-slate-100 text-sm font-medium text-slate-700 bg-slate-50/30",children:e.jsx(_,{value:s[h],onSave:x=>o(s.id,`កាលវិភាគ/${L}`,x),options:r?.schedules})},h)})]}),(s,i)=>s.employee===i.employee&&s.index===i.index&&s.settings===i.settings&&s.isSelected===i.isSelected),_s=d.memo(({employee:s,onRestore:i,onPermanentDelete:n,index:o})=>e.jsxs("tr",{className:"group hover:bg-red-50/50 transition-colors animate-fade-in border-b border-slate-100",children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap sticky left-0 bg-white/90 backdrop-blur-sm group-hover:bg-red-50/30 z-20 border-r border-slate-100",children:e.jsxs("div",{className:"flex items-center gap-2 opacity-60 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>i(s),className:"text-emerald-600 hover:bg-emerald-100 p-2 rounded-lg transition-colors",title:"ស្តារវិញ",children:e.jsx(ge,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>n(s.id),className:"text-red-600 hover:bg-red-100 p-2 rounded-lg transition-colors",title:"លុបជារៀងរហូត",children:e.jsx(ne,{className:"h-4 w-4"})})]})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 border-2 border-slate-100 rounded-full overflow-hidden opacity-70 grayscale",children:s.imageUrl?e.jsx("img",{className:"h-full w-full object-cover",src:s.imageUrl,alt:""}):e.jsx("div",{className:"h-full w-full bg-slate-100 flex items-center justify-center text-slate-400",children:e.jsx(pe,{className:"h-5 w-5"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("div",{className:"font-bold text-slate-700 text-sm",children:s.name})})]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-500",children:s.latinName}),e.jsx("td",{className:"px-4 py-3 text-sm font-mono bg-slate-50 rounded text-center",children:s.studentId}),e.jsx("td",{className:"px-4 py-3 text-sm text-red-400 italic",children:"Deleted just now"})]})),Ee=({employees:s,loading:i,settings:n,isRecycleBin:o=!1,isModalOpen:u,onEdit:r,onDelete:l,onRestore:y,onPermanentDelete:h,onInlineUpdate:$,onCreate:L,onBulkDelete:x})=>{const[S,z]=d.useState(window.innerWidth<768?"grid":"list"),[M,K]=d.useState(""),[D,Y]=d.useState(!1),[B,w]=d.useState(1),[j,p]=d.useState(new Set),[f,N]=d.useState(""),[I,Z]=d.useState(""),[E,J]=d.useState(""),[g,re]=d.useState({key:null,direction:"asc"}),[Q,ee]=d.useState(null),q=50;d.useEffect(()=>{const t=()=>{window.innerWidth<768&&z("grid")};return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),d.useEffect(()=>{p(new Set)},[o]);const P=d.useRef(null),V=d.useRef(!1),c=d.useRef(0),a=d.useRef(0),m=t=>{V.current=!0,P.current&&(c.current=t.pageX-P.current.offsetLeft,a.current=P.current.scrollLeft,P.current.classList.add("cursor-grabbing"))},C=()=>{V.current=!1,P.current&&P.current.classList.remove("cursor-grabbing")},k=()=>{V.current=!1,P.current&&P.current.classList.remove("cursor-grabbing")},F=t=>{if(V.current&&(t.preventDefault(),P.current)){const G=(t.pageX-P.current.offsetLeft-c.current)*2;P.current.scrollLeft=a.current-G}},R=d.useMemo(()=>{const t=s.map(v=>v.group).filter(v=>v&&v.trim()!=="");return[...new Set(t)].sort()},[s]),H=d.useMemo(()=>{const t=s.map(v=>v.class).filter(v=>v&&v.trim()!=="");return[...new Set(t)].sort()},[s]),se=d.useMemo(()=>{const t=s.map(v=>v.academicYear).filter(v=>v&&v.trim()!=="");return[...new Set(t)].sort()},[s]),U=d.useMemo(()=>s.filter(t=>{const v=!M||ie(t.name).includes(ie(M))||ie(t.latinName).includes(ie(M))||ie(t.studentId).includes(ie(M)),G=!f||t.group===f,le=!I||t.class===I,ae=!E||t.academicYear===E;return v&&G&&le&&ae}),[s,M,f,I,E]),te=d.useMemo(()=>{let t=[...U];return g.key!==null&&t.sort((v,G)=>{const le=v[g.key]?String(v[g.key]):"",ae=G[g.key]?String(G[g.key]):"";return g.key==="studentId"?g.direction==="asc"?le.localeCompare(ae,void 0,{numeric:!0,sensitivity:"base"}):ae.localeCompare(le,void 0,{numeric:!0,sensitivity:"base"}):g.key==="name"?g.direction==="asc"?le.localeCompare(ae,"km"):ae.localeCompare(le,"km"):g.direction==="asc"?le.localeCompare(ae,"en",{sensitivity:"base"}):ae.localeCompare(le,"en",{sensitivity:"base"})}),t},[U,g]),b=(t,v)=>{ee({key:t,label:v,currentKey:g.key,currentDirection:g.direction})},X=(t,v,G=!1)=>{re(G?{key:null,direction:"asc"}:{key:t,direction:v}),ee(null)};d.useEffect(()=>w(1),[M,f,I,E]);const ke=t=>{p(v=>{const G=new Set(v);return G.has(t)?G.delete(t):G.add(t),G})},be=()=>{j.size===U.length&&U.length>0?p(new Set):p(new Set(U.map(t=>t.id)))},Ce=te.slice((B-1)*q,B*q),ce=Math.ceil(te.length/q),Se=({className:t})=>e.jsxs("div",{className:t,children:[e.jsxs("div",{className:"text-xs font-medium text-slate-500 mb-2 md:mb-0",children:["Showing ",te.length>0?(B-1)*q+1:0," to ",Math.min(B*q,te.length)," of ",te.length]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>w(v=>Math.max(v-1,1)),disabled:B===1,className:"p-2 rounded-lg bg-white border border-slate-200 hover:bg-slate-50 disabled:opacity-50 text-slate-600 shadow-sm transition-all active:scale-95",children:e.jsx(Qe,{className:"h-4 w-4"})}),e.jsxs("div",{className:"px-4 py-1.5 bg-white border border-slate-200 rounded-lg text-sm font-bold text-slate-700 shadow-sm min-w-[80px] text-center flex items-center justify-center",children:[B," / ",Math.max(ce,1)]}),e.jsx("button",{onClick:()=>w(v=>Math.min(v+1,ce)),disabled:B===ce||ce===0,className:"p-2 rounded-lg bg-white border border-slate-200 hover:bg-slate-50 disabled:opacity-50 text-slate-600 shadow-sm transition-all active:scale-95",children:e.jsx(Fe,{className:"h-4 w-4"})})]})]});return e.jsxs(e.Fragment,{children:[e.jsx(Fs,{isOpen:!!Q,sortData:Q,onClose:()=>ee(null),onConfirmSort:X}),!o&&!u&&e.jsxs("div",{className:"md:hidden fixed bottom-6 right-6 flex flex-col gap-4 z-[90]",children:[j.size>0&&e.jsxs("button",{onClick:()=>{x(Array.from(j)),p(new Set)},className:"h-14 w-14 bg-red-600 text-white rounded-full flex items-center justify-center active:scale-95 transition-transform shadow-red-500/40 shadow-xl",children:[e.jsx("span",{className:"absolute -top-1 -right-1 bg-white text-red-600 text-[10px] font-bold h-5 w-5 rounded-full flex items-center justify-center border border-red-100",children:j.size}),e.jsx(ne,{className:"h-6 w-6"})]}),e.jsx("button",{onClick:be,className:`h-14 w-14 rounded-full shadow-2xl flex items-center justify-center transition-all duration-300 ${j.size>0&&j.size===U.length?"bg-indigo-600 text-white":"bg-white text-indigo-600 border border-indigo-100"}`,style:{boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.3)"},children:e.jsx(ve,{className:"h-6 w-6"})}),e.jsx("button",{onClick:()=>Y(!D),className:`h-14 w-14 rounded-full shadow-2xl flex items-center justify-center transition-all duration-300 ${D?"bg-slate-700 text-white rotate-90":"bg-white text-indigo-600 border border-indigo-100"}`,style:{boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.3)"},children:D?e.jsx(fe,{className:"h-6 w-6 rotate-45"}):e.jsx(he,{className:"h-6 w-6"})}),e.jsx("button",{onClick:L,className:"h-14 w-14 bg-indigo-600 text-white rounded-full flex items-center justify-center active:scale-95 transition-transform",style:{boxShadow:"0 10px 25px -5px rgba(79, 70, 229, 0.5)"},children:e.jsx(fe,{className:"h-7 w-7"})})]}),e.jsx("div",{className:`md:hidden fixed inset-0 z-[60] bg-black/40 backdrop-blur-md transition-opacity duration-300 ${D?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,onClick:()=>Y(!1),children:e.jsxs("div",{className:`absolute bottom-0 left-0 right-0 bg-white rounded-t-3xl p-5 shadow-2xl transition-transform duration-300 ${D?"translate-y-0":"translate-y-full"}`,onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-bold text-slate-700 text-lg",children:"Search & Filter"}),e.jsx("button",{onClick:()=>Y(!1),className:"p-2 bg-slate-100 rounded-full text-slate-500 hover:bg-slate-200",children:e.jsx(me,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"relative w-full group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(he,{className:"h-4 w-4 text-slate-400 group-focus-within:text-indigo-500 transition-colors"})}),e.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-3 border border-slate-200 rounded-xl bg-white text-sm font-medium outline-none focus:ring-2 focus:ring-indigo-200",placeholder:"Search name, ID...",value:M,onChange:t=>K(t.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("select",{value:f,onChange:t=>N(t.target.value),className:"w-full py-3 px-3 border border-slate-200 rounded-xl bg-slate-50 text-sm font-bold outline-none",children:[e.jsx("option",{value:"",children:"All Groups"}),R.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{value:I,onChange:t=>Z(t.target.value),className:"w-full py-3 px-3 border border-slate-200 rounded-xl bg-slate-50 text-sm font-bold outline-none",children:[e.jsx("option",{value:"",children:"All Classes"}),H.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{value:E,onChange:t=>J(t.target.value),className:"w-full py-3 px-3 border border-slate-200 rounded-xl bg-slate-50 text-sm font-bold outline-none col-span-2",children:[e.jsx("option",{value:"",children:"All Academic Years"}),se.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("button",{onClick:()=>Y(!1),className:"w-full py-3 bg-indigo-600 text-white rounded-xl font-bold mt-2 shadow-lg shadow-indigo-200",children:["Show Results (",U.length,")"]})]})]})}),e.jsxs("div",{className:"space-y-6 animate-fade-in relative min-h-[500px]",children:[e.jsxs("div",{className:`glass-panel p-4 rounded-3xl flex flex-col md:flex-row justify-between items-center gap-4 sticky top-0 z-20 transition-all duration-300 ${D?"flex":"hidden md:flex"}`,children:[e.jsxs("div",{className:`flex flex-1 gap-3 items-center w-full transition-all duration-300 ${D?"block":"hidden md:flex"}`,children:[e.jsxs("div",{className:"relative w-full md:w-64 group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(he,{className:"h-5 w-5 text-slate-400 group-focus-within:text-indigo-500 transition-colors"})}),e.jsx("input",{type:"text",className:"block w-full pl-12 pr-4 py-2.5 border-none rounded-2xl bg-white/50 focus:bg-white ring-1 ring-slate-200 focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all placeholder:text-slate-400 font-medium text-sm",placeholder:"Search...",value:M,onChange:t=>K(t.target.value)})]}),e.jsxs("div",{className:"hidden xl:flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-indigo-50/50 rounded-xl border border-indigo-100 whitespace-nowrap",children:[e.jsx(zs,{className:"h-4 w-4 text-indigo-500"}),e.jsx("span",{className:"text-xs font-bold text-indigo-600",children:"Filter:"})]}),e.jsxs("select",{value:f,onChange:t=>N(t.target.value),className:"py-2 px-3 rounded-xl border border-slate-200 bg-white text-xs font-bold outline-none focus:ring-2 focus:ring-indigo-200 min-w-[100px] hover:border-indigo-300 transition-colors cursor-pointer",children:[e.jsx("option",{value:"",children:"Group"}),R.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{value:I,onChange:t=>Z(t.target.value),className:"py-2 px-3 rounded-xl border border-slate-200 bg-white text-xs font-bold outline-none focus:ring-2 focus:ring-indigo-200 min-w-[100px] hover:border-indigo-300 transition-colors cursor-pointer",children:[e.jsx("option",{value:"",children:"Class"}),H.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{value:E,onChange:t=>J(t.target.value),className:"py-2 px-3 rounded-xl border border-slate-200 bg-white text-xs font-bold outline-none focus:ring-2 focus:ring-indigo-200 min-w-[120px] hover:border-indigo-300 transition-colors cursor-pointer",children:[e.jsx("option",{value:"",children:"Year"}),se.map(t=>e.jsx("option",{value:t,children:t},t))]}),(f||I||E)&&e.jsx("button",{onClick:()=>{N(""),Z(""),J("")},className:"p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"Reset Filters",children:e.jsx(ge,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"flex items-center justify-between w-full md:w-auto gap-3",children:!o&&e.jsxs(e.Fragment,{children:[j.size>0?e.jsxs("div",{className:"hidden md:flex items-center gap-3 bg-indigo-50 border border-indigo-100 px-4 py-2 rounded-2xl animate-fade-in",children:[e.jsxs("span",{className:"text-sm font-bold text-indigo-700",children:[j.size," Selected"]}),e.jsxs("button",{onClick:()=>{x(Array.from(j)),p(new Set)},className:"flex items-center gap-2 bg-white text-red-600 px-3 py-1.5 rounded-xl text-sm font-bold border border-red-100 hover:bg-red-50 transition-colors",children:[e.jsx(ne,{className:"h-4 w-4"})," Delete"]}),e.jsx("button",{onClick:()=>p(new Set),className:"text-slate-400 hover:text-slate-600",children:e.jsx(me,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"hidden md:flex bg-white/50 p-1.5 rounded-xl items-center ring-1 ring-slate-200",children:[e.jsx("button",{onClick:()=>z("grid"),className:`p-2.5 rounded-lg transition-all ${S==="grid"?"bg-white text-indigo-600 shadow-md":"text-slate-400 hover:text-slate-600"}`,children:e.jsx(ze,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>z("list"),className:`p-2.5 rounded-lg transition-all ${S==="list"?"bg-white text-indigo-600 shadow-md":"text-slate-400 hover:text-slate-600"}`,children:e.jsx(He,{className:"h-5 w-5"})})]}),S==="grid"&&e.jsx("button",{onClick:be,className:"hidden md:flex items-center justify-center p-3 bg-white border border-slate-200 rounded-2xl text-slate-500 hover:bg-slate-50 transition-all",title:"Select All",children:e.jsx(ve,{className:`h-5 w-5 ${j.size>0&&j.size===U.length?"text-indigo-600":""}`})}),e.jsxs("button",{onClick:L,className:"hidden md:flex flex-1 md:flex-none items-center justify-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-2xl font-bold shadow-lg shadow-indigo-200 hover:-translate-y-1 transition-all",children:[e.jsx(fe,{className:"h-5 w-5"}),e.jsx("span",{className:"hidden sm:inline",children:"បង្កើតថ្មី"}),e.jsx("span",{className:"sm:hidden",children:"New"})]})]})})]}),i?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 animate-pulse",children:[1,2,3].map(t=>e.jsx("div",{className:"bg-white/50 h-64 rounded-3xl"},t))}):U.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 bg-white/40 rounded-3xl border-2 border-dashed border-slate-300",children:[e.jsx("div",{className:"bg-slate-100 p-6 rounded-full mb-4 text-slate-400",children:o?e.jsx(ne,{className:"h-10 w-10"}):e.jsx(he,{className:"h-10 w-10"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-700",children:"មិនមានទិន្នន័យ"})]}):e.jsx(e.Fragment,{children:S==="grid"&&!o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:Ce.map((t,v)=>e.jsx(Rs,{employee:t,onEdit:()=>r(t),onDelete:()=>l(t.id),index:v,isSelected:j.has(t.id),onToggleSelect:ke},t.id))}),e.jsx(Se,{className:"glass-panel p-4 rounded-2xl flex flex-col md:flex-row justify-between items-center bg-white/80 mt-6"})]}):e.jsxs("div",{className:"glass-panel rounded-3xl overflow-hidden pb-0 bg-white/80",children:[e.jsx("div",{ref:P,className:"overflow-x-auto cursor-grab active:cursor-grabbing custom-scrollbar",onMouseDown:m,onMouseLeave:C,onMouseUp:k,onMouseMove:F,children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-100",children:[e.jsx("thead",{className:"bg-slate-50/80 backdrop-blur-md",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-4 text-left text-xs font-extrabold text-slate-500 uppercase tracking-wider sticky left-0 bg-slate-50 z-30 shadow-[4px_0_10px_-4px_rgba(0,0,0,0.05)]",children:o?"Action":e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:j.size>0&&j.size===U.length,onChange:be,className:"h-4 w-4 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500 cursor-pointer accent-indigo-600"}),e.jsx("span",{children:"Action"})]})}),e.jsx("th",{className:"px-0 py-0 sticky left-[88px] bg-slate-50 z-30 shadow-[4px_0_10px_-4px_rgba(0,0,0,0.05)] p-0",children:e.jsx(T,{label:"Name / Profile",sortKey:"name",currentSort:g,onOpenSort:b,className:"h-full bg-slate-50"})}),e.jsx(T,{label:"Latin Name",sortKey:"latinName",currentSort:g,onOpenSort:b}),o?e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-4 text-left text-xs font-bold text-slate-500 uppercase",children:"ID"}),e.jsx("th",{className:"px-4 py-4 text-left text-xs font-bold text-slate-500 uppercase",children:"Status"})]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{label:"Gender",sortKey:"gender",currentSort:g,onOpenSort:b,className:"min-w-[100px]"}),e.jsx(T,{label:"ID",sortKey:"studentId",currentSort:g,onOpenSort:b,className:"min-w-[120px]"}),e.jsx(T,{label:"Skill",sortKey:"skill",currentSort:g,onOpenSort:b,className:"min-w-[150px]"}),e.jsx(T,{label:"Group",sortKey:"group",currentSort:g,onOpenSort:b,className:"min-w-[100px]"}),e.jsx(T,{label:"Class",sortKey:"class",currentSort:g,onOpenSort:b,className:"min-w-[100px]"}),e.jsx(T,{label:"Section",sortKey:"section",currentSort:g,onOpenSort:b,className:"min-w-[150px]"}),e.jsx(T,{label:"Position",sortKey:"position",currentSort:g,onOpenSort:b,className:"min-w-[150px]"}),e.jsx(T,{label:"Academic",sortKey:"academicYear",currentSort:g,onOpenSort:b,className:"min-w-[150px]"}),e.jsx(T,{label:"DOB",sortKey:"dob",currentSort:g,onOpenSort:b,className:"min-w-[120px]"}),e.jsx(T,{label:"POB",sortKey:"pob",currentSort:g,onOpenSort:b,className:"min-w-[150px]"}),e.jsx("th",{className:"px-4 py-4 text-left text-xs font-extrabold text-slate-500 uppercase tracking-wider min-w-[150px]",children:"Telegram"}),["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map(t=>e.jsx("th",{className:"px-4 py-4 text-center text-xs font-extrabold text-slate-500 uppercase border-l border-slate-200/50 min-w-[100px] bg-slate-100/30",children:t},t))]})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:Ce.map((t,v)=>o?e.jsx(_s,{employee:t,onRestore:y,onPermanentDelete:h,index:v},t.id):e.jsx(Bs,{employee:t,onEdit:()=>r(t),onDelete:()=>l(t.id),onInlineUpdate:$,index:v,settings:n,isSelected:j.has(t.id),onToggleSelect:ke},t.id))})]})}),e.jsx(Se,{className:"flex flex-col md:flex-row justify-between items-center px-6 py-4 border-t border-slate-100 bg-slate-50/50"})]})})]})]})},Ys=({sidebarOpen:s,setSidebarOpen:i,adminProfile:n,user:o,handleLogout:u})=>e.jsxs("aside",{className:`fixed inset-y-4 left-4 z-50 w-72 glass-sidebar rounded-3xl transform transition-transform duration-500 ease-in-out md:relative md:translate-x-0 md:inset-y-0 md:left-0 md:rounded-none md:border-r md:bg-slate-900 ${s?"translate-x-0":"-translate-x-[120%] md:translate-x-0"} flex flex-col shadow-2xl`,children:[e.jsx("div",{className:"h-24 flex items-center justify-center border-b border-white/5",children:e.jsxs("div",{className:"flex items-center gap-3 font-extrabold text-2xl tracking-widest text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-indigo-400",children:[e.jsx(Oe,{className:"h-8 w-8 text-blue-500"})," HR PRO"]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto py-8 px-4 space-y-2",children:[e.jsx("p",{className:"px-4 text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"Menu"}),e.jsxs(de,{to:"/",onClick:()=>i(!1),className:({isActive:r})=>`w-full flex items-center gap-4 px-6 py-4 rounded-2xl transition-all duration-300 font-bold ${r?"active-nav-item shadow-lg shadow-blue-900/20":"text-slate-400 hover:bg-white/5 hover:text-white"}`,children:[e.jsx(ze,{className:"h-5 w-5"})," ផ្ទាំងគ្រប់គ្រង"]}),e.jsxs(de,{to:"/employees",onClick:()=>i(!1),className:({isActive:r})=>`w-full flex items-center gap-4 px-6 py-4 rounded-2xl transition-all duration-300 font-bold ${r?"active-nav-item shadow-lg shadow-blue-900/20":"text-slate-400 hover:bg-white/5 hover:text-white"}`,children:[e.jsx(Pe,{className:"h-5 w-5"})," បុគ្គលិក"]}),e.jsxs(de,{to:"/bulk-edit",onClick:()=>i(!1),className:({isActive:r})=>`w-full flex items-center gap-4 px-6 py-4 rounded-2xl transition-all duration-300 font-bold ${r?"active-nav-item shadow-lg shadow-blue-900/20":"text-slate-400 hover:bg-white/5 hover:text-white"}`,children:[e.jsx(ve,{className:"h-5 w-5"})," កែប្រែទិន្នន័យ"]}),e.jsxs(de,{to:"/recycle-bin",onClick:()=>i(!1),className:({isActive:r})=>`w-full flex items-center gap-4 px-6 py-4 rounded-2xl transition-all duration-300 font-bold ${r?"bg-red-500/10 text-red-400 border-l-4 border-red-500":"text-slate-400 hover:bg-white/5 hover:text-white"}`,children:[e.jsx(ne,{className:"h-5 w-5"})," ធុងសំរាម"]}),e.jsx("div",{className:"my-6 border-t border-white/5"}),e.jsx("p",{className:"px-4 text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"System"}),e.jsxs(de,{to:"/settings",onClick:()=>i(!1),className:({isActive:r})=>`w-full flex items-center gap-4 px-6 py-4 rounded-2xl transition-all duration-300 font-bold ${r?"active-nav-item shadow-lg shadow-blue-900/20":"text-slate-400 hover:bg-white/5 hover:text-white"}`,children:[e.jsx(Re,{className:"h-5 w-5"})," ការកំណត់"]})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-gradient-to-br from-indigo-600 to-blue-700 rounded-2xl p-4 text-center",children:[e.jsx("p",{className:"text-white text-sm font-bold mb-0.5",children:n?.username||o?.email||"Admin"}),e.jsx("p",{className:"text-white/60 text-xs font-medium opacity-80 mb-3",children:n?.role||"User"}),e.jsxs("button",{onClick:u,className:"w-full flex items-center justify-center gap-2 px-4 py-2 rounded-xl bg-white/20 hover:bg-white/30 text-white transition-all text-sm font-bold backdrop-blur-sm",children:[e.jsx(ls,{className:"h-4 w-4"})," Sign Out"]})]})})]}),Us=({setSidebarOpen:s,adminProfile:i,user:n})=>{const o=Ue(),u=()=>{switch(o.pathname){case"/":return"Dashboard Overview";case"/employees":return"Employee Management";case"/recycle-bin":return"Recycle Bin";case"/settings":return"System Settings";case"/bulk-edit":return"Bulk Edit Mode";default:return"HR Pro"}};return e.jsxs("header",{className:"h-20 glass-panel border-b-0 m-4 rounded-3xl flex items-center justify-between px-8 z-30 shrink-0 sticky top-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>s(!0),className:"md:hidden p-2 rounded-xl hover:bg-slate-100 text-slate-600",children:e.jsx(ss,{className:"h-6 w-6"})}),e.jsx("h1",{className:"text-2xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-slate-700 to-slate-500 hidden sm:block",children:u()})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(as,{className:"h-6 w-6 text-slate-400 hover:text-indigo-500 transition-colors cursor-pointer"}),e.jsx("span",{className:"absolute -top-1 -right-1 h-3 w-3 bg-red-500 rounded-full border-2 border-white"})]}),e.jsx("div",{className:"h-8 w-[1px] bg-slate-200"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-right hidden md:block",children:[e.jsx("div",{className:"text-sm font-bold text-slate-700",children:i?.username||n?.email||"Admin User"}),e.jsx("div",{className:"text-xs text-slate-400 font-medium",children:i?.role||"Loading..."})]}),e.jsx("div",{className:"h-10 w-10 rounded-full bg-gradient-to-r from-blue-500 to-indigo-600 flex items-center justify-center text-white font-bold shadow-lg ring-2 ring-white",children:i?.username?i.username.charAt(0).toUpperCase():n?.email?n.email.charAt(0).toUpperCase():"A"})]})]})]})};function Ws(){const[s,i]=d.useState(null),[n,o]=d.useState(null),[u,r]=d.useState(!1),[l,y]=d.useState(""),[h,$]=d.useState(!1),[L,x]=d.useState([]),[S,z]=d.useState([]),[M,K]=d.useState({}),D=_e(),[Y,B]=d.useState(!0),[w,j]=d.useState(!1),[p,f]=d.useState(null),[N,I]=d.useState({isOpen:!1,title:"",message:"",onConfirm:null,type:"danger"}),{toasts:Z,addToast:E,removeToast:J}=Ds();d.useEffect(()=>{const a=xe.onAuthStateChanged(m=>{m&&(m.isAnonymous||!m.email)?(console.log("Blocking anonymous/incomplete user"),xe.signOut(),i(null),localStorage.removeItem("user_session"),o(null)):(i(m),m?localStorage.setItem("user_session",JSON.stringify({uid:m.uid,email:m.email})):(localStorage.removeItem("user_session"),o(null))),B(!1)});return()=>a()},[]);const g=async(a,m)=>{r(!0),y("");try{await xe.signInWithEmailAndPassword(a,m)}catch(C){console.error("Login failed:",C);let k="Failed to sign in. Please check your credentials.";C.code==="auth/wrong-password"&&(k="Incorrect password."),C.code==="auth/user-not-found"&&(k="No user found with this email."),y(k)}finally{r(!1)}},re=()=>{I({isOpen:!0,type:"danger",title:"Sign Out",message:"Are you sure you want to sign out?",onConfirm:async()=>{await xe.signOut(),localStorage.removeItem("user_session"),I(a=>({...a,isOpen:!1})),E("Signed out successfully","success")}})};d.useEffect(()=>{if(!s)return;const a=W.ref("students"),m=W.ref("deleted_students"),C=W.ref("settings"),k=W.ref("userAdmin/"+s.uid),F=(R,H)=>{const se=R.val();if(se){const U=Object.keys(se).map(te=>{const b=se[te]||{},X=b.កាលវិភាគ||{};return{id:te,imageUrl:O(b.រូបថត||b.imageUrl),name:O(b.ឈ្មោះ||b.name),latinName:O(b.ឈ្មោះឡាតាំង),gender:O(b.ភេទ),dob:O(b.ថ្ងៃខែឆ្នាំកំណើត),pob:O(b.ទីកន្លែងកំណើត),studentId:O(b.អត្តលេខ),academicYear:O(b.ឆ្នាំសិក្សា),generation:O(b.ជំនាន់),group:O(b.ក្រុម),class:O(b.ថ្នាក់),skill:O(b.ជំនាញ),section:O(b.ផ្នែកការងារ),position:O(b.តួនាទី),telegram:O(b.តេឡេក្រាម),mon:O(X.ចន្ទ||b.ចន្ទ),tue:O(X.អង្គារ៍||b.អង្គារ៍),wed:O(X.ពុធ||b.ពុធ),thu:O(X.ព្រហស្បត្តិ៍||b.ព្រហស្បត្តិ៍),fri:O(X.សុក្រ||b.សុក្រ),sat:O(X.សៅរ៍||b.សៅរ៍),sun:O(X.អាទិត្យ||b.អាទិត្យ),originalData:b}});H(U.reverse())}else H([])};return a.on("value",R=>{F(R,x),B(!1)}),m.on("value",R=>F(R,z)),C.on("value",R=>K(R.val()||{})),k.on("value",R=>{const H=R.val();H&&o(H)}),()=>{a.off(),m.off(),C.off(),k.off()}},[s]);const Q=d.useMemo(()=>({total:L.length,male:L.filter(a=>a.gender==="ប្រុស").length,female:L.filter(a=>a.gender==="ស្រី").length}),[L]),ee=d.useCallback(a=>{const m=L.find(C=>C.id===a);I({isOpen:!0,type:"danger",title:"បញ្ជាក់ការលុប",message:`តើអ្នកពិតជាចង់លុប "${m?.name}" ទៅកាន់ធុងសំរាមមែនទេ?`,onConfirm:async()=>{try{await W.ref(`deleted_students/${m.id}`).set({...m.originalData,deletedAt:Date.now()}),await W.ref(`students/${m.id}`).remove(),I(C=>({...C,isOpen:!1})),E("បានបញ្ជូនទៅធុងសំរាម","success")}catch{E("បរាជ័យក្នុងការលុប","error")}}})},[L]),q=d.useCallback(a=>{!a||a.length===0||I({isOpen:!0,type:"danger",title:"បញ្ជាក់ការលុបជាក្រុម",message:`តើអ្នកប្រាកដជាចង់លុបបុគ្គលិកចំនួន ${a.length} នាក់ ទៅកាន់ធុងសំរាមមែនទេ?`,onConfirm:async()=>{try{const m={};a.forEach(C=>{const k=L.find(F=>F.id===C);k&&(m[`deleted_students/${C}`]={...k.originalData,deletedAt:Date.now()},m[`students/${C}`]=null)}),await W.ref().update(m),I(C=>({...C,isOpen:!1})),E(`បានលុបចំនួន ${a.length} នាក់ជោគជ័យ`,"success")}catch{E("បរាជ័យក្នុងការលុបជាក្រុម","error")}}})},[L]),P=d.useCallback(a=>{I({isOpen:!0,type:"restore",title:"បញ្ជាក់ការស្តារ",message:`តើអ្នកចង់ស្តារ "${a.name}" ត្រឡប់មកវិញទេ?`,onConfirm:async()=>{try{await W.ref(`students/${a.id}`).set(a.originalData),await W.ref(`deleted_students/${a.id}`).remove(),I(m=>({...m,isOpen:!1})),E("បានស្តារទិន្នន័យជោគជ័យ","success")}catch{E("បរាជ័យ","error")}}})},[]),V=d.useCallback(a=>{I({isOpen:!0,type:"danger",title:"លុបជារៀងរហូត",message:"តើអ្នកចង់លុបជារៀងរហូតមែនទេ? ទិន្នន័យមិនអាចយកមកវិញបានទេ។",onConfirm:async()=>{try{await W.ref(`deleted_students/${a}`).remove(),I(m=>({...m,isOpen:!1})),E("លុបជាស្ថាពរជោគជ័យ","success")}catch{E("បរាជ័យ","error")}}})},[]),c=d.useCallback(async(a,m,C)=>{try{await W.ref(`students/${a}`).update({[m]:C})}catch{E("បរាជ័យក្នុងការកែប្រែ","error")}},[]);return Y?e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"text-slate-400 text-sm font-medium animate-pulse",children:"Loading HR Pro..."})]})}):e.jsx(e.Fragment,{children:s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex h-screen overflow-hidden",children:[e.jsx(Ys,{sidebarOpen:h,setSidebarOpen:$,adminProfile:n,user:s,handleLogout:re}),h&&e.jsx("div",{className:"fixed inset-0 bg-black/60 z-40 md:hidden backdrop-blur-sm transition-opacity",onClick:()=>$(!1)}),e.jsxs("div",{className:"flex-1 flex flex-col h-full overflow-hidden relative",children:[e.jsx(Us,{setSidebarOpen:$,adminProfile:n,user:s}),e.jsx("main",{className:"flex-1 overflow-y-auto px-4 pb-4 md:px-8 md:pb-8 custom-scrollbar",children:e.jsxs(Ye,{children:[e.jsx(oe,{path:"/",element:e.jsx(is,{stats:Q,onNavigate:a=>D(a)})}),e.jsx(oe,{path:"/employees",element:e.jsx(Ee,{employees:L,loading:Y,settings:M,isModalOpen:w,onEdit:a=>{f(a),j(!0)},onDelete:ee,onInlineUpdate:c,onCreate:()=>{f(null),j(!0)},onBulkDelete:q})}),e.jsx(oe,{path:"/recycle-bin",element:e.jsx(Ee,{employees:S,loading:Y,isRecycleBin:!0,onRestore:P,onPermanentDelete:V})}),e.jsx(oe,{path:"/bulk-edit",element:e.jsx(gs,{db:W,employees:L,settings:M,addToast:E,setConfirmDialog:I})}),e.jsx(oe,{path:"/settings",element:e.jsx(os,{db:W,settings:M,setConfirmDialog:I,addToast:E})})]})})]})]}),w&&e.jsx(Ms,{isOpen:w,onClose:()=>j(!1),employee:p,db:W,addToast:E,settings:M}),e.jsx(rs,{isOpen:N.isOpen,onClose:()=>I(a=>({...a,isOpen:!1})),...N}),e.jsx(ns,{toasts:Z,removeToast:J})]}):e.jsx(Ps,{onLogin:g,loading:u,error:l})})}We.createRoot(document.getElementById("root")).render(e.jsx(Ge.StrictMode,{children:e.jsx(Te,{children:e.jsx(Ws,{})})}));
